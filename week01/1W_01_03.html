<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>μΈν„°λ½νΈ(Interrupt) μ²λ¦¬ λ©”μ»¤λ‹μ¦κ³Ό PCB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f5f5f4; color: #1f2937; }
        .def-box { background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%); border-left: 4px solid #4f46e5; border-radius: 8px; padding: 1.25rem; margin-bottom: 1rem; }
        .def-box p { color: #312e81; font-weight: 500; margin: 0; line-height: 1.8; }
        .insight-box { background-color: #fffbeb; border: 1px solid #fde68a; border-radius: 8px; padding: 1rem; margin: 1rem 0; }
        .insight-box::before { content: 'π’΅'; margin-right: 0.5rem; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        .nav-item.active { border-bottom: 2px solid #4f46e5; color: #4f46e5; font-weight: 700; }
        .tech-block { transition: all 0.3s ease; cursor: pointer; }
        .tech-block:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .tech-block.selected { ring: 2px; ring-color: #4f46e5; background-color: #eef2ff; border-color: #4f46e5; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        #chat-sidebar { transition: transform 0.3s ease-in-out; }
        #chat-sidebar.closed { transform: translateX(100%); }
        #chat-sidebar.open { transform: translateX(0); }
        .typing-indicator span { display: inline-block; width: 6px; height: 6px; background-color: #4f46e5; border-radius: 50%; animation: typing 1.4s infinite ease-in-out both; margin: 0 2px; }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        .prose h1,.prose h2,.prose h3 { font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; color: #312e81; font-size: 1.1em; }
        .prose ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
        .prose strong { color: #4338ca; }
        .prose p { margin-bottom: 0.8em; }
        .chat-msg { border-radius: 12px; padding: 10px 14px; margin-bottom: 10px; max-width: 85%; font-size: 0.95rem; }
        .chat-msg.user { background-color: #4f46e5; color: white; align-self: flex-end; margin-left: auto; }
        .chat-msg.ai { background-color: #f3f4f6; color: #1f2937; align-self: flex-start; border: 1px solid #e5e7eb; }
        .textbook-content h3 { font-size: 1.25rem; font-weight: 700; color: #1e3a8a; margin-top: 1.5rem; margin-bottom: 0.75rem; border-left: 4px solid #4f46e5; padding-left: 0.75rem; }
        .textbook-content h4 { font-size: 1.1rem; font-weight: 600; color: #374151; margin-top: 1rem; margin-bottom: 0.5rem; }
        .textbook-content p { margin-bottom: 1rem; line-height: 1.8; color: #4b5563; }
        .textbook-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; color: #4b5563; }
        .textbook-content li { margin-bottom: 0.5rem; line-height: 1.7; }
        .textbook-content table { width: 100%; border-collapse: collapse; margin-bottom: 1.5rem; font-size: 0.95rem; }
        .textbook-content th,.textbook-content td { border: 1px solid #e5e7eb; padding: 0.75rem; text-align: left; }
        .textbook-content th { background-color: #f9fafb; font-weight: 600; color: #1f2937; }
        .textbook-content .highlight { background-color: #eef2ff; color: #4338ca; font-weight: 600; padding: 0 4px; border-radius: 4px; }
        .textbook-content pre { background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; overflow-x: auto; margin-bottom: 1rem; font-size: 0.85rem; line-height: 1.6; }
        .textbook-content code { font-family: 'Courier New', monospace; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    </style>
</head>
<body class="bg-stone-100 min-h-screen flex flex-col overflow-x-hidden">

    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center pt-3 pb-1">
                <div class="flex flex-col justify-center min-w-0">
                    <span class="text-[10px] sm:text-xs text-indigo-600 font-bold uppercase tracking-wider leading-tight">KPC μ •λ³΄κ΄€λ¦¬κΈ°μ μ‚¬ ZIP-UP μ‹¬ν™”λ°</span>
                    <div class="flex items-center gap-2">
                        <span class="text-lg sm:text-xl font-bold text-gray-900 tracking-tight truncate">μΈν„°λ½νΈ(Interrupt) μ²λ¦¬ λ©”μ»¤λ‹μ¦κ³Ό PCB</span>
                        <span class="text-[10px] sm:text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full font-bold flex-shrink-0">2026</span>
                    </div>
                </div>
            </div>
            <nav class="flex space-x-1 sm:space-x-4 overflow-x-auto no-scrollbar pb-1 items-center">
                <button onclick="navTo('overview')" id="nav-overview" class="nav-item active px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-indigo-600 hover:text-indigo-800 whitespace-nowrap">κ°μ” λ° κ°λ…</button>
                <button onclick="navTo('process')" id="nav-process" class="nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-gray-500 hover:text-indigo-800 whitespace-nowrap">μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ •</button>
                <button onclick="navTo('pcb')" id="nav-pcb" class="nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-gray-500 hover:text-indigo-800 whitespace-nowrap">PCBμ™€ λ¬Έλ§¥ κµν™</button>
                <button onclick="navTo('performance')" id="nav-performance" class="nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-gray-500 hover:text-indigo-800 whitespace-nowrap">μ„±λ¥ λ° μ—°κ΄€ μ΄λ΅ </button>
                <button onclick="navTo('textbook')" id="nav-textbook" class="nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-gray-500 hover:text-indigo-800 whitespace-nowrap">μ›λ¬Έ ν•™μµ</button>
                <button onclick="navTo('script')" id="nav-script" class="hidden nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-amber-600 hover:text-amber-800 whitespace-nowrap">π¬ κ°•μ μ¤ν¬λ¦½νΈ</button>
                <button onclick="navTo('quiz')" id="nav-quiz" class="nav-item px-1 pt-1 pb-2 text-xs sm:text-sm font-medium text-gray-500 hover:text-indigo-800 whitespace-nowrap">ν€΄μ¦ &amp; μ•”κΈ°</button>
                <span class="w-px h-4 bg-gray-300 flex-shrink-0"></span>
                <button onclick="toggleSettings()" class="flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium text-indigo-600 hover:bg-indigo-50 border border-indigo-200 hover:border-indigo-400 transition-all whitespace-nowrap flex-shrink-0" title="API Key μ„¤μ •">π”‘ API</button>
            </nav>
        </div>
    </header>
    <main class="flex-grow max-w-5xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12 pb-24">

    <!-- ===== νƒ­1: κ°μ” λ° κ°λ… ===== -->
    <div id="overview">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6">κ°μ” λ° κ°λ…</h2>

            <!-- μ •μ λ°•μ¤ -->
            <div class="def-box">
                <p><strong>μΈν„°λ½νΈ(Interrupt)</strong>λ€ CPUκ°€ ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄ μ²λ¦¬λ¥Ό μΌμ‹ μ¤‘λ‹¨ν•κ³ , κΈ΄κΈ‰ν•κ±°λ‚ μ°μ„ μ μΈ μ²λ¦¬κ°€ ν•„μ”ν• μ‚¬κ±΄(Event)μ— λ€μ‘ν•κΈ° μ„ν•΄ μ μ–΄κ¶μ„ νΉμ • μ„λΉ„μ¤ λ£¨ν‹΄(ISR)μΌλ΅ μ΄μ „ν•λ” <strong>λΉ„λ™κΈ°μ  μ΄λ²¤νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦</strong>μ΄λ‹¤.</p>
            </div>
            <div class="def-box">
                <p><strong>PCB(Process Control Block)</strong>λ” μ΄μμ²΄μ κ°€ κ° ν”„λ΅μ„Έμ¤λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν•΄ μ μ§€ν•λ” <strong>ν”„λ΅μ„Έμ¤λ³„ λ©”νƒ€λ°μ΄ν„° μλ£κµ¬μ΅°</strong>λ΅, λ¬Έλ§¥ κµν™(Context Switching) μ‹ ν”„λ΅μ„Έμ¤μ μ‹¤ν–‰ μƒνƒλ¥Ό μ™„μ „ν λ³΄μ΅΄ν•κ³  λ³µμ›ν•λ” ν•µμ‹¬ λ‹¨μ„μ΄λ‹¤.</p>
            </div>

            <!-- κ°λ… ν•΄μ„¤ -->
            <div class="mt-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-3">μ™ μΈν„°λ½νΈκ°€ ν•„μ”ν•κ°€?</h3>
                <p class="text-gray-600 leading-relaxed mb-4">μΈν„°λ½νΈκ°€ μ—†λ” μ‹μ¤ν…μ—μ„λ” CPUκ°€ I/O μ¥μΉμ μ‘μ—… μ™„λ£λ¥Ό λ°λ³µμ μΌλ΅ ν™•μΈν•λ” <strong>ν΄λ§(Polling)</strong> λ°©μ‹μ„ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ” CPU μμ›μ„ κ·Ήλ„λ΅ λ‚­λΉ„ν•©λ‹λ‹¤. μΈν„°λ½νΈ λ°©μ‹μ€ I/O μ¥μΉκ°€ μ‘μ—… μ™„λ£ μ‹ CPUμ— μ‹ νΈλ¥Ό λ³΄λ‚΄λ” λ°©μ‹μΌλ΅, CPUλ” κ·Έ μ‚¬μ΄ λ‹¤λ¥Έ μ μ©ν• μ‘μ—…μ„ μν–‰ν•  μ μμµλ‹λ‹¤.</p>
            </div>

            <!-- ν΄λ§ vs μΈν„°λ½νΈ λΉ„κµ μΉ΄λ“ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-red-50 rounded-xl p-5 border border-red-200">
                    <h4 class="font-bold text-red-700 mb-2">β ν΄λ§(Polling) λ°©μ‹</h4>
                    <p class="text-sm text-red-600 leading-relaxed">CPUκ°€ "λλ‚¬μ–΄? λλ‚¬μ–΄?" λ°λ³µ ν™•μΈ. CPU μ‹κ°„μ μµλ€ <strong>90%</strong>λ¥Ό I/O λ€κΈ°μ— μ†λ¨. CPU μμ› κ·Ήλ„λ΅ λ‚­λΉ„.</p>
                </div>
                <div class="bg-green-50 rounded-xl p-5 border border-green-200">
                    <h4 class="font-bold text-green-700 mb-2">β… μΈν„°λ½νΈ(Interrupt) λ°©μ‹</h4>
                    <p class="text-sm text-green-600 leading-relaxed">I/O μ¥μΉκ°€ "λλ‚¬μ–΄!" μ‹ νΈ μ „μ†΅. CPU λ€κΈ° μ‹κ°„ <strong>2~5%</strong>λ΅ κ°μ†. ν„λ€ OSμ λ©€ν‹°νƒμ¤ν‚Ή κΈ°λ°.</p>
                </div>
            </div>

            <!-- μΈν„°λ½νΈ λ¶„λ¥ -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">μΈν„°λ½νΈ λ¶„λ¥ 3μ¶• β€” <span class="text-indigo-600">"ν•μ†λ™λΉ„λ³µ"</span></h3>
            <div class="overflow-x-auto mb-6">
                <table class="w-full text-sm border-collapse">
                    <thead><tr class="bg-gray-50">
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">λ¶„λ¥ κΈ°μ¤€</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μ ν•</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μ„¤λ…</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μμ‹</th>
                    </tr></thead>
                    <tbody>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium" rowspan="2">λ°μƒ μ›μΈ</td><td class="border border-gray-200 px-3 py-2 text-indigo-700 font-medium">ν•λ“μ›¨μ–΄ (External)</td><td class="border border-gray-200 px-3 py-2">CPU μ™Έλ¶€ μ¥μΉκ°€ λ°μƒ</td><td class="border border-gray-200 px-3 py-2">ν‚¤λ³΄λ“, λ””μ¤ν¬ I/O, νƒ€μ΄λ¨Έ</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 text-purple-700 font-medium">μ†ν”„νΈμ›¨μ–΄ (Internal)</td><td class="border border-gray-200 px-3 py-2">CPU λ‚΄λ¶€ λ…λ Ήμ–΄ μ‹¤ν–‰ μ¤‘ λ°μƒ</td><td class="border border-gray-200 px-3 py-2">0 λ‚λ„κΈ°, μ¤λ²„ν”λ΅μ°, μ‹μ¤ν… μ½</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium" rowspan="2">μ²λ¦¬ μ‹μ </td><td class="border border-gray-200 px-3 py-2 text-blue-700 font-medium">λ™κΈ°μ  (Synchronous)</td><td class="border border-gray-200 px-3 py-2">λ…λ Ήμ–΄ μ‹¤ν–‰μ μ§μ ‘μ  κ²°κ³Ό</td><td class="border border-gray-200 px-3 py-2">νΈλ©, ν΄νΈ, μ‹μ¤ν… μ½</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 text-teal-700 font-medium">λΉ„λ™κΈ°μ  (Asynchronous)</td><td class="border border-gray-200 px-3 py-2">ν„μ¬ μ‹¤ν–‰κ³Ό λ¬΄κ΄€ν• μ™Έλ¶€ λ°μƒ</td><td class="border border-gray-200 px-3 py-2">I/O μ™„λ£, νƒ€μ΄λ¨Έ, HW μ¤λ¥</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium" rowspan="2">λ³µκ·€ κ°€λ¥μ„±</td><td class="border border-gray-200 px-3 py-2 text-green-700 font-medium">λ³µκ·€ κ°€λ¥ (Recoverable)</td><td class="border border-gray-200 px-3 py-2">μ›μΈ ν•΄κ²° ν›„ μ¤‘λ‹¨μ  λ³µκ·€ κ°€λ¥</td><td class="border border-gray-200 px-3 py-2">νμ΄μ§€ ν΄νΈ β†’ λ΅λ“ ν›„ μ¬μ‹¤ν–‰</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 text-red-700 font-medium">λ³µκ·€ λ¶κ°€ (Non-recoverable)</td><td class="border border-gray-200 px-3 py-2">μ‹μ¤ν… μ¤‘λ‹¨ λλ” ν”„λ΅μ„Έμ¤ μΆ…λ£</td><td class="border border-gray-200 px-3 py-2">HW μ¤λ¥, λ³΄νΈ μ„λ°</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- CPU λ μ§€μ¤ν„° & HW κµ¬μ„± -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">CPU λ‚΄λ¶€ μ£Όμ” λ μ§€μ¤ν„°</h3>
            <div class="overflow-x-auto mb-6">
                <table class="w-full text-sm border-collapse">
                    <thead><tr class="bg-gray-50">
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">λ μ§€μ¤ν„°</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">λ…μΉ­</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μ—­ν• </th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μΈν„°λ½νΈ μ‹ λ™μ‘</th>
                    </tr></thead>
                    <tbody>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-indigo-700">PC</td><td class="border border-gray-200 px-3 py-2">ν”„λ΅κ·Έλ¨ μΉ΄μ΄ν„°</td><td class="border border-gray-200 px-3 py-2">λ‹¤μ μ‹¤ν–‰ λ…λ Ήμ–΄ μ£Όμ†</td><td class="border border-gray-200 px-3 py-2">ISR μ‹μ‘ μ£Όμ†λ΅ λ³€κ²½</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-indigo-700">SP</td><td class="border border-gray-200 px-3 py-2">μ¤νƒ ν¬μΈν„°</td><td class="border border-gray-200 px-3 py-2">μ¤νƒ μµμƒμ„ μ£Όμ†</td><td class="border border-gray-200 px-3 py-2">μ»¤λ„ μ¤νƒ ν¬μΈν„°λ΅ μ „ν™</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-indigo-700">PSW</td><td class="border border-gray-200 px-3 py-2">ν”„λ΅κ·Έλ¨ μƒνƒ μ›λ“</td><td class="border border-gray-200 px-3 py-2">CPU μƒνƒ ν”λκ·Έ</td><td class="border border-gray-200 px-3 py-2">μ»¤λ„ λ¨λ“ μ „ν™, μΈν„°λ½νΈ λΉ„ν™μ„±ν™”</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-indigo-700">GPR</td><td class="border border-gray-200 px-3 py-2">λ²”μ© λ μ§€μ¤ν„°</td><td class="border border-gray-200 px-3 py-2">μ—°μ‚° λ°μ΄ν„° μ„μ‹ μ €μ¥</td><td class="border border-gray-200 px-3 py-2">PCBμ— λ°±μ—… μ €μ¥</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- λ μ΄λ” μ°¨νΈ: ν΄λ§ vs μΈν„°λ½νΈ λΉ„κµ -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">ν΄λ§ vs μΈν„°λ½νΈ νΉμ„± λΉ„κµ</h3>
            <div class="chart-container mb-2">
                <canvas id="overviewRadar"></canvas>
            </div>
            <p class="text-xs text-gray-400 text-center">* μ μλ” μƒλ€μ  λΉ„κµλ¥Ό μ„ν• μμ‹ κ°’μ…λ‹λ‹¤.</p>
        </div>
    </div>

    <!-- ===== νƒ­2: μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ • ===== -->
    <div id="process" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6">μΈν„°λ½νΈ μ²λ¦¬ 8λ‹¨κ³„ β€” <span class="text-indigo-600">"λ°μ™„μΈμ €μ „μ»¨μ‹¤λ³µ"</span></h2>

            <!-- 8λ‹¨κ³„ μ‹κ°ν™” νλ¦„λ„ -->
            <div class="bg-gradient-to-b from-slate-50 to-white rounded-xl p-4 sm:p-6 mb-6 border border-slate-200">
                <div class="max-w-lg mx-auto space-y-0">
                    <!-- μ‹μ‘ -->
                    <div class="flex justify-center mb-2">
                        <div class="bg-gray-100 border border-gray-300 rounded-full px-4 py-1.5 text-sm font-bold text-gray-600">ν”„λ΅μ„Έμ¤ A μ‹¤ν–‰ μ¤‘</div>
                    </div>
                    <div class="flex justify-center"><div class="w-px h-3 bg-gray-300"></div></div>

                    <!-- H/W κµ¬κ°„ λΌλ²¨ -->
                    <div class="flex justify-center mb-1"><span class="text-[10px] font-bold text-red-500 bg-red-50 px-2 py-0.5 rounded">β”€β”€ H/W μλ™ μν–‰ κµ¬κ°„ β”€β”€</span></div>

                    <!-- 1λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-red-50 border-2 border-red-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-red-700">β‘  λ°μƒ</p><p class="text-[10px] text-red-500">IRQ μ‹ νΈ β†’ PIC β†’ CPU INT ν•€</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 2λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-red-50 border-2 border-red-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-red-700">β‘΅ μ™„λ£ λ€κΈ°</p><p class="text-[10px] text-red-500">ν„μ¬ λ…λ Ήμ–΄ μ›μμ  μ™„λ£ λ³΄μ¥</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 3λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-red-50 border-2 border-red-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-red-700">β‘Ά μΈμ‹ (INTA)</p><p class="text-[10px] text-red-500">IF=1 ν™•μΈ β†’ PICμ— INTA β†’ λ²΅ν„° λ²νΈ μμ‹ </p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 4λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-red-50 border-2 border-red-400 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm ring-2 ring-red-200"><p class="text-sm font-bold text-red-800">β‘£ μ €μ¥ (PSW, PC)</p><p class="text-[10px] text-red-600">CPU λ§μ΄ν¬λ΅μ½”λ“κ°€ μλ™μΌλ΅ μ»¤λ„ μ¤νƒμ— push</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 5λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-red-50 border-2 border-red-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-red-700">β‘¤ μ „ν™</p><p class="text-[10px] text-red-500">Userβ†’Kernel λ¨λ“, IF=0, IDTβ†’ISR μ£Όμ† λ΅λ“</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-3 bg-gray-300"></div></div>

                    <!-- S/W κµ¬κ°„ λΌλ²¨ -->
                    <div class="flex justify-center mb-1"><span class="text-[10px] font-bold text-blue-500 bg-blue-50 px-2 py-0.5 rounded">β”€β”€ S/W (OS μ»¤λ„) μν–‰ κµ¬κ°„ β”€β”€</span></div>

                    <!-- 6λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-blue-50 border-2 border-blue-400 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm ring-2 ring-blue-200"><p class="text-sm font-bold text-blue-800">β‘¥ μ»¨ν…μ¤νΈ μ €μ¥</p><p class="text-[10px] text-blue-600">GPR, SP, FPU β†’ PCBμ— μ €μ¥ (PUSH/MOV λ…λ Ή)</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 7λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-blue-50 border-2 border-blue-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-blue-700">β‘¦ ISR μ‹¤ν–‰</p><p class="text-[10px] text-blue-500">μΈν„°λ½νΈ μ›μΈ μ²λ¦¬ (I/O μ™„λ£, νƒ€μ΄λ¨Έ λ“±)</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-2 bg-gray-300"></div></div>
                    <!-- 8λ‹¨κ³„ -->
                    <div class="flex justify-center"><div class="bg-blue-50 border-2 border-blue-300 rounded-lg px-4 py-2 text-center w-full max-w-xs shadow-sm"><p class="text-sm font-bold text-blue-700">β‘§ λ³µμ›</p><p class="text-[10px] text-blue-500">μ¤μΌ€μ¤„λ¬ β†’ PCBμ—μ„ λ³µμ› β†’ IRET β†’ μ‹¤ν–‰ μ¬κ°</p></div></div>
                    <div class="flex justify-center"><div class="w-px h-3 bg-gray-300"></div></div>

                    <!-- μΆ…λ£ -->
                    <div class="flex justify-center">
                        <div class="bg-green-100 border border-green-300 rounded-full px-4 py-1.5 text-sm font-bold text-green-700">ν”„λ΅μ„Έμ¤ μ‹¤ν–‰ μ¬κ°</div>
                    </div>
                </div>
            </div>

            <!-- ν•µμ‹¬ ν¬μΈνΈ: H/W vs S/W κµ¬λ¶„ -->
            <div class="insight-box">
                <span>λ‹µμ• ν•µμ‹¬: <strong>β‘£λ‹¨κ³„(PSW/PC)λ” ν•λ“μ›¨μ–΄κ°€ μλ™ μ €μ¥</strong>, <strong>β‘¥λ‹¨κ³„(GPRβ†’PCB)λ” μ†ν”„νΈμ›¨μ–΄(OS μ»¤λ„)κ°€ μ €μ¥</strong>. μ΄ κµ¬λ¶„μ„ λ…ν™•ν μ“°λ©΄ "CPU λ§μ΄ν¬λ΅ μμ¤€ λ™μ‘μ„ μ •ν™•ν μ΄ν•΄ν•κ³  μλ‹¤"λ” μΈμƒμ„ μ¤„ μ μλ‹¤.</span>
            </div>

            <!-- ν΄λ¦­ ν™•μ¥ μΉ΄λ“: κ° λ‹¨κ³„ μƒμ„Έ -->
            <h3 class="text-lg font-bold text-gray-800 mt-8 mb-4">λ‹¨κ³„λ³„ μƒμ„Έ μ„¤λ… (ν΄λ¦­ν•μ—¬ νΌμΉκΈ°)</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                <div class="tech-block bg-white border-2 border-red-200 rounded-xl p-3 text-center" id="block-step1" onclick="updateStepDetail('step1')">
                    <div class="text-xl mb-1">β΅</div>
                    <h4 class="font-bold text-red-700 text-sm">β‘ β‘΅ λ°μƒΒ·λ€κΈ°</h4>
                </div>
                <div class="tech-block bg-white border-2 border-red-200 rounded-xl p-3 text-center" id="block-step2" onclick="updateStepDetail('step2')">
                    <div class="text-xl mb-1">π”</div>
                    <h4 class="font-bold text-red-700 text-sm">β‘Ά μΈμ‹(INTA)</h4>
                </div>
                <div class="tech-block bg-white border-2 border-red-200 rounded-xl p-3 text-center" id="block-step3" onclick="updateStepDetail('step3')">
                    <div class="text-xl mb-1">π’Ύ</div>
                    <h4 class="font-bold text-red-700 text-sm">β‘£β‘¤ μ €μ¥Β·μ „ν™</h4>
                </div>
                <div class="tech-block bg-white border-2 border-blue-200 rounded-xl p-3 text-center" id="block-step4" onclick="updateStepDetail('step4')">
                    <div class="text-xl mb-1">π”„</div>
                    <h4 class="font-bold text-blue-700 text-sm">β‘¥β‘¦β‘§ μ»¨ν…μ¤νΈ</h4>
                </div>
            </div>
            <div id="step-detail-content" class="bg-gray-50 rounded-xl p-5 border border-gray-200 min-h-[150px] transition-all">
                <p class="text-gray-400 text-sm">μ„ μΉ΄λ“λ¥Ό ν΄λ¦­ν•λ©΄ λ‹¨κ³„λ³„ μƒμ„Έ μ„¤λ…μ΄ ν‘μ‹λ©λ‹λ‹¤.</p>
            </div>

            <!-- H/W μ €μ¥ vs S/W μ €μ¥ λΉ„κµν‘ -->
            <h3 class="text-lg font-bold text-gray-800 mt-8 mb-4">ν•λ“μ›¨μ–΄ vs μ†ν”„νΈμ›¨μ–΄ μ €μ¥ λΉ„κµ</h3>
            <div class="overflow-x-auto">
                <table class="w-full text-sm border-collapse">
                    <thead><tr class="bg-gray-50">
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">κµ¬λ¶„</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold text-red-700">β‘£ H/W μλ™ μ €μ¥</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold text-blue-700">β‘¥ S/W μ €μ¥</th>
                    </tr></thead>
                    <tbody>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium">μ €μ¥ ν•­λ©</td><td class="border border-gray-200 px-3 py-2">PSW, PC (Program Counter)</td><td class="border border-gray-200 px-3 py-2">GPR (R0~R15), SP, FPU λ μ§€μ¤ν„°</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium">μ €μ¥ μ„μΉ</td><td class="border border-gray-200 px-3 py-2">μ»¤λ„ μ¤νƒ</td><td class="border border-gray-200 px-3 py-2">PCBμ λ μ§€μ¤ν„° μμ—­</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium">μν–‰ μ£Όμ²΄</td><td class="border border-gray-200 px-3 py-2">CPU λ§μ΄ν¬λ΅μ½”λ“ (μλ™)</td><td class="border border-gray-200 px-3 py-2">OS μ»¤λ„ (PUSH/MOV λ…λ Ή)</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium">λ©μ </td><td class="border border-gray-200 px-3 py-2">λ³µκ·€ μ£Όμ† + CPU μƒνƒ λ³΄μ΅΄</td><td class="border border-gray-200 px-3 py-2">μ™„μ „ν• ν”„λ΅μ„Έμ¤ μƒνƒ λ³΄μ΅΄</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ===== νƒ­3: PCBμ™€ λ¬Έλ§¥ κµν™ ===== -->
    <div id="pcb" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6">PCBμ™€ λ¬Έλ§¥ κµν™(Context Switching)</h2>

            <!-- PCB μ •μ -->
            <div class="def-box mb-6">
                <p><strong>PCB(Process Control Block)</strong>λ” ν”„λ΅μ„Έμ¤μ "μ΄λ ¥μ„"μ΄λ‹¤. μ΄ ν”„λ΅μ„Έμ¤κ°€ λ„κµ°μ§€(PID), μ§€κΈ λ­ ν•κ³  μμ—λ”μ§€(PC, λ μ§€μ¤ν„°), ν„μ¬ μƒνƒ(Running/Ready/Blocked), λ©”λ¨λ¦¬ μ–΄λ””λ¥Ό μ“°κ³  μλ”μ§€ λ“± λ¨λ“  μ •λ³΄κ°€ λ‹΄κ²¨ μλ‹¤. PCB μ—†μ΄λ” λ©€ν‹°νƒμ¤ν‚Ήμ΄ λ¶κ°€λ¥ν•λ‹¤.</p>
            </div>

            <!-- PCB ν•„λ“ κµ¬μ„± ν‘ β€” "μ‹λ μƒλ©”μ¤" -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">PCB ν•µμ‹¬ ν•„λ“ β€” <span class="text-indigo-600">"μ‹λ μƒλ©”μ¤"</span></h3>
            <div class="overflow-x-auto mb-6">
                <table class="w-full text-sm border-collapse">
                    <thead><tr class="bg-gray-50">
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">ν•„λ“ κ·Έλ£Ή</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">ν•„λ“λ…</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μ„¤λ…</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μμ‹</th>
                    </tr></thead>
                    <tbody>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-indigo-700" rowspan="2">μ‹λ³„ μ •λ³΄</td><td class="border border-gray-200 px-3 py-2">PID</td><td class="border border-gray-200 px-3 py-2">ν”„λ΅μ„Έμ¤ κ³ μ  μ‹λ³„μ</td><td class="border border-gray-200 px-3 py-2">1234</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2">PPID / UID</td><td class="border border-gray-200 px-3 py-2">λ¶€λ¨ PID, μ†μ μ ID</td><td class="border border-gray-200 px-3 py-2">1 (init), 1000</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-green-700" rowspan="2">λ μ§€μ¤ν„°</td><td class="border border-gray-200 px-3 py-2">PC / SP / PSW</td><td class="border border-gray-200 px-3 py-2">ν”„λ΅κ·Έλ¨ μΉ΄μ΄ν„°, μ¤νƒ ν¬μΈν„°, μƒνƒ μ›λ“</td><td class="border border-gray-200 px-3 py-2">0x00401234</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2">GPR (λ²”μ©)</td><td class="border border-gray-200 px-3 py-2">R0~R15 λ“± μ—°μ‚° λ μ§€μ¤ν„°</td><td class="border border-gray-200 px-3 py-2">κ° λ μ§€μ¤ν„°λ³„ μ €μ¥</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-purple-700">μƒνƒ</td><td class="border border-gray-200 px-3 py-2">State / Priority</td><td class="border border-gray-200 px-3 py-2">ν”„λ΅μ„Έμ¤ μƒνƒ, μ°μ„ μμ„</td><td class="border border-gray-200 px-3 py-2">Running, 120</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-amber-700">λ©”λ¨λ¦¬</td><td class="border border-gray-200 px-3 py-2">νμ΄μ§€ ν…μ΄λΈ” ν¬μΈν„°</td><td class="border border-gray-200 px-3 py-2">κ°€μƒ λ©”λ¨λ¦¬ λ§¤ν•‘ (CR3)</td><td class="border border-gray-200 px-3 py-2">CR3 λ μ§€μ¤ν„° κ°’</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2 font-medium text-teal-700">μ¤μΌ€μ¤„λ§</td><td class="border border-gray-200 px-3 py-2">CPU μ‹κ°„ / λ€κΈ° μ‹κ°„</td><td class="border border-gray-200 px-3 py-2">λ„μ  CPU burst, Ready λ€κΈ°</td><td class="border border-gray-200 px-3 py-2">150ms / 30ms</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- λ¬Έλ§¥ κµν™ μ‹κ°ν™” -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">λ¬Έλ§¥ κµν™ κ³Όμ •</h3>
            <div class="bg-gradient-to-r from-indigo-50 to-green-50 rounded-xl p-4 sm:p-6 mb-6 border border-gray-200">
                <div class="grid grid-cols-3 gap-2 items-center text-center max-w-lg mx-auto">
                    <!-- P1 -->
                    <div class="bg-indigo-100 border-2 border-indigo-400 rounded-lg p-3">
                        <p class="text-sm font-bold text-indigo-700">Pβ‚ μ‹¤ν–‰ μ¤‘</p>
                        <p class="text-[10px] text-indigo-500">Running</p>
                    </div>
                    <div class="text-gray-400 text-lg">β†’</div>
                    <div class="bg-amber-100 border-2 border-amber-400 rounded-lg p-3">
                        <p class="text-sm font-bold text-amber-700">μΈν„°λ½νΈ!</p>
                        <p class="text-[10px] text-amber-500">νƒ€μ΄λ¨Έ/I/O</p>
                    </div>

                    <div class="col-span-3 flex items-center justify-center gap-2 py-2">
                        <div class="bg-indigo-50 border border-indigo-300 rounded px-2 py-1 text-[10px] font-bold text-indigo-600">Pβ‚ CPU μƒνƒ β†’ PCBβ‚ μ €μ¥</div>
                        <span class="text-gray-300">β†’</span>
                        <div class="bg-gray-100 border border-gray-300 rounded px-2 py-1 text-[10px] font-bold text-gray-600">μ¤μΌ€μ¤„λ¬: Pβ‚‚ μ„ νƒ</div>
                        <span class="text-gray-300">β†’</span>
                        <div class="bg-green-50 border border-green-300 rounded px-2 py-1 text-[10px] font-bold text-green-600">PCBβ‚‚ β†’ CPU λ³µμ›</div>
                    </div>

                    <div class="bg-gray-100 border-2 border-gray-300 rounded-lg p-3">
                        <p class="text-sm font-bold text-gray-600">Pβ‚ λ€κΈ°</p>
                        <p class="text-[10px] text-gray-400">Ready Queue</p>
                    </div>
                    <div class="text-gray-400 text-lg">β†’</div>
                    <div class="bg-green-100 border-2 border-green-400 rounded-lg p-3">
                        <p class="text-sm font-bold text-green-700">Pβ‚‚ μ‹¤ν–‰ μ¬κ°</p>
                        <p class="text-[10px] text-green-500">Running</p>
                    </div>
                </div>
            </div>

            <!-- λ¬Έλ§¥ κµν™ λΉ„μ© β€” "λ TLμΊν" -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">λ¬Έλ§¥ κµν™ λΉ„μ© 4μ”μ† β€” <span class="text-indigo-600">"λ TLμΊν"</span></h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-red-50 rounded-xl p-4 border border-red-200">
                    <h4 class="font-bold text-red-700 mb-1">λ μ§€μ¤ν„° μ €μ¥/λ³µμ›</h4>
                    <p class="text-sm text-red-600">GPR, FPU λ“± μμ‹­ κ° λ μ§€μ¤ν„° I/O β†’ μ§μ ‘ μ‹κ°„ λΉ„μ© (~1ΞΌs)</p>
                </div>
                <div class="bg-orange-50 rounded-xl p-4 border border-orange-200">
                    <h4 class="font-bold text-orange-700 mb-1">TLB ν”λ¬μ‹ (TLB Flush)</h4>
                    <p class="text-sm text-orange-600">ν”„λ΅μ„Έμ¤ μ „ν™ μ‹ TLB λ¬΄ν¨ν™” β†’ μ΄ν›„ λ©”λ¨λ¦¬ μ ‘κ·Ό μ§€μ—° (μμ‹­ ΞΌs λ„μ )</p>
                </div>
                <div class="bg-amber-50 rounded-xl p-4 border border-amber-200">
                    <h4 class="font-bold text-amber-700 mb-1">μΊμ‹ μ¤μ—Ό (Cache Pollution)</h4>
                    <p class="text-sm text-amber-600">L1/L2 μΊμ‹ μ ν¨ λ°μ΄ν„° λ€μ²΄ β†’ Cold Start μΊμ‹ λ―Έμ¤ μ¦κ°€</p>
                </div>
                <div class="bg-purple-50 rounded-xl p-4 border border-purple-200">
                    <h4 class="font-bold text-purple-700 mb-1">νμ΄ν”„λΌμΈ ν”λ¬μ‹</h4>
                    <p class="text-sm text-purple-600">μ§„ν–‰ μ¤‘μΈ λ…λ Ήμ–΄ νκΈ° β†’ νμ΄ν”„λΌμΈ μ¬μ¶©μ „ λΉ„μ©</p>
                </div>
            </div>

            <!-- λΉ„μ© μ°¨νΈ -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">λ¬Έλ§¥ κµν™ λΉ„μ© μ”μ† λΉ„κµ</h3>
            <div class="chart-container mb-2">
                <canvas id="contextCostChart"></canvas>
            </div>
            <p class="text-xs text-gray-400 text-center">* μν–¥λ„λ” μƒλ€μ  λΉ„κµλ¥Ό μ„ν• μμ‹ κ°’μ…λ‹λ‹¤.</p>
        </div>
    </div>

    <!-- ===== νƒ­4: μ„±λ¥ λ° μ—°κ΄€ μ΄λ΅  ===== -->
    <div id="performance" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6">μ„±λ¥ λ¶„μ„ λ° μ—°κ΄€ μ΄λ΅ </h2>

            <!-- μΈν„°λ½νΈ μ§€μ—° μ‹κ°„ -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">μΈν„°λ½νΈ μ§€μ—° μ‹κ°„ (Interrupt Latency)</h3>
            <p class="text-gray-600 leading-relaxed mb-4">μΈν„°λ½νΈ λ°μƒλ¶€ν„° ISR μ²« λ²μ§Έ λ…λ Ήμ–΄ μ‹¤ν–‰κΉμ§€μ μ‹κ°„. RTOSμ—μ„λ” μ΄ μ§€μ—° μ‹κ°„ λ³΄μ¥μ΄ ν•µμ‹¬ μ”κµ¬μ‚¬ν•­μ΄λ‹¤.</p>
            <div class="overflow-x-auto mb-6">
                <table class="w-full text-sm border-collapse">
                    <thead><tr class="bg-gray-50">
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">κµ¬κ°„</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">μ†μ” μ‹κ°„</th>
                        <th class="border border-gray-200 px-3 py-2 text-left font-bold">κ²°μ • μ”μΈ</th>
                    </tr></thead>
                    <tbody>
                        <tr><td class="border border-gray-200 px-3 py-2">μΈν„°λ½νΈ μΈμ‹</td><td class="border border-gray-200 px-3 py-2">μ ns ~ μμ‹­ ns</td><td class="border border-gray-200 px-3 py-2">PIC/APIC μ²λ¦¬ μ†λ„</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2">λ…λ Ήμ–΄ μ™„λ£ λ€κΈ°</td><td class="border border-gray-200 px-3 py-2">0 ~ μλ°± ns</td><td class="border border-gray-200 px-3 py-2">ν„μ¬ λ…λ Ήμ–΄ λ³µμ΅λ„</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2">PSW/PC μλ™ μ €μ¥</td><td class="border border-gray-200 px-3 py-2">μμ‹­ ns</td><td class="border border-gray-200 px-3 py-2">μ¤νƒ λ©”λ¨λ¦¬ μ ‘κ·Ό μ†λ„</td></tr>
                        <tr><td class="border border-gray-200 px-3 py-2">ISR μ§„μ…</td><td class="border border-gray-200 px-3 py-2">μμ‹­ ~ μλ°± ns</td><td class="border border-gray-200 px-3 py-2">IDT μ°Έμ΅°, λ¶„κΈ° μμΈ΅</td></tr>
                        <tr class="bg-indigo-50 font-medium"><td class="border border-gray-200 px-3 py-2">μ „μ²΄ μ§€μ—°</td><td class="border border-gray-200 px-3 py-2 text-indigo-700">0.5 ~ 10 ΞΌs</td><td class="border border-gray-200 px-3 py-2">μ‹μ¤ν… μ•„ν‚¤ν…μ²μ— λ”°λΌ μ°¨μ΄</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- μµμ ν™” κΈ°λ²• β€” strategy-card -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">μµμ ν™” κΈ°λ²• (ν΄λ¦­ν•μ—¬ νΌμΉκΈ°)</h3>
            <div class="space-y-3 mb-8">
                <div class="bg-white rounded-xl border-2 border-indigo-200 p-4 cursor-pointer hover:shadow-md transition-all" onclick="toggleStrategy(this)">
                    <div class="strategy-summary flex justify-between items-center">
                        <div><span class="text-indigo-700 font-bold">Top Half / Bottom Half λ¶„λ¦¬</span><span class="text-xs text-gray-400 ml-2">β€” ISRμ„ κΈ΄κΈ‰/μ§€μ—° μ²λ¦¬λ΅ λ¶„λ¦¬</span></div>
                        <span class="text-gray-400">β–Ό</span>
                    </div>
                    <div class="strategy-detail hidden mt-3 pt-3 border-t border-gray-200 text-sm text-gray-600 leading-relaxed">
                        <p>ISRμ„ κΈ΄κΈ‰ μ²λ¦¬(Top Half)μ™€ μ§€μ—° μ²λ¦¬(Bottom Half)λ΅ λ¶„λ¦¬ν•λ‹¤. Top Halfλ” μµμ†ν•μ κΈ΄κΈ‰ μ‘μ—…λ§ μν–‰ν•κ³ , λ‚λ¨Έμ§€λ” Bottom Halfλ΅ λ―Έλ£¬λ‹¤. Linuxμ—μ„ softirq, tasklet, workqueueκ°€ μ΄ Bottom Half λ©”μ»¤λ‹μ¦μ΄λ‹¤. μΈν„°λ½νΈ λΉ„ν™μ„±ν™” μ‹κ°„μ„ μµμ†ν™”ν•μ—¬ μ‹μ¤ν… μ‘λ‹µμ„±μ„ λ†’μΈλ‹¤.</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl border-2 border-green-200 p-4 cursor-pointer hover:shadow-md transition-all" onclick="toggleStrategy(this)">
                    <div class="strategy-summary flex justify-between items-center">
                        <div><span class="text-green-700 font-bold">Threaded Interrupt</span><span class="text-xs text-gray-400 ml-2">β€” ISRμ„ μ»¤λ„ μ¤λ λ“λ΅ μ‹¤ν–‰</span></div>
                        <span class="text-gray-400">β–Ό</span>
                    </div>
                    <div class="strategy-detail hidden mt-3 pt-3 border-t border-gray-200 text-sm text-gray-600 leading-relaxed">
                        <p>ISRμ„ μ»¤λ„ μ¤λ λ“λ΅ μ‹¤ν–‰ν•μ—¬ μ„ μ  κ°€λ¥ν•κ² λ§λ“ λ‹¤. μ°μ„ μμ„κ°€ λ†’μ€ λ‹¤λ¥Έ μΈν„°λ½νΈμ— μν•΄ μ¤‘λ‹¨λ  μ μμ–΄, μ‹¤μ‹κ°„ μ‹μ¤ν…μ—μ„ μ μ—°ν• μ°μ„ μμ„ μ μ–΄κ°€ κ°€λ¥ν•λ‹¤.</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl border-2 border-purple-200 p-4 cursor-pointer hover:shadow-md transition-all" onclick="toggleStrategy(this)">
                    <div class="strategy-summary flex justify-between items-center">
                        <div><span class="text-purple-700 font-bold">Interrupt Coalescing</span><span class="text-xs text-gray-400 ml-2">β€” λ‹¤μ μΈν„°λ½νΈλ¥Ό λ¬¶μ–΄ μ²λ¦¬</span></div>
                        <span class="text-gray-400">β–Ό</span>
                    </div>
                    <div class="strategy-detail hidden mt-3 pt-3 border-t border-gray-200 text-sm text-gray-600 leading-relaxed">
                        <p>NIC(λ„¤νΈμ›ν¬ μΉ΄λ“)μ—μ„ ν¨ν‚·λ§λ‹¤ μΈν„°λ½νΈλ¥Ό κ±Έλ©΄ μ΄λ‹Ή μλ§ λ²μ μΈν„°λ½νΈκ°€ λ°μƒν•λ‹¤. Coalescingμ€ μΌμ • μμ ν¨ν‚· λλ” μΌμ • μ‹κ°„ λ‹¨μ„λ΅ λ¬¶μ–΄μ„ ν• λ²μ— μ²λ¦¬ν•μ—¬ μΈν„°λ½νΈ λΉλ„λ¥Ό νκΈ°μ μΌλ΅ μ¤„μΈλ‹¤.</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl border-2 border-amber-200 p-4 cursor-pointer hover:shadow-md transition-all" onclick="toggleStrategy(this)">
                    <div class="strategy-summary flex justify-between items-center">
                        <div><span class="text-amber-700 font-bold">NAPI (Linux)</span><span class="text-xs text-gray-400 ml-2">β€” μΈν„°λ½νΈ + ν΄λ§ νΌν•© λ°©μ‹</span></div>
                        <span class="text-gray-400">β–Ό</span>
                    </div>
                    <div class="strategy-detail hidden mt-3 pt-3 border-t border-gray-200 text-sm text-gray-600 leading-relaxed">
                        <p>New API. ν‰μƒμ‹μ—λ” μΈν„°λ½νΈ λ°©μ‹μ„ μ‚¬μ©ν•λ‹¤κ°€, κ³ λ¶€ν• μ‹ ν΄λ§ λ°©μ‹μΌλ΅ μ „ν™ν•μ—¬ μΈν„°λ½νΈ μ¤ν†°(Interrupt Storm)μ„ λ°©μ§€ν•λ‹¤. Linux λ„¤νΈμ›ν¬ μ„λΈμ‹μ¤ν…μ ν•µμ‹¬ μµμ ν™” κΈ°λ²•μ΄λ‹¤.</p>
                    </div>
                </div>
            </div>

            <!-- μ—°κ΄€ μ΄λ΅  -->
            <h3 class="text-lg font-bold text-gray-800 mb-4">μ—°κ΄€ μ΄λ΅  μ—°κ²°</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-blue-50 rounded-xl p-5 border border-blue-200">
                    <h4 class="font-bold text-blue-700 mb-2">DMAμ™€μ κ΄€κ³„</h4>
                    <p class="text-sm text-blue-600 leading-relaxed">DMA μ»¨νΈλ΅¤λ¬λ” CPU κ°μ… μ—†μ΄ I/Oβ†”λ©”λ¨λ¦¬ μ§μ ‘ μ „μ†΅. μ „μ†΅ μ™„λ£ μ‹ CPUμ— μΈν„°λ½νΈ λ°μƒ. λ‘ κ°λ…μ€ μƒνΈ λ³΄μ™„μ .</p>
                </div>
                <div class="bg-teal-50 rounded-xl p-5 border border-teal-200">
                    <h4 class="font-bold text-teal-700 mb-2">μ‹μ¤ν… μ½κ³Όμ κ΄€κ³„</h4>
                    <p class="text-sm text-teal-600 leading-relaxed">μ‹μ¤ν… μ½μ€ μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ(Trap)λ΅ κµ¬ν„. INT 0x80 λλ” SYSCALL β†’ λ™μΌν• λ¨λ“ μ „ν™, μ»¨ν…μ¤νΈ μ €μ¥ λ©”μ»¤λ‹μ¦ μ‘λ™.</p>
                </div>
                <div class="bg-purple-50 rounded-xl p-5 border border-purple-200">
                    <h4 class="font-bold text-purple-700 mb-2">ν”„λ΅μ„Έμ¤ μƒνƒ μ „μ΄</h4>
                    <p class="text-sm text-purple-600 leading-relaxed">νƒ€μ΄λ¨Έ μΈν„°λ½νΈ β†’ Runningβ†’Ready (μ„ μ ). I/O μ™„λ£ μΈν„°λ½νΈ β†’ Blockedβ†’Ready. μΈν„°λ½νΈλ” ν”„λ΅μ„Έμ¤ μ¤μΌ€μ¤„λ§μ λ¬Όλ¦¬μ  κΈ°λ°.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== νƒ­5: μ›λ¬Έ ν•™μµ ===== -->
    <div id="textbook" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in textbook-content">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6" style="border:none;padding:0;">μ›λ¬Έ ν•™μµ</h2>

            <!-- ========== μ 1λ¶€ μƒμ„Έ ν•΄μ„¤ ========== -->
            <div class="bg-indigo-50 rounded-lg px-4 py-2 mb-6 inline-block"><span class="text-sm font-bold text-indigo-700">μ 1λ¶€ β€” μƒμ„Έ ν•΄μ„¤</span></div>

            <h3>μ 1μ¥ κ°μ” λ° λ°°κ²½</h3>
            <h4>1.1 μΈν„°λ½νΈμ μ •μμ™€ ν•„μ”μ„±</h4>
            <p>μΈν„°λ½νΈ(Interrupt)λ€ CPUκ°€ ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄ μ²λ¦¬λ¥Ό μΌμ‹ μ¤‘λ‹¨ν•κ³ , κΈ΄κΈ‰ν•κ±°λ‚ μ°μ„ μ μΈ μ²λ¦¬κ°€ ν•„μ”ν• μ‚¬κ±΄(Event)μ— λ€μ‘ν•κΈ° μ„ν•΄ μ μ–΄κ¶μ„ νΉμ • μ„λΉ„μ¤ λ£¨ν‹΄μΌλ΅ μ΄μ „ν•λ” λ©”μ»¤λ‹μ¦μ΄λ‹¤. μΈν„°λ½νΈλ” μ΄μμ²΄μ  μ»¤λ„μ ν•µμ‹¬ λ™μ‘ μ›λ¦¬μ΄μ, ν„λ€ μ»΄ν“¨ν„° μ‹μ¤ν…μ <strong>λΉ„λ™κΈ°μ  μ΄λ²¤νΈ μ²λ¦¬(Asynchronous Event Handling)</strong>λ¥Ό κ°€λ¥ν•κ² ν•λ” κ·Όλ³Έ λ©”μ»¤λ‹μ¦μ΄λ‹¤.</p>
            <p>μΈν„°λ½νΈκ°€ μ—†λ” μ‹μ¤ν…μ—μ„λ” CPUκ°€ I/O μ¥μΉμ μ‘μ—… μ™„λ£λ¥Ό μ§€μ†μ μΌλ΅ ν™•μΈν•λ” <strong>ν΄λ§(Polling)</strong> λ°©μ‹μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤. μ΄ λ°©μ‹μ€ CPUκ°€ I/O μ™„λ£ μ—¬λ¶€λ¥Ό λ°λ³µμ μΌλ΅ κ²€μ‚¬ν•λ―€λ΅ CPU μμ›μ„ κ·Ήλ„λ΅ λ‚­λΉ„ν•λ‹¤. Intelμ λ²¤μΉλ§ν¬μ— λ”°λ¥΄λ©΄, ν΄λ§ λ°©μ‹μ€ CPU μ‹κ°„μ μµλ€ 90%λ¥Ό I/O λ€κΈ°μ— μ†λ¨ν•  μ μμΌλ©°, μΈν„°λ½νΈ λ°©μ‹μ€ μ΄λ¥Ό 2~5% μμ¤€μΌλ΅ κ°μ†μ‹ν‚¨λ‹¤.</p>

            <h4>1.2 μΈν„°λ½νΈμ λ¶„λ¥</h4>
            <p>μΈν„°λ½νΈλ” λ°μƒ μ›μΈκ³Ό νΉμ„±μ— λ”°λΌ λ‹¤μκ³Ό κ°™μ΄ λ¶„λ¥λλ‹¤.</p>
            <table>
                <thead><tr><th>λ¶„λ¥ κΈ°μ¤€</th><th>μ ν•</th><th>μ„¤λ…</th><th>μμ‹</th></tr></thead>
                <tbody>
                    <tr><td rowspan="2">λ°μƒ μ›μΈ</td><td>ν•λ“μ›¨μ–΄ μΈν„°λ½νΈ (External)</td><td>CPU μ™Έλ¶€μ ν•λ“μ›¨μ–΄ μ¥μΉκ°€ λ°μƒμ‹ν‚¤λ” μ‹ νΈ</td><td>ν‚¤λ³΄λ“ μ…λ ¥, λ””μ¤ν¬ I/O μ™„λ£, νƒ€μ΄λ¨Έ λ§λ£, λ„¤νΈμ›ν¬ ν¨ν‚· λ„μ°©</td></tr>
                    <tr><td>μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ (Internal)</td><td>CPU λ‚΄λ¶€μ—μ„ λ…λ Ήμ–΄ μ‹¤ν–‰ μ¤‘ λ°μƒν•λ” μ‚¬κ±΄</td><td>0μΌλ΅ λ‚λ„κΈ°, μ¤λ²„ν”λ΅μ°, μ‹μ¤ν… μ½(INT 0x80)</td></tr>
                    <tr><td rowspan="2">μ²λ¦¬ μ‹μ </td><td>λ™κΈ°μ  (Synchronous)</td><td>λ…λ Ήμ–΄ μ‹¤ν–‰μ μ§μ ‘μ  κ²°κ³Όλ΅ λ°μƒ</td><td>νΈλ©(Trap), ν΄νΈ(Fault), μ‹μ¤ν… μ½</td></tr>
                    <tr><td>λΉ„λ™κΈ°μ  (Asynchronous)</td><td>ν„μ¬ μ‹¤ν–‰κ³Ό λ¬΄κ΄€ν•κ² μ™Έλ¶€μ—μ„ λ°μƒ</td><td>I/O μ™„λ£, νƒ€μ΄λ¨Έ, ν•λ“μ›¨μ–΄ μ¤λ¥</td></tr>
                    <tr><td rowspan="2">λ³µκ·€ κ°€λ¥μ„±</td><td>λ³µκ·€ κ°€λ¥ (Recoverable)</td><td>μ›μΈ ν•΄κ²° ν›„ μ¤‘λ‹¨ μ§€μ μΌλ΅ λ³µκ·€ κ°€λ¥</td><td>νμ΄μ§€ ν΄νΈ β†’ νμ΄μ§€ λ΅λ“ ν›„ μ¬μ‹¤ν–‰</td></tr>
                    <tr><td>λ³µκ·€ λ¶κ°€ (Non-recoverable)</td><td>μ‹μ¤ν… μ¤‘λ‹¨ λλ” ν”„λ΅μ„Έμ¤ μΆ…λ£</td><td>ν•λ“μ›¨μ–΄ μ¤λ¥, λ³΄νΈ μ„λ°(Protection Fault)</td></tr>
                </tbody>
            </table>
            <div class="insight-box"><span>λ‹µμ• μ‘μ„± ν•µμ‹¬: μΈν„°λ½νΈλ¥Ό λ‹¨μν "ν•λ“μ›¨μ–΄/μ†ν”„νΈμ›¨μ–΄"λ΅λ§ κµ¬λ¶„ν•λ©΄ ν•©κ²©κ¶μ΄λ‹¤. λ™κΈ°/λΉ„λ™κΈ°, λ³µκ·€ κ°€λ¥/λ¶κ°€λ¥κΉμ§€ ν•¨κ» λ¶„λ¥ν•λ©΄ κΉμ΄κ°€ λ‹¬λΌμ§„λ‹¤. λ‘λ¬Έμμ–΄ <strong>"ν•μ†λ™λΉ„λ³µ"</strong>μΌλ΅ 3κ°€μ§€ λ¶„λ¥ μ¶•μ„ μ•”κΈ°ν•λ‹¤.</span></div>

            <h3>μ 2μ¥ λ™μ‘ ν™κ²½ β€” CPUμ™€ μΈν„°λ½νΈ ν•λ“μ›¨μ–΄ κµ¬μ„±</h3>
            <h4>2.1 CPU λ‚΄λ¶€ μ£Όμ” λ μ§€μ¤ν„°</h4>
            <p>μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ •μ„ μ΄ν•΄ν•λ ¤λ©΄, CPU λ‚΄λ¶€μ ν•µμ‹¬ λ μ§€μ¤ν„°λ¥Ό μ •ν™•ν μ•μ•„μ•Ό ν•λ‹¤.</p>
            <table>
                <thead><tr><th>λ μ§€μ¤ν„°</th><th>λ…μΉ­</th><th>μ—­ν• </th><th>μΈν„°λ½νΈ μ‹ λ™μ‘</th></tr></thead>
                <tbody>
                    <tr><td>PC</td><td>ν”„λ΅κ·Έλ¨ μΉ΄μ΄ν„°</td><td>λ‹¤μμ— μ‹¤ν–‰ν•  λ…λ Ήμ–΄μ λ©”λ¨λ¦¬ μ£Όμ† μ €μ¥</td><td>ISR μ‹μ‘ μ£Όμ†λ΅ λ³€κ²½λ¨</td></tr>
                    <tr><td>SP</td><td>μ¤νƒ ν¬μΈν„°</td><td>ν„μ¬ μ¤νƒμ μµμƒμ„ μ£Όμ† μ €μ¥</td><td>μ»¤λ„ μ¤νƒ ν¬μΈν„°λ΅ μ „ν™λ¨</td></tr>
                    <tr><td>PSW</td><td>ν”„λ΅κ·Έλ¨ μƒνƒ μ›λ“</td><td>CPU μƒνƒ ν”λκ·Έ(μΈν„°λ½νΈ ν—μ©, λ¨λ“ λΉ„νΈ, μ΅°κ±΄ μ½”λ“)</td><td>μ»¤λ„ λ¨λ“λ΅ μ „ν™, μΈν„°λ½νΈ λΉ„ν™μ„±ν™”</td></tr>
                    <tr><td>GPR</td><td>λ²”μ© λ μ§€μ¤ν„°</td><td>μ—°μ‚° λ°μ΄ν„° μ„μ‹ μ €μ¥ (R0~R15 λ“±)</td><td>PCBμ— λ°±μ—… μ €μ¥λ¨</td></tr>
                    <tr><td>MAR/MBR</td><td>λ©”λ¨λ¦¬ μ£Όμ†/λ²„νΌ λ μ§€μ¤ν„°</td><td>λ©”λ¨λ¦¬ μ ‘κ·Ό μ‹ μ£Όμ†μ™€ λ°μ΄ν„° μ €μ¥</td><td>μ»¨ν…μ¤νΈμ μΌλ¶€λ΅ μ €μ¥</td></tr>
                </tbody>
            </table>
            <h4>2.2 μΈν„°λ½νΈ ν•λ“μ›¨μ–΄ κµ¬μ„±μ”μ†</h4>
            <table>
                <thead><tr><th>κµ¬μ„±μ”μ†</th><th>μ—­ν• </th><th>λ™μ‘</th></tr></thead>
                <tbody>
                    <tr><td>μΈν„°λ½νΈ μ”μ²­ λΌμΈ (IRQ)</td><td>μ¥μΉ β†’ CPUλ΅ μΈν„°λ½νΈ μ‹ νΈ μ „λ‹¬</td><td>μ¥μΉκ°€ IRQ ν•€μ— μ „κΈ° μ‹ νΈ μΈκ°€</td></tr>
                    <tr><td>PIC (Programmable Interrupt Controller)</td><td>λ‹¤μμ IRQλ¥Ό μ°μ„ μμ„μ— λ”°λΌ κ΄€λ¦¬</td><td>Intel 8259A (λ κ±°μ‹), APIC (ν„λ€)</td></tr>
                    <tr><td>IDT (Interrupt Descriptor Table)</td><td>μΈν„°λ½νΈ λ²νΈ β†’ ISR μ£Όμ† λ§¤ν•‘ ν…μ΄λΈ”</td><td>x86: μµλ€ 256κ° μ—”νΈλ¦¬</td></tr>
                    <tr><td>IVT (Interrupt Vector Table)</td><td>μΈν„°λ½νΈ λ²΅ν„° β†’ ISR μ£Όμ† λ§¤ν•‘ (λ κ±°μ‹)</td><td>λ¦¬μ–Ό λ¨λ“μ—μ„ μ‚¬μ©</td></tr>
                </tbody>
            </table>

            <h3>μ 3μ¥ μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ • (λ‹¨κ³„λ³„ μ‹κ°„μ)</h3>
            <p>μΈν„°λ½νΈ λ°μƒλ¶€ν„° μ²λ¦¬ μ™„λ£κΉμ§€μ μ „μ²΄ κ³Όμ •μ„ 8λ‹¨κ³„λ΅ μ •λ¦¬ν•λ‹¤. μ΄ κ³Όμ •μ€ <strong>ν•λ“μ›¨μ–΄ μλ™ μ²λ¦¬ λ‹¨κ³„</strong>μ™€ <strong>μ†ν”„νΈμ›¨μ–΄(OS μ»¤λ„) μ²λ¦¬ λ‹¨κ³„</strong>λ΅ κµ¬λ¶„λλ‹¤.</p>

            <h4>3.1 μ „μ²΄ μ²λ¦¬ νλ¦„λ„</h4>
            <!-- νλ¦„λ„λ¥Ό HTML/CSS μ‹κ°ν™”λ΅ ν‘ν„ -->
            <div class="bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200">
                <div class="max-w-md mx-auto space-y-1 text-center">
                    <div class="bg-gray-100 border border-gray-300 rounded-full px-3 py-1 text-xs font-bold text-gray-600 inline-block">ν”„λ΅μ„Έμ¤ A μ‹¤ν–‰ μ¤‘</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="text-[10px] text-red-500 font-bold">β”€β”€ H/W μλ™ μν–‰ β”€β”€</div>
                    <div class="bg-red-50 border border-red-200 rounded px-3 py-1 text-xs">β‘  μΈν„°λ½νΈ λ°μƒ (IRQ μ‹ νΈ)</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-red-50 border border-red-200 rounded px-3 py-1 text-xs">β‘΅ CPU: ν„μ¬ λ…λ Ήμ–΄ μ™„λ£ λ€κΈ°</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-red-50 border border-red-200 rounded px-3 py-1 text-xs">β‘Ά CPU: μΈν„°λ½νΈ μΈμ‹ λ° ν™•μΈ (INTA)</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-red-50 border border-red-300 rounded px-3 py-1 text-xs font-medium">β‘£ CPU: PSW, PCλ¥Ό μ»¤λ„ μ¤νƒμ— μλ™ μ €μ¥</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-red-50 border border-red-200 rounded px-3 py-1 text-xs">β‘¤ CPU: λ¨λ“ μ „ν™ (Userβ†’Kernel), μΈν„°λ½νΈ λΉ„ν™μ„±ν™”</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="text-[10px] text-blue-500 font-bold">β”€β”€ S/W (OS μ»¤λ„) μν–‰ β”€β”€</div>
                    <div class="bg-blue-50 border border-blue-300 rounded px-3 py-1 text-xs font-medium">β‘¥ OS: λ‚λ¨Έμ§€ μ»¨ν…μ¤νΈ(GPR λ“±) PCBμ— μ €μ¥</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-blue-50 border border-blue-200 rounded px-3 py-1 text-xs">β‘¦ OS: ISR(Interrupt Service Routine) μ‹¤ν–‰</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-blue-50 border border-blue-200 rounded px-3 py-1 text-xs">β‘§ OS: μ¤μΌ€μ¤„λ¬ νΈμ¶ β†’ λ‹¤μ ν”„λ΅μ„Έμ¤ κ²°μ •</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-blue-50 border border-blue-200 rounded px-3 py-1 text-xs">β‘¨ OS: μ„ νƒλ ν”„λ΅μ„Έμ¤μ PCBμ—μ„ μ»¨ν…μ¤νΈ λ³µμ›</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-green-100 border border-green-300 rounded-full px-3 py-1 text-xs font-bold text-green-700 inline-block">β‘© λ³µμ›λ ν”„λ΅μ„Έμ¤ μ‹¤ν–‰ μ¬κ°</div>
                </div>
            </div>

            <h4>3.2 κ° λ‹¨κ³„ μƒμ„Έ</h4>
            <p><strong>[1λ‹¨κ³„] μΈν„°λ½νΈ λ°μƒ</strong></p>
            <p>ν•λ“μ›¨μ–΄ μ¥μΉκ°€ μΈν„°λ½νΈ μ”μ²­ λΌμΈ(IRQ)μ— μ „κΈ° μ‹ νΈλ¥Ό μΈκ°€ν•λ‹¤. PIC(Programmable Interrupt Controller)κ°€ μ΄ μ‹ νΈλ¥Ό μμ‹ ν•μ—¬ μ°μ„ μμ„λ¥Ό νλ³„ν• ν›„, CPUμ INT ν•€μ— μΈν„°λ½νΈ μ‹ νΈλ¥Ό μ „λ‹¬ν•λ‹¤. ν„λ€ x86 μ‹μ¤ν…μ—μ„λ” APIC(Advanced PIC)κ°€ μ΄ μ—­ν• μ„ μν–‰ν•λ©°, MSI(Message Signaled Interrupt) λ°©μ‹μΌλ΅ λ©”λ¨λ¦¬ μ“°κΈ°λ¥Ό ν†µν•΄ μΈν„°λ½νΈλ¥Ό μ „λ‹¬ν•κΈ°λ„ ν•λ‹¤.</p>
            <p><strong>[2λ‹¨κ³„] ν„μ¬ λ…λ Ήμ–΄ μ™„λ£ λ€κΈ°</strong></p>
            <p>CPUλ” ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄λ¥Ό μ™„λ£ν• ν›„μ—μ•Ό μΈν„°λ½νΈλ¥Ό μ²λ¦¬ν•λ‹¤. μ΄λ” CPUμ μ›μμ (Atomic) λ…λ Ήμ–΄ μ‹¤ν–‰ λ³΄μ¥μ„ μ„ν•¨μ΄λ‹¤. λ‹¨, NMI(Non-Maskable Interrupt)λ” μ΄ κ·μΉ™μ μμ™Έλ΅, ν•λ“μ›¨μ–΄ μΉλ…μ  μ¤λ¥ μ‹ μ¦‰μ‹ μ²λ¦¬λλ‹¤.</p>
            <p><strong>[3λ‹¨κ³„] μΈν„°λ½νΈ μΈμ‹ λ° ν™•μΈ (INTA)</strong></p>
            <p>CPUλ” PSWμ μΈν„°λ½νΈ ν—μ© λΉ„νΈ(IF, Interrupt Flag)λ¥Ό κ²€μ‚¬ν•λ‹¤. IF=1μ΄λ©΄ μΈν„°λ½νΈλ¥Ό μμ©ν•κ³ , PICμ— INTA(Interrupt Acknowledge) μ‹ νΈλ¥Ό λ³΄λ‚Έλ‹¤. PICλ” μΈν„°λ½νΈ λ²΅ν„° λ²νΈλ¥Ό λ°μ΄ν„° λ²„μ¤μ— μ‹¤μ–΄ CPUμ— μ „λ‹¬ν•λ‹¤.</p>
            <p><strong>[4λ‹¨κ³„] PSW, PC μλ™ μ €μ¥ (ν•λ“μ›¨μ–΄ μν–‰)</strong></p>
            <p>CPUλ” <strong>ν•λ“μ›¨μ–΄μ μΌλ΅(μλ™μΌλ΅)</strong> ν„μ¬μ PSWμ™€ PC κ°’μ„ μ»¤λ„ μ¤νƒμ— pushν•λ‹¤. μ΄ λ‹¨κ³„λ” μ†ν”„νΈμ›¨μ–΄μ κ°μ… μ—†μ΄ CPU λ§μ΄ν¬λ΅μ½”λ“μ— μν•΄ μν–‰λλ©°, μΈν„°λ½νΈ μ²λ¦¬μ μ›μμ„±μ„ λ³΄μ¥ν•λ” ν•µμ‹¬ λ©”μ»¤λ‹μ¦μ΄λ‹¤.</p>
            <table>
                <thead><tr><th>μ €μ¥ ν•­λ©</th><th>μ €μ¥ μ„μΉ</th><th>λ©μ </th></tr></thead>
                <tbody>
                    <tr><td>PC (Program Counter)</td><td>μ»¤λ„ μ¤νƒ</td><td>λ³µκ·€ μ£Όμ† λ³΄μ΅΄ (μ¤‘λ‹¨λ λ…λ Ήμ–΄μ λ‹¤μ μ£Όμ†)</td></tr>
                    <tr><td>PSW (Program Status Word)</td><td>μ»¤λ„ μ¤νƒ</td><td>CPU μƒνƒ(λ¨λ“ λΉ„νΈ, μ΅°κ±΄ μ½”λ“, IF) λ³΄μ΅΄</td></tr>
                </tbody>
            </table>
            <p><strong>[5λ‹¨κ³„] λ¨λ“ μ „ν™ λ° μΈν„°λ½νΈ λΉ„ν™μ„±ν™”</strong></p>
            <p>CPUλ” PSWμ λ¨λ“ λΉ„νΈλ¥Ό μ»¤λ„ λ¨λ“(Supervisor Mode)λ΅ μ „ν™ν•κ³ , μΈν„°λ½νΈ ν—μ© ν”λκ·Έ(IF)λ¥Ό 0μΌλ΅ μ„¤μ •ν•μ—¬ μ¶”κ°€ μΈν„°λ½νΈλ¥Ό μΌμ‹μ μΌλ΅ μ°¨λ‹¨ν•λ‹¤. λ™μ‹μ— IDT(Interrupt Descriptor Table)μ—μ„ μΈν„°λ½νΈ λ²΅ν„° λ²νΈμ— ν•΄λ‹Ήν•λ” ISRμ μ‹μ‘ μ£Όμ†λ¥Ό μ½μ–΄ PCμ— λ΅λ“ν•λ‹¤.</p>
            <p><strong>[6λ‹¨κ³„] λ‚λ¨Έμ§€ μ»¨ν…μ¤νΈ μ €μ¥ (μ†ν”„νΈμ›¨μ–΄/OS μν–‰)</strong></p>
            <p>ISRμ μ΄μ…λ¶€μ—μ„ μ΄μμ²΄μ  μ»¤λ„μ΄ <strong>μ†ν”„νΈμ›¨μ–΄μ μΌλ΅</strong> λ²”μ© λ μ§€μ¤ν„°(GPR), μ¤νƒ ν¬μΈν„°(SP) λ“± λ‚λ¨Έμ§€ CPU λ μ§€μ¤ν„° κ°’μ„ ν„μ¬ ν”„λ΅μ„Έμ¤μ PCB(Process Control Block)μ— μ €μ¥ν•λ‹¤. μ΄ κ³Όμ •μ΄ <strong>λ¬Έλ§¥ μ €μ¥(Context Save)</strong>μ΄λ‹¤.</p>
            <table>
                <thead><tr><th>μ €μ¥ ν•­λ©</th><th>μ €μ¥ μ„μΉ</th><th>λ°©λ²•</th></tr></thead>
                <tbody>
                    <tr><td>λ²”μ© λ μ§€μ¤ν„° (R0~R15)</td><td>PCBμ λ μ§€μ¤ν„° μμ—­</td><td>PUSH/MOV λ…λ Ήμ–΄ (μ†ν”„νΈμ›¨μ–΄)</td></tr>
                    <tr><td>μ¤νƒ ν¬μΈν„° (SP)</td><td>PCBμ SP ν•„λ“</td><td>MOV λ…λ Ήμ–΄</td></tr>
                    <tr><td>λ¶€λ™μ†μμ  λ μ§€μ¤ν„°</td><td>PCBμ FPU μμ—­</td><td>FXSAVE λ…λ Ήμ–΄ (x86)</td></tr>
                    <tr><td>κΈ°νƒ€ μ μ–΄ λ μ§€μ¤ν„°</td><td>PCBμ μ μ–΄ μμ—­</td><td>MOV λ…λ Ήμ–΄</td></tr>
                </tbody>
            </table>
            <p><strong>[7λ‹¨κ³„] ISR(Interrupt Service Routine) μ‹¤ν–‰</strong></p>
            <p>μΈν„°λ½νΈμ μ›μΈμ— ν•΄λ‹Ήν•λ” μ„λΉ„μ¤ λ£¨ν‹΄μ΄ μ‹¤ν–‰λλ‹¤. μλ¥Ό λ“¤μ–΄, λ””μ¤ν¬ I/O μ™„λ£ μΈν„°λ½νΈλΌλ©΄ DMA μ „μ†΅ μ™„λ£λ¥Ό ν™•μΈν•κ³ , λ€κΈ° μ¤‘μΈ ν”„λ΅μ„Έμ¤λ¥Ό Ready Queueλ΅ μ΄λ™μ‹ν‚¨λ‹¤. νƒ€μ΄λ¨Έ μΈν„°λ½νΈλΌλ©΄ μ‹κ°„ ν€€ν…€(Time Quantum) λ§λ£λ¥Ό ν™•μΈν•κ³  μ¤μΌ€μ¤„λ¬λ¥Ό νΈμ¶ν•λ‹¤.</p>
            <p><strong>[8λ‹¨κ³„] μ¤μΌ€μ¤„λ¬ νΈμ¶ λ° μ»¨ν…μ¤νΈ λ³µμ› (λ¬Έλ§¥ κµν™)</strong></p>
            <p>ISR μ²λ¦¬ μ™„λ£ ν›„, μ¤μΌ€μ¤„λ¬κ°€ νΈμ¶λμ–΄ λ‹¤μμ— μ‹¤ν–‰ν•  ν”„λ΅μ„Έμ¤λ¥Ό κ²°μ •ν•λ‹¤. μ„ νƒλ ν”„λ΅μ„Έμ¤μ PCBμ—μ„ λ μ§€μ¤ν„° κ°’λ“¤μ„ CPUμ— λ³µμ›ν•κ³ (Context Restore), IRET(Interrupt Return) λ…λ Ήμ–΄λ΅ PSWμ™€ PCλ¥Ό λ³µμ›ν•λ©΄ ν•΄λ‹Ή ν”„λ΅μ„Έμ¤κ°€ μ‹¤ν–‰μ„ μ¬κ°ν•λ‹¤.</p>

            <h3>μ 4μ¥ PCB(Process Control Block) μƒμ„Έ</h3>
            <h4>4.1 PCBμ μ •μμ™€ μ—­ν• </h4>
            <p>PCB(Process Control Block)λ” μ΄μμ²΄μ κ°€ κ° ν”„λ΅μ„Έμ¤λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν•΄ μ μ§€ν•λ” <strong>ν”„λ΅μ„Έμ¤λ³„ λ©”νƒ€λ°μ΄ν„° μλ£κµ¬μ΅°</strong>μ΄λ‹¤. ν”„λ΅μ„Έμ¤μ μƒμ„± μ‹ ν• λ‹Ήλκ³ , μΆ…λ£ μ‹ ν•΄μ λλ‹¤. PCBλ” μ»¤λ„ λ©”λ¨λ¦¬ μμ—­μ— μ €μ¥λλ©°, μ‚¬μ©μ ν”„λ΅μ„Έμ¤λ” μ§μ ‘ μ ‘κ·Όν•  μ μ—†λ‹¤.</p>
            <p>PCBμ ν•µμ‹¬ μ—­ν• μ€ <strong>λ¬Έλ§¥ κµν™(Context Switching)</strong> μ‹ ν”„λ΅μ„Έμ¤μ μ‹¤ν–‰ μƒνƒλ¥Ό μ™„μ „ν λ³΄μ΅΄ν•κ³  λ³µμ›ν•λ” κ²ƒμ΄λ‹¤. PCB μ—†μ΄λ” λ©€ν‹°νƒμ¤ν‚Ήμ΄ λ¶κ°€λ¥ν•λ‹¤.</p>

            <h4>4.2 PCB ν•„λ“ κµ¬μ„±</h4>
            <table>
                <thead><tr><th>ν•„λ“ κ·Έλ£Ή</th><th>ν•„λ“λ…</th><th>μ„¤λ…</th><th>μμ‹ κ°’</th></tr></thead>
                <tbody>
                    <tr><td rowspan="3">ν”„λ΅μ„Έμ¤ μ‹λ³„</td><td>PID (Process ID)</td><td>ν”„λ΅μ„Έμ¤ κ³ μ  μ‹λ³„μ</td><td>1234</td></tr>
                    <tr><td>PPID (Parent PID)</td><td>λ¶€λ¨ ν”„λ΅μ„Έμ¤ μ‹λ³„μ</td><td>1 (init)</td></tr>
                    <tr><td>UID/GID</td><td>μ†μ μ/κ·Έλ£Ή μ‹λ³„μ</td><td>1000/1000</td></tr>
                    <tr><td rowspan="4">CPU λ μ§€μ¤ν„°</td><td>PC (Program Counter)</td><td>λ‹¤μ μ‹¤ν–‰ λ…λ Ήμ–΄ μ£Όμ†</td><td>0x00401234</td></tr>
                    <tr><td>SP (Stack Pointer)</td><td>μ¤νƒ μµμƒμ„ μ£Όμ†</td><td>0x7FFF0000</td></tr>
                    <tr><td>PSW/FLAGS</td><td>CPU μƒνƒ ν”λκ·Έ</td><td>IF=1, ZF=0, SF=0</td></tr>
                    <tr><td>λ²”μ© λ μ§€μ¤ν„° (GPR)</td><td>R0~R15 λ“± μ—°μ‚° λ μ§€μ¤ν„° κ°’</td><td>κ° λ μ§€μ¤ν„°λ³„ μ €μ¥</td></tr>
                    <tr><td rowspan="2">ν”„λ΅μ„Έμ¤ μƒνƒ</td><td>State</td><td>ν”„λ΅μ„Έμ¤ ν„μ¬ μƒνƒ</td><td>Running/Ready/Blocked</td></tr>
                    <tr><td>Priority</td><td>μ¤μΌ€μ¤„λ§ μ°μ„ μμ„</td><td>120 (Linux nice 0)</td></tr>
                    <tr><td rowspan="2">λ©”λ¨λ¦¬ κ΄€λ¦¬</td><td>νμ΄μ§€ ν…μ΄λΈ” ν¬μΈν„°</td><td>ν”„λ΅μ„Έμ¤μ κ°€μƒ λ©”λ¨λ¦¬ λ§¤ν•‘</td><td>CR3 λ μ§€μ¤ν„° κ°’</td></tr>
                    <tr><td>λ©”λ¨λ¦¬ ν•κ³„(Base/Limit)</td><td>ν• λ‹Ήλ λ©”λ¨λ¦¬ μμ—­</td><td>Base=0x1000, Limit=4MB</td></tr>
                    <tr><td rowspan="2">μ¤μΌ€μ¤„λ§</td><td>CPU μ‚¬μ© μ‹κ°„</td><td>λ„μ  CPU burst μ‹κ°„</td><td>150ms</td></tr>
                    <tr><td>λ€κΈ° μ‹κ°„</td><td>Ready Queue λ€κΈ° μ‹κ°„</td><td>30ms</td></tr>
                    <tr><td rowspan="2">I/O μ •λ³΄</td><td>μ—΄λ¦° νμΌ λ©λ΅</td><td>ν”„λ΅μ„Έμ¤κ°€ μ‚¬μ© μ¤‘μΈ νμΌ λ””μ¤ν¬λ¦½ν„°</td><td>fd 0,1,2,3</td></tr>
                    <tr><td>I/O μ¥μΉ ν• λ‹Ή μ •λ³΄</td><td>μ‚¬μ© μ¤‘μΈ I/O μ¥μΉ</td><td>/dev/sda1, eth0</td></tr>
                    <tr><td>κ³„μ • μ •λ³΄</td><td>μ‹μ‘ μ‹κ°„, CPU λ„μ  μ‹κ°„</td><td>μμ› μ‚¬μ© ν†µκ³„</td><td>Start: 14:30:00</td></tr>
                </tbody>
            </table>

            <h4>4.3 PCBμ™€ λ¬Έλ§¥ κµν™(Context Switching)</h4>
            <p>λ¬Έλ§¥ κµν™μ€ CPUκ°€ ν„μ¬ ν”„λ΅μ„Έμ¤(Pβ‚)μ μ‹¤ν–‰μ„ μ¤‘λ‹¨ν•κ³  λ‹¤λ¥Έ ν”„λ΅μ„Έμ¤(Pβ‚‚)μ μ‹¤ν–‰μ„ μ¬κ°ν•λ” κ³Όμ •μ΄λ‹¤. μ΄ κ³Όμ •μ—μ„ PCBκ°€ ν•µμ‹¬ μ—­ν• μ„ μν–‰ν•λ‹¤.</p>
            <!-- λ¬Έλ§¥ κµν™ λ„μ‹ β€” HTML/CSS μ‹κ°ν™” -->
            <div class="bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200">
                <div class="max-w-md mx-auto space-y-1 text-center">
                    <div class="flex justify-between">
                        <span class="bg-indigo-100 border border-indigo-300 rounded px-2 py-1 text-xs font-bold text-indigo-700">Pβ‚ μ‹¤ν–‰ μ¤‘</span>
                        <span class="bg-gray-100 border border-gray-300 rounded px-2 py-1 text-xs text-gray-500">Pβ‚‚ λ€κΈ° μ¤‘</span>
                    </div>
                    <div class="text-gray-300 text-xs">β†“ μΈν„°λ½νΈ λ°μƒ</div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded px-3 py-1 text-xs">Pβ‚μ CPU μƒνƒ β†’ PCBβ‚μ— μ €μ¥</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-gray-100 border border-gray-300 rounded px-3 py-1 text-xs font-medium">μ¤μΌ€μ¤„λ¬: Pβ‚‚ μ„ νƒ</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="bg-green-50 border border-green-200 rounded px-3 py-1 text-xs">PCBβ‚‚μ—μ„ CPU μƒνƒ β†’ CPUμ— λ³µμ›</div>
                    <div class="text-gray-300 text-xs">β†“</div>
                    <div class="flex justify-between">
                        <span class="bg-gray-100 border border-gray-300 rounded px-2 py-1 text-xs text-gray-500">Pβ‚ Ready λ€κΈ°</span>
                        <span class="bg-green-100 border border-green-300 rounded px-2 py-1 text-xs font-bold text-green-700">Pβ‚‚ μ‹¤ν–‰ μ¬κ°</span>
                    </div>
                </div>
            </div>
            <p><strong>λ¬Έλ§¥ κµν™ λΉ„μ©</strong>: λ¬Έλ§¥ κµν™μ€ μμν• μ¤λ²„ν—¤λ“(Pure Overhead)μ΄λ‹¤. λ¬Έλ§¥ κµν™μ΄ μ§„ν–‰λλ” λ™μ• CPUλ” μ μ©ν• μ‘μ—…μ„ μν–‰ν•μ§€ μ•λ”λ‹¤. μΌλ°μ μΌλ΅ λ¬Έλ§¥ κµν™μ— μ†μ”λλ” μ‹κ°„μ€ <strong>1~10λ§μ΄ν¬λ΅μ΄(ΞΌs)</strong> μμ¤€μ΄λ©°, μ΄λ” ν”„λ΅μ„Έμ„ μ†λ„, PCB ν¬κΈ°, μΊμ‹ λ¬΄ν¨ν™”(Cache Invalidation) λΉ„μ©μ— λ”°λΌ λ‹¬λΌμ§„λ‹¤.</p>
            <table>
                <thead><tr><th>λ¬Έλ§¥ κµν™ λΉ„μ© μ”μ†</th><th>μ„¤λ…</th><th>μν–¥</th></tr></thead>
                <tbody>
                    <tr><td>λ μ§€μ¤ν„° μ €μ¥/λ³µμ›</td><td>GPR, FPU λ“± μμ‹­ κ° λ μ§€μ¤ν„° I/O</td><td>μ§μ ‘μ  μ‹κ°„ λΉ„μ© (~1ΞΌs)</td></tr>
                    <tr><td>TLB ν”λ¬μ‹ (TLB Flush)</td><td>ν”„λ΅μ„Έμ¤ μ „ν™ μ‹ TLB λ¬΄ν¨ν™”</td><td>μ΄ν›„ λ©”λ¨λ¦¬ μ ‘κ·Ό μ§€μ—° (μμ‹­ ΞΌs λ„μ )</td></tr>
                    <tr><td>μΊμ‹ μ¤μ—Ό (Cache Pollution)</td><td>L1/L2 μΊμ‹μ μ ν¨ λ°μ΄ν„°κ°€ μƒ ν”„λ΅μ„Έμ¤ λ°μ΄ν„°λ΅ λ€μ²΄</td><td>Cold Startλ΅ μΈν• μΊμ‹ λ―Έμ¤ μ¦κ°€</td></tr>
                    <tr><td>νμ΄ν”„λΌμΈ ν”λ¬μ‹</td><td>CPU νμ΄ν”„λΌμΈμ μ§„ν–‰ μ¤‘μΈ λ…λ Ήμ–΄ νκΈ°</td><td>νμ΄ν”„λΌμΈ μ¬μ¶©μ „ λΉ„μ©</td></tr>
                </tbody>
            </table>

            <h3>μ 5μ¥ μ„±λ¥ λ¶„μ„ λ° μµμ ν™”</h3>
            <h4>5.1 μΈν„°λ½νΈ μ§€μ—° μ‹κ°„ (Interrupt Latency)</h4>
            <p>μΈν„°λ½νΈ μ§€μ—° μ‹κ°„μ€ μΈν„°λ½νΈ λ°μƒλ¶€ν„° ISR μ²« λ²μ§Έ λ…λ Ήμ–΄ μ‹¤ν–‰κΉμ§€μ μ‹κ°„μ΄λ‹¤. μ‹¤μ‹κ°„ μ΄μμ²΄μ (RTOS)μ—μ„λ” μ΄ μ§€μ—° μ‹κ°„μ λ³΄μ¥μ΄ ν•µμ‹¬ μ”κµ¬μ‚¬ν•­μ΄λ‹¤.</p>
            <table>
                <thead><tr><th>κµ¬κ°„</th><th>μ†μ” μ‹κ°„ (μΌλ°μ )</th><th>κ²°μ • μ”μΈ</th></tr></thead>
                <tbody>
                    <tr><td>μΈν„°λ½νΈ μΈμ‹</td><td>μ ns ~ μμ‹­ ns</td><td>PIC/APIC μ²λ¦¬ μ†λ„</td></tr>
                    <tr><td>λ…λ Ήμ–΄ μ™„λ£ λ€κΈ°</td><td>0 ~ μλ°± ns</td><td>ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄ λ³µμ΅λ„</td></tr>
                    <tr><td>PSW/PC μλ™ μ €μ¥</td><td>μμ‹­ ns</td><td>μ¤νƒ λ©”λ¨λ¦¬ μ ‘κ·Ό μ†λ„</td></tr>
                    <tr><td>ISR μ§„μ…</td><td>μμ‹­ ~ μλ°± ns</td><td>IDT μ°Έμ΅°, λ¶„κΈ° μμΈ΅</td></tr>
                    <tr><td><strong>μ „μ²΄ μ§€μ—°</strong></td><td><strong>0.5 ~ 10 ΞΌs</strong></td><td>μ‹μ¤ν…μ— λ”°λΌ μ°¨μ΄</td></tr>
                </tbody>
            </table>
            <p><strong>RTOS vs λ²”μ© OS λΉ„κµ</strong>: Linuxμ μΈν„°λ½νΈ μ§€μ—°μ€ μμ‹­ ΞΌs μμ¤€μ΄λ‚, VxWorks κ°™μ€ RTOSλ” μ ΞΌs μ΄λ‚΄λ¥Ό λ³΄μ¥ν•λ‹¤. PREEMPT_RT ν¨μΉλ¥Ό μ μ©ν• Linuxλ” 50ΞΌs μ΄λ‚΄μ μµμ•… μ§€μ—° μ‹κ°„(Worst-case Latency)μ„ λ‹¬μ„±ν•  μ μλ‹¤.</p>

            <h4>5.2 μµμ ν™” κΈ°λ²•</h4>
            <table>
                <thead><tr><th>μµμ ν™” κΈ°λ²•</th><th>μ›λ¦¬</th><th>ν¨κ³Ό</th></tr></thead>
                <tbody>
                    <tr><td>Top Half / Bottom Half λ¶„λ¦¬</td><td>ISRμ„ κΈ΄κΈ‰ μ²λ¦¬(Top Half)μ™€ μ§€μ—° μ²λ¦¬(Bottom Half)λ΅ λ¶„λ¦¬</td><td>μΈν„°λ½νΈ λΉ„ν™μ„±ν™” μ‹κ°„ μµμ†ν™”</td></tr>
                    <tr><td>Threaded Interrupt</td><td>ISRμ„ μ»¤λ„ μ¤λ λ“λ΅ μ‹¤ν–‰</td><td>μ„ μ  κ°€λ¥, μ°μ„ μμ„ μ μ–΄ κ°€λ¥</td></tr>
                    <tr><td>Interrupt Coalescing</td><td>λ‹¤μμ μΈν„°λ½νΈλ¥Ό λ¬¶μ–΄μ„ ν• λ²μ— μ²λ¦¬</td><td>μΈν„°λ½νΈ λΉλ„ κ°μ† (NICμ—μ„ μ£Όλ΅ μ‚¬μ©)</td></tr>
                    <tr><td>NAPI (Linux)</td><td>μΈν„°λ½νΈ + ν΄λ§ νΌν•© λ°©μ‹</td><td>κ³ λ¶€ν• μ‹ μΈν„°λ½νΈ μ¤ν†° λ°©μ§€</td></tr>
                </tbody>
            </table>

            <h3>μ 6μ¥ μ—°κ΄€ μ΄λ΅  μ—°κ²°</h3>
            <h4>6.1 DMA(Direct Memory Access)μ™€μ κ΄€κ³„</h4>
            <p>DMA μ»¨νΈλ΅¤λ¬λ” CPU κ°μ… μ—†μ΄ I/O μ¥μΉμ™€ λ©”λ¨λ¦¬ κ°„ λ°μ΄ν„°λ¥Ό μ§μ ‘ μ „μ†΅ν•λ‹¤. μ „μ†΅ μ™„λ£ μ‹ DMA μ»¨νΈλ΅¤λ¬κ°€ CPUμ— μΈν„°λ½νΈλ¥Ό λ°μƒμ‹μΌ μ™„λ£λ¥Ό μ•λ¦°λ‹¤. λ”°λΌμ„ DMAλ” μΈν„°λ½νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦μ„ μ „μ λ΅ λ™μ‘ν•λ©°, λ‘ κ°λ…μ€ μƒνΈ λ³΄μ™„μ μ΄λ‹¤.</p>
            <h4>6.2 μ‹μ¤ν… μ½(System Call)κ³Όμ κ΄€κ³„</h4>
            <p>μ‹μ¤ν… μ½μ€ μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ μ»¤λ„ μ„λΉ„μ¤λ¥Ό μ”μ²­ν•λ” λ©”μ»¤λ‹μ¦μΌλ΅, <strong>μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ(Trap)</strong>λ¥Ό ν†µν•΄ κµ¬ν„λλ‹¤. Linuxμ—μ„ INT 0x80 λλ” SYSCALL λ…λ Ήμ–΄κ°€ νΈλ©μ„ λ°μƒμ‹ν‚¤λ©΄, μΈν„°λ½νΈμ™€ λ™μΌν• λ©”μ»¤λ‹μ¦μΌλ΅ λ¨λ“ μ „ν™, μ»¨ν…μ¤νΈ μ €μ¥, μ»¤λ„ μ½”λ“ μ‹¤ν–‰μ΄ μν–‰λλ‹¤.</p>
            <h4>6.3 ν”„λ΅μ„Έμ¤ μƒνƒ μ „μ΄λ„μ™€μ κ΄€κ³„</h4>
            <p>μΈν„°λ½νΈλ” ν”„λ΅μ„Έμ¤ μƒνƒ μ „μ΄μ μ£Όμ” νΈλ¦¬κ±°μ΄λ‹¤. νƒ€μ΄λ¨Έ μΈν„°λ½νΈλ” Running β†’ Ready μ „μ΄λ¥Ό μ λ°ν•κ³ (μ„ μ ), I/O μ™„λ£ μΈν„°λ½νΈλ” Blocked β†’ Ready μ „μ΄λ¥Ό μ λ°ν•λ‹¤. λ”°λΌμ„ μΈν„°λ½νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦μ€ ν”„λ΅μ„Έμ¤ μ¤μΌ€μ¤„λ§μ λ¬Όλ¦¬μ  κΈ°λ°μ΄λ‹¤.</p>

            <h3>μ 7μ¥ μ‹ν— μ¶μ  κ΄€μ </h3>
            <p><strong>κΈ°μ¶ μ—°κ³„ ν¬μΈνΈ</strong>: μΈν„°λ½νΈ μ²λ¦¬μ™€ PCBλ” 1κµμ‹ λ‹¨λ… μ¶μ λ” λ¬Όλ΅ , λ¬Έλ§¥ κµν™, ν”„λ΅μ„Έμ¤ μ¤μΌ€μ¤„λ§, I/O κ΄€λ¦¬ λ“±κ³Ό κ²°ν•©ν•μ—¬ 2κµμ‹μ—μ„λ„ μ¶μ λλ‹¤.</p>
            <p><strong>μ°¨λ³„ν™” μ „λµ</strong>: β‘  ν•λ“μ›¨μ–΄ μλ™ μ €μ¥(PSW, PC)κ³Ό μ†ν”„νΈμ›¨μ–΄ μ €μ¥(GPR β†’ PCB)μ κµ¬λ¶„μ„ λ…ν™•ν ν•κ³ , β‘΅ λ¬Έλ§¥ κµν™ λΉ„μ©μ κµ¬μ²΄μ  μ”μ†(TLB ν”λ¬μ‹, μΊμ‹ μ¤μ—Ό)λ¥Ό μ„μ ν•λ©°, β‘Ά Top Half/Bottom Half λ¶„λ¦¬ κ°™μ€ μµμ ν™” κΈ°λ²•κΉμ§€ μ–ΈκΈ‰ν•λ©΄ ν•©κ²©κ¶μ„ λ„λ” λ‹µμ•μ΄ λλ‹¤.</p>
            <p><strong>λ¶„λ‰ λΉ„μ¤‘ κ°€μ΄λ“ (1κµμ‹ λ‹µμ• κΈ°μ¤€)</strong>: μ„λ΅  15% / λ³Έλ΅  75% / κ²°λ΅  10%</p>

        </div>
    </div>

    <!-- ===== νƒ­6: κ°•μ μ¤ν¬λ¦½νΈ (λ©ν†  μ „μ©) ===== -->
    <div id="script" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in textbook-content">
            <div class="bg-amber-50 border border-amber-300 rounded-xl p-4 mb-6">
                <div class="flex items-center gap-2 mb-2">
                    <span class="bg-amber-200 text-amber-800 text-xs font-bold px-2 py-1 rounded-full">&#x1f512; λ©ν†  μ „μ©</span>
                    <span class="text-sm font-bold text-amber-700">κ°•μ μ¤ν¬λ¦½νΈ</span>
                </div>
                <p class="text-xs text-amber-600">μ΄ νƒ­μ€ URLμ— <code class="bg-amber-100 px-1 rounded">?mentor=true</code> νλΌλ―Έν„°κ°€ μμ„ λ•λ§ ν‘μ‹λ©λ‹λ‹¤.</p>
            </div>
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6" style="border:none;padding:0;">&#x1f3ac; λ©ν†  μ΄ν‰ μμƒ μ¤ν¬λ¦½νΈ (μ•½ 20λ¶„)</h2>

            <h4>&#x1f3ac; [λ„μ…λ¶€ β€” μ•½ 3λ¶„]</h4>
            <p>μ•λ…•ν•μ„Έμ”, μ—¬λ¬λ¶„. μ¤λ λ‹¤λ£° ν† ν”½μ€ "μΈν„°λ½νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦κ³Ό PCB"μ…λ‹λ‹¤.</p>
            <p>μ΄ ν† ν”½, μΆ€ μ–΄λ µκ² λκ»΄μ§€μ‹μ£ ? CPU λ‚΄λ¶€ λ™μ‘μ΄λ‹κΉ. κ·Όλ° μ‚¬μ‹¤ μ΄ ν† ν”½μ€ μ΄μμ²΄μ λ¥Ό μ΄ν•΄ν•λ” μ—΄μ‡  κ°™μ€ κ±°μμ”. μΈν„°λ½νΈκ°€ μ—†μΌλ©΄ λ©€ν‹°νƒμ¤ν‚Ήμ΄ μ• λΌμ”. μ°λ¦¬κ°€ μ»΄ν“¨ν„° μ“Έ λ• μ—¬λ¬ ν”„λ΅κ·Έλ¨μ„ λ™μ‹μ— λλ¦¬μ–μ•„μ”? κ·Έκ² λ‹¤ μΈν„°λ½νΈ λ•λ¶„μ΄μ—μ”. νƒ€μ΄λ¨Έ μΈν„°λ½νΈκ°€ μ£ΌκΈ°μ μΌλ΅ CPUλ¥Ό λΉΌμ•—μ•„μ„ λ‹¤λ¥Έ ν”„λ΅μ„Έμ¤μ— λ„κ²¨μ£Όλ” κ±°κ±°λ“ μ”.</p>
            <p>μ¶μ μλ„λ¥Ό λ³΄λ©΄ "λ¬Έλ§¥ κµν™ κ³Όμ •μ—μ„μ λ§μ΄ν¬λ΅μ μΈ λ μ§€μ¤ν„° λ°±μ—… κ³Όμ •μ„ μ„μ ν•  μ μλ”μ§€"λ¥Ό λ¬»κ³  μμ–΄μ”. λ‹¨μν "μΈν„°λ½νΈκ°€ λ°μƒν•λ©΄ ISRμ„ μ‹¤ν–‰ν•λ‹¤" μμ¤€μ΄ μ•„λ‹λΌ, CPU λ‚΄λ¶€μ—μ„ μ–΄λ–¤ λ μ§€μ¤ν„°κ°€ μ–΄λ–¤ μμ„λ΅ μ €μ¥λλ”μ§€κΉμ§€ μ•μ•„μ•Ό ν•λ‹¤λ” κ±°μμ”. μ΄κ² μΆ€ λ””ν…μΌν• λ¶€λ¶„μ΄κΈ΄ ν•λ°, μ¤λ ν™•μ‹¤ν μ •λ¦¬ν•΄λ“λ¦΄κ²μ”.</p>

            <h4>&#x1f3ac; [ν•µμ‹¬ μ„¤λ… β€” μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ • (μ•½ 7λ¶„)]</h4>
            <p><strong>μΈν„°λ½νΈκ°€ μ™ ν•„μ”ν•κ°€</strong></p>
            <p>μ, λ¨Όμ € μΈν„°λ½νΈκ°€ μ™ ν•„μ”ν•μ§€λ¶€ν„° λ΄…μ‹λ‹¤. μΈν„°λ½νΈκ°€ μ—†μΌλ©΄ CPUκ°€ I/O μ¥μΉμ— "λλ‚¬μ–΄? λλ‚¬μ–΄? λλ‚¬μ–΄?" μ΄λ ‡κ² κ³„μ† λ¬Όμ–΄λ΄μ•Ό ν•΄μ”. μ΄κ±Έ ν΄λ§μ΄λΌκ³  ν•λ”λ°μ”, CPUκ°€ λ€κΈ°ν•λ©΄μ„ μ•„λ¬΄ μΌλ„ λ» ν•κ±°λ“ μ”. Intel λ²¤μΉλ§ν¬μ— λ”°λ¥΄λ©΄ CPU μ‹κ°„μ μµλ€ 90%λ¥Ό μ΄λ° λ€κΈ°μ— μ“Έ μ μμ–΄μ”. λ§λ„ μ• λλ” λ‚­λΉ„μ–μ•„μ”?</p>
            <p>μΈν„°λ½νΈ λ°©μ‹μ€ μ΄κ±Έ λ’¤μ§‘μ–΄μ”. I/O μ¥μΉκ°€ μΌ λλ‚λ©΄ "λ‚ λλ‚¬μ–΄!"λΌκ³  CPUν•ν… μ‹ νΈλ¥Ό λ³΄λ‚΄λ” κ±°μμ”. CPUλ” κ·Έλ•κΉμ§€ λ‹¤λ¥Έ μΌμ„ ν•λ‹¤κ°€, μ‹ νΈκ°€ μ¤λ©΄ κ·Έλ• μ²λ¦¬ν•λ©΄ λ©λ‹λ‹¤. μ΄λ¬λ©΄ CPU λ€κΈ° μ‹κ°„μ΄ 2~5%λ΅ μ¤„μ–΄μ”. μ—„μ²­λ‚ μ°¨μ΄μ£ .</p>

            <p><strong>8λ‹¨κ³„ μ²λ¦¬ κ³Όμ • β€” μμ„λ€λ΅ λ”°λΌκ°€ λ΄…μ‹λ‹¤</strong></p>
            <p>μ, μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ •μ„ 8λ‹¨κ³„λ΅ μΌκ°μ„ μμ„λ€λ΅ λ”°λΌκ°€ λ΄…μ‹λ‹¤. μ΄κ±Έ <span class="highlight">"λ°μ™„μΈμ €μ „μ»¨μ‹¤λ³µ"</span>μΌλ΅ μ™Έμ°μ„Έμ”.</p>
            <p>1λ‹¨κ³„, <strong>λ°</strong>μƒ. ν•λ“μ›¨μ–΄ μ¥μΉκ°€ IRQ λΌμΈμ— μ „κΈ° μ‹ νΈλ¥Ό λ³΄λ‚΄μ”. ν‚¤λ³΄λ“λ¥Ό λ„λ¥΄λ©΄ ν‚¤λ³΄λ“ μ»¨νΈλ΅¤λ¬κ°€ IRQ1μ— μ‹ νΈλ¥Ό λ³΄λ‚΄λ” μ‹μ΄μ£ . PICκ°€ μ΄ μ‹ νΈλ¥Ό λ°›μ•„μ„ μ°μ„ μμ„λ¥Ό νλ‹¨ν•κ³  CPUμ— μ „λ‹¬ν•΄μ”.</p>
            <p>2λ‹¨κ³„, <strong>μ™„</strong>λ£ λ€κΈ°. CPUλ” ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄λ¥Ό λκΉμ§€ λ§λ¬΄λ¦¬ν•΄μ”. λ…λ Ήμ–΄ ν•λ‚λ¥Ό λ°μ―¤ μ‹¤ν–‰ν•λ‹¤κ°€ κ·Έλƒ¥ μ¤‘λ‹¨ν•  μλ” μ—†κ±°λ“ μ”. μ›μμ„±μ΄ λ³΄μ¥λμ–΄μ•Ό ν•λ‹κΉμ”.</p>
            <p>3λ‹¨κ³„, <strong>μΈ</strong>μ‹. CPUκ°€ PSWμ μΈν„°λ½νΈ ν”λκ·Έ(IF)λ¥Ό ν™•μΈν•΄μ”. IF=1μ΄λ©΄ "μΆ‹μ•„, μΈν„°λ½νΈ λ°›κ² μ–΄" ν•κ³  PICν•ν… INTA μ‹ νΈλ¥Ό λ³΄λ‚΄μ”. PICκ°€ λ²΅ν„° λ²νΈλ¥Ό μ•λ ¤μ£Όμ£ .</p>
            <p>4λ‹¨κ³„, μ—¬κΈ°κ°€ ν•µμ‹¬μ΄μ—μ”. <strong>μ €</strong>μ¥. CPUκ°€ ν•λ“μ›¨μ–΄μ μΌλ΅, μλ™μΌλ΅, PSWμ™€ PCλ¥Ό μ»¤λ„ μ¤νƒμ— pushν•΄μ”. μ†ν”„νΈμ›¨μ–΄κ°€ κ°μ…ν•λ” κ² μ•„λ‹λΌ CPU λ§μ΄ν¬λ΅μ½”λ“κ°€ ν•λ” κ±°μμ”. μ΄κ² μ™ μ¤‘μ”ν•λƒλ©΄, μ΄ λ‘ κ°’μ΄ μ• μ €μ¥λλ©΄ μ›λ μ‹¤ν–‰ν•λ ν”„λ΅κ·Έλ¨μΌλ΅ λμ•„κ° μ μ—†κ±°λ“ μ”.</p>
            <p>5λ‹¨κ³„, <strong>μ „</strong>ν™. μ‚¬μ©μ λ¨λ“μ—μ„ μ»¤λ„ λ¨λ“λ΅ μ „ν™λκ³ , IFλ¥Ό 0μΌλ΅ λ§λ“¤μ–΄μ„ μ¶”κ°€ μΈν„°λ½νΈλ¥Ό μΌμ‹μ μΌλ΅ μ°¨λ‹¨ν•΄μ”. κ·Έλ¦¬κ³  IDTμ—μ„ ISR μ£Όμ†λ¥Ό μ½μ–΄μ„ PCμ— λ„£μ–΄μ”.</p>
            <p>6λ‹¨κ³„, <strong>μ»¨</strong>ν…μ¤νΈ μ €μ¥. μ—¬κΈ°μ„λ¶€ν„°λ” μ†ν”„νΈμ›¨μ–΄, μ¦‰ OS μ»¤λ„μ΄ ν•λ” μΌμ΄μ—μ”. λ²”μ© λ μ§€μ¤ν„°, μ¤νƒ ν¬μΈν„°, λ¶€λ™μ†μμ  λ μ§€μ¤ν„° κ°™μ€ λ‚λ¨Έμ§€ CPU μƒνƒλ¥Ό PCBμ— μ €μ¥ν•΄μ”. λ‹µμ•μ—μ„ κΌ­ κ°•μ΅°ν•΄μ•Ό ν•  κ², <strong>4λ‹¨κ³„λ” ν•λ“μ›¨μ–΄κ°€, 6λ‹¨κ³„λ” μ†ν”„νΈμ›¨μ–΄κ°€</strong> ν•λ‹¤λ” κ±°μμ”. μ΄ κµ¬λ¶„μ„ λ…ν™•ν•κ² μ“°λ©΄ μ±„μ κ΄€ λμ— ν™• λ“¤μ–΄μµλ‹λ‹¤.</p>
            <p>7λ‹¨κ³„, ISR <strong>μ‹¤</strong>ν–‰. μ‹¤μ  μΈν„°λ½νΈ μ›μΈμ„ μ²λ¦¬ν•λ” κ±°μ£ . λ””μ¤ν¬ I/O μ™„λ£λ©΄ λ°μ΄ν„° μ „μ†΅ ν™•μΈ, νƒ€μ΄λ¨Έ λ§λ£λ©΄ μ¤μΌ€μ¤„λ¬ νΈμ¶.</p>
            <p>8λ‹¨κ³„, <strong>λ³µ</strong>μ›. μ¤μΌ€μ¤„λ¬κ°€ λ‹¤μ ν”„λ΅μ„Έμ¤λ¥Ό μ •ν•κ³ , κ·Έ ν”„λ΅μ„Έμ¤μ PCBμ—μ„ λ μ§€μ¤ν„° κ°’μ„ CPUμ— λ³µμ›ν•΄μ”. IRET λ…λ Ήμ–΄λ΅ PSW, PCλ¥Ό λ³µμ›ν•λ©΄ λ. ν•΄λ‹Ή ν”„λ΅μ„Έμ¤κ°€ λ§μΉ μ¤‘λ‹¨λ μ μ΄ μ—†λ” κ²ƒμ²λΌ μ‹¤ν–‰μ„ μ¬κ°ν•λ” κ±°μμ”.</p>

            <h4>&#x1f3ac; [ν•µμ‹¬ μ„¤λ… β€” PCBμ™€ λ¬Έλ§¥ κµν™ (μ•½ 7λ¶„)]</h4>
            <p><strong>PCBκ°€ λ­”κ°€</strong></p>
            <p>μ, μ΄μ  PCB μ΄μ•ΌκΈ°λ¥Ό ν•©μ‹λ‹¤. PCBλ” Process Control Block, ν”„λ΅μ„Έμ¤ μ μ–΄ λΈ”λ΅μ΄μ—μ”.</p>
            <p>μ‰½κ² λΉ„μ ν•λ©΄ ν”„λ΅μ„Έμ¤μ "μ΄λ ¥μ„"λΌκ³  μƒκ°ν•μ‹λ©΄ λΌμ”. μ΄ ν”„λ΅μ„Έμ¤κ°€ λ„κµ°μ§€(PID), λ¶€λ¨κ°€ λ„κµ°μ§€(PPID), μ§€κΈ λ­ ν•κ³  μμ—λ”μ§€(PC, λ μ§€μ¤ν„° κ°’λ“¤), ν„μ¬ μƒνƒκ°€ λ­”μ§€(Running/Ready/Blocked), λ©”λ¨λ¦¬λ” μ–΄λ””λ¥Ό μ“°κ³  μλ”μ§€, νμΌμ€ λ­ μ—΄μ–΄λ†¨λ”μ§€. μ΄ λ¨λ“  μ •λ³΄κ°€ PCBμ— λ‹¤ λ“¤μ–΄μμ–΄μ”. ν”„λ΅μ„Έμ¤κ°€ μƒμ„±λλ©΄ PCBκ°€ λ§λ“¤μ–΄μ§€κ³ , ν”„λ΅μ„Έμ¤κ°€ λλ‚λ©΄ PCBλ„ ν•΄μ λ©λ‹λ‹¤.</p>
            <p>PCBκ°€ μ™ μ¤‘μ”ν•λƒλ©΄, μ΄κ² μ—†μΌλ©΄ λ¬Έλ§¥ κµν™μ΄ μ• λΌμ”. λ¬Έλ§¥ κµν™μ΄ μ• λλ©΄ λ©€ν‹°νƒμ¤ν‚Ήμ΄ μ• λκ³ , λ©€ν‹°νƒμ¤ν‚Ήμ΄ μ• λλ©΄ ν„λ€ μ΄μμ²΄μ κ°€ μ΅΄μ¬ν•  μ μ—†μ–΄μ”. κ·Έλ§νΌ ν•µμ‹¬μ μΈ μλ£κµ¬μ΅°λΌλ” κ±°μ£ .</p>
            <p>λ‹µμ•μ— PCB ν•„λ“λ¥Ό μ“Έ λ•λ” λ°λ“μ‹ ν‘λ΅ μ •λ¦¬ν•μ„Έμ”. ν¬κ² λ‹¤μ„― κ·Έλ£ΉμΌλ΅ λ‚λ„λ©΄ λΌμ”. <span class="highlight">"μ‹λ μƒλ©”μ¤"</span>λ΅ μ™Έμ°μ„Έμ”. μ‹λ³„μ •λ³΄(PID, PPID), λ μ§€μ¤ν„°(PC, SP, PSW, GPR), μƒνƒ(State, Priority), λ©”λ¨λ¦¬(νμ΄μ§€ ν…μ΄λΈ” ν¬μΈν„°), μ¤μΌ€μ¤„λ§(CPU μ‚¬μ©μ‹κ°„, λ€κΈ°μ‹κ°„). μ΄ λ‹¤μ„― κ·Έλ£Ήμ„ ν–‰μΌλ΅ λ†“κ³  κ°κ°μ κµ¬μ²΄μ  ν•„λ“λ¥Ό μ μ–΄μ£Όλ©΄ κΉ”λ”ν• ν‘κ°€ λ©λ‹λ‹¤.</p>
            <p>μ—¬κΈ°μ„ μ£Όμν•  μ μ΄ μμ–΄μ”. λ§μ΄λ“¤ PCB ν•„λ“ μ¤‘μ—μ„ λ μ§€μ¤ν„° λ¶€λ¶„λ§ κ°•μ΅°ν•λ”λ°, μ‚¬μ‹¤ λ©”λ¨λ¦¬ κ΄€λ¦¬ ν•„λ“λ„ μ¤‘μ”ν•΄μ”. νΉν "νμ΄μ§€ ν…μ΄λΈ” ν¬μΈν„°"κ°€ μμ–μ•„μ”? x86μ—μ„λ” CR3 λ μ§€μ¤ν„°κ°€ μ΄ μ—­ν• μ„ ν•λ”λ°, λ¬Έλ§¥ κµν™ μ‹ CR3λ¥Ό λ°”κΎΈλ©΄ κ°€μƒ λ©”λ¨λ¦¬ κ³µκ°„ μ „μ²΄κ°€ λ°”λ€λ” κ±°μμ”. μ΄κ² TLB ν”λ¬μ‹λ¥Ό μ λ°ν•λ” μ›μΈμ΄κΈ°λ„ ν•κ³ μ”. μ΄ μ—°κ²° κ΄€κ³„λ¥Ό μ΄ν•΄ν•λ©΄ λ¬Έλ§¥ κµν™μ λΉ„μ© κµ¬μ΅°κ°€ ν™• μ΄ν•΄λ©λ‹λ‹¤.</p>

            <p><strong>λ¬Έλ§¥ κµν™μ λΉ„μ©</strong></p>
            <p>λ¬Έλ§¥ κµν™ μ΄μ•ΌκΈ°λ¥Ό μΆ€ λ” ν•΄λ³Όκ²μ”. λ¬Έλ§¥ κµν™μ€ μμν• μ¤λ²„ν—¤λ“μμ”. λ¬Έλ§¥ κµν™ν•λ” λ™μ•μ—λ” μ μ©ν• μΌμ„ μ•„λ¬΄κ²ƒλ„ λ» ν•κ±°λ“ μ”. λ³΄ν†µ 1~10λ§μ΄ν¬λ΅μ΄ κ±Έλ¦°λ‹¤κ³  ν•λ”λ°, μ§„μ§ λΉ„μ©μ€ κ·Έκ² μ•„λ‹μ—μ”.</p>
            <p>μ§„μ§ λΉ„μ©μ€ λ­λƒλ©΄, TLB ν”λ¬μ‹μ™€ μΊμ‹ μ¤μ—Όμ΄μ—μ”. ν”„λ΅μ„Έμ¤κ°€ λ°”λ€λ©΄ TLB(Translation Lookaside Buffer)λ¥Ό λ¬΄ν¨ν™”ν•΄μ•Ό ν•μ–μ•„μ”? κ°€μƒ λ©”λ¨λ¦¬ λ§¤ν•‘μ΄ λ‹¤λ¥΄λ‹κΉμ”. κ·Έλ¬λ©΄ μƒ ν”„λ΅μ„Έμ¤κ°€ μ‹μ‘ν•  λ• TLB λ―Έμ¤κ°€ μ”λ© λ‚μ”. μΊμ‹λ„ λ§μ°¬κ°€μ§€μμ”. L1, L2 μΊμ‹μ— μ΄μ „ ν”„λ΅μ„Έμ¤ λ°μ΄ν„°κ°€ κ°€λ“ μ°¨ μλ”λ°, μƒ ν”„λ΅μ„Έμ¤λ” κ·Έ λ°μ΄ν„°κ°€ μ†μ©μ—†μ–μ•„μ”? κ²°κµ­ μΊμ‹ λ―Έμ¤κ°€ μ—°μ‡„μ μΌλ΅ λ°μƒν•λ” κ±°μ£ . μ΄κ±Έ μΊμ‹ μ›λ°μ—…, λλ” μ½λ“ μ¤νƒ€νΈλΌκ³  ν•΄μ”.</p>
            <p>μ΄ λ¶€λ¶„μ„ λ‹µμ•μ— μ“°λ©΄ ν™•μ‹¤ν μ°¨λ³„ν™”κ°€ λ©λ‹λ‹¤. λ€λ¶€λ¶„μ μν—μƒμ΄ "λ¬Έλ§¥ κµν™μ€ λ μ§€μ¤ν„° μ €μ¥/λ³µμ›μ΄λ‹¤" μ •λ„λ§ μ“°κ±°λ“ μ”. TLB ν”λ¬μ‹, μΊμ‹ μ¤μ—Ό, νμ΄ν”„λΌμΈ ν”λ¬μ‹κΉμ§€ μ“°λ©΄ κΉμ΄κ°€ λ‹¬λΌμ Έμ”.</p>
            <p>κ·Έλ¬λ©΄ μ΄ λΉ„μ©μ„ μ¤„μ΄λ ¤λ©΄ μ–΄λ–»κ² ν•΄μ•Ό ν• κΉμ”? ν„λ€ OSμ—μ„λ” λ‡ κ°€μ§€ μµμ ν™”λ¥Ό μ¨μ”. μ²«μ§Έ, Top Halfμ™€ Bottom Half λ¶„λ¦¬μμ”. μΈν„°λ½νΈ μ²λ¦¬ λ£¨ν‹΄μ„ λ‘ λ¶€λ¶„μΌλ΅ λ‚λ„λ” κ±°μμ”. Top Halfλ” μ •λ§ κΈ‰ν• κ²ƒλ§ λΉ¨λ¦¬ μ²λ¦¬ν•κ³ , λ‚λ¨Έμ§€λ” Bottom Halfλ΅ λ―Έλ£¨λ” κ±°μ£ . Linuxμ—μ„ softirq, tasklet, workqueueκ°€ μ΄ Bottom Half λ©”μ»¤λ‹μ¦μ΄μ—μ”. μ΄λ ‡κ² ν•λ©΄ μΈν„°λ½νΈκ°€ λΉ„ν™μ„±ν™”λμ–΄ μλ” μ‹κ°„μ„ μµμ†ν™”ν•  μ μμ–΄μ”.</p>
            <p>λ‘μ§Έ, Interrupt Coalescingμ΄λΌλ” κΈ°λ²•μ΄ μμ–΄μ”. λ„¤νΈμ›ν¬ μΉ΄λ“μ—μ„ ν¨ν‚·μ΄ μ¬ λ•λ§λ‹¤ μΈν„°λ½νΈλ¥Ό κ±Έλ©΄, μ΄λ‹Ή μλ§ λ²μ μΈν„°λ½νΈκ°€ λ°μƒν•μ–μ•„μ”? μ΄κ±Έ λ¨μ•„μ„ ν• λ²μ— μ²λ¦¬ν•λ” κ±°μμ”. μΈν„°λ½νΈ λΉλ„λ¥Ό νκΈ°μ μΌλ΅ μ¤„μΌ μ μμ£ . μ΄λ° μµμ ν™” κΈ°λ²•μ„ λ‹µμ• κ²°λ΅ λ¶€μ— ν• μ¤„μ΄λΌλ„ μ“°λ©΄ μ‹¤λ¬΄μ  κ΄€μ μ΄ μΈμ •λ©λ‹λ‹¤.</p>

            <h4>&#x1f3ac; [λ‹µμ• μ‘μ„± ν β€” μ•½ 2λ¶„]</h4>
            <p><strong>μ‹¤μ „μ—μ„ μ΄λ ‡κ² μ“°μ„Έμ”</strong></p>
            <p>μ„λ΅ μ—μ„λ” μΈν„°λ½νΈ μ •μλ¥Ό μ“°κ³ , ν΄λ§κ³Ό μΈν„°λ½νΈ λ°©μ‹μ„ κ°„λµν λΉ„κµν•μ„Έμ”. "CPU μμ› ν™μ©μ ν¨μ¨μ„±μ„ μ„ν•΄ μΈν„°λ½νΈ λ°©μ‹μ΄ μ‚¬μ©λλ‹¤" μ •λ„λ΅ μ—°κ²°ν•λ©΄ λ©λ‹λ‹¤.</p>
            <p>λ³Έλ΅ μ—μ„λ” νλ¦„λ„λ¥Ό λ°λ“μ‹ κ·Έλ¦¬μ„Έμ”. 8λ‹¨κ³„λ¥Ό μμ§μΌλ΅ λ‚μ—΄ν•κ³ , ν•λ“μ›¨μ–΄ μν–‰ λ‹¨κ³„μ™€ μ†ν”„νΈμ›¨μ–΄ μν–‰ λ‹¨κ³„λ¥Ό μ μ„ μΌλ΅ κµ¬λ¶„ν•΄μ£Όμ„Έμ”. κ·Έ λ‹¤μμ— PCB ν•„λ“λ¥Ό ν‘λ΅ μ •λ¦¬ν•κ³ , λ¬Έλ§¥ κµν™ κ³Όμ •μ„ Pβ‚β†’Pβ‚‚ μ „ν™ λ‹¤μ΄μ–΄κ·Έλ¨μΌλ΅ λ³΄μ—¬μ£Όλ©΄ μ™„λ²½ν•©λ‹λ‹¤.</p>
            <p>κ²°λ΅ μ—μ„λ” DMAμ™€ μ‹μ¤ν… μ½κ³Όμ κ΄€κ³„λ¥Ό κ°„λµν μ–ΈκΈ‰ν•κ³ , Top Half/Bottom Half λ¶„λ¦¬ κ°™μ€ μµμ ν™” κΈ°λ²•μ„ ν• μ¤„μ΄λΌλ„ μ“°λ©΄ μ‹μμ„±μ΄ ν™•λ³΄λ©λ‹λ‹¤.</p>

            <h4>&#x1f3ac; [λ§λ¬΄λ¦¬ β€” μ•½ 2λ¶„]</h4>
            <p>μ, μ¤λ λ‚΄μ© μ •λ¦¬ν•©λ‹λ‹¤.</p>
            <p>μ•”κΈ° ν¬μΈνΈ λ‹¤μ‹ ν•λ² κ°κ²μ”. μΈν„°λ½νΈ μ²λ¦¬ 8λ‹¨κ³„λ” <span class="highlight">"λ°μ™„μΈμ €μ „μ»¨μ‹¤λ³µ"</span>. λ°μƒ, μ™„λ£λ€κΈ°, μΈμ‹, μ €μ¥, μ „ν™, μ»¨ν…μ¤νΈ, ISRμ‹¤ν–‰, λ³µμ›. PCB ν•µμ‹¬ ν•„λ“ κ·Έλ£Ήμ€ <span class="highlight">"μ‹λ μƒλ©”μ¤"</span>. μ‹λ³„, λ μ§€μ¤ν„°, μƒνƒ, λ©”λ¨λ¦¬, μ¤μΌ€μ¤„λ§. λ¬Έλ§¥ κµν™ λΉ„μ© 4μ”μ†λ” <span class="highlight">"λ TLμΊν"</span>. λ μ§€μ¤ν„° μ €μ¥/λ³µμ›, TLB ν”λ¬μ‹, μΊμ‹ μ¤μ—Ό, νμ΄ν”„λΌμΈ ν”λ¬μ‹.</p>
            <p>κ·Έλ¦¬κ³  μ΄ ν† ν”½μ—μ„ κ°€μ¥ μ¤‘μ”ν• ν¬μΈνΈ ν•λ‚λ§ λ” κ°•μ΅°ν• κ²μ”. <strong>PSW/PCλ” ν•λ“μ›¨μ–΄κ°€ μλ™μΌλ΅ μ €μ¥ν•κ³ , GPRμ€ μ†ν”„νΈμ›¨μ–΄(OS μ»¤λ„)κ°€ μ €μ¥ν•λ‹¤.</strong> μ΄ κµ¬λ¶„μ„ λ…ν™•ν•κ² μ“°λ©΄ "CPUμ λ§μ΄ν¬λ΅ μμ¤€ λ™μ‘μ„ μ •ν™•ν μ΄ν•΄ν•κ³  μλ‹¤"λ” μΈμƒμ„ μ¤„ μ μμ–΄μ”. μ΄κ² μ¶μ μλ„κ°€ λ¬»λ” ν•µμ‹¬μ΄κΈ°λ„ ν•κ³ μ”.</p>
            <p>μ΄ ν† ν”½μ€ ν”„λ΅μ„Έμ¤ μ¤μΌ€μ¤„λ§, I/O κ΄€λ¦¬, DMAμ™€ μ§μ ‘ μ—°κ²°λ©λ‹λ‹¤. νΉν μ΄λ² μ£Ό λ¨μκ³ μ‚¬μ— λ‚μ¤λ” μ¤μΌ€μ¤„λ§ λ¬Έμ λ‘ μ—°κ³„κ°€ λΌμ”. νƒ€μ΄λ¨Έ μΈν„°λ½νΈκ°€ μ„ μ  μ¤μΌ€μ¤„λ§μ λ¬Όλ¦¬μ  κΈ°λ°μ΄κ±°λ“ μ”. νƒ€μ΄λ¨Έ μΈν„°λ½νΈ μ—†μ΄λ” RR, MLFQ κ°™μ€ μ„ μ ν• μ•κ³ λ¦¬μ¦μ΄ λ™μ‘ν•  μ μ—†μ–΄μ”. μ΄λ° μ‹μΌλ΅ ν† ν”½ κ°„ μ—°κ²°κ³ λ¦¬λ¥Ό μμ‹ν•λ©΄μ„ κ³µλ¶€ν•μ‹λ©΄ ν›¨μ”¬ ν¨κ³Όμ μ…λ‹λ‹¤.</p>
            <p>μ—¬λ¬λ¶„, μΈν„°λ½νΈκ°€ μ–΄λ ¤μ› λ³΄μ—¬λ„ κ²°κµ­μ€ "μ €μ¥ν•κ³  μ²λ¦¬ν•κ³  λ³µμ›ν•λ‹¤"λ” λ‹¨μν• νλ¦„μ΄μ—μ”. μ΄ λΌλ€λ¥Ό μ΅μ•„λ†“κ³  λ””ν…μΌμ„ μ±„μ›λ‚κ°€λ©΄ λ°λ“μ‹ μ •λ³µν•  μ μμµλ‹λ‹¤.</p>
            <p>λ§μ§€λ§‰μΌλ΅ ν• κ°€μ§€ λ” λ§μ”€λ“λ¦¬λ©΄, μ΄ ν† ν”½μ€ μ‹¤λ¬΄μ—μ„λ„ μ •λ§ μ¤‘μ”ν•΄μ”. μ„λ² λ””λ“ μ‹μ¤ν… κ°λ°μ΄λ‚ OS μ»¤λ„ νλ‹μ—μ„ μΈν„°λ½νΈ μ§€μ—°μ‹κ°„μ„ μ¤„μ΄λ” κ² ν•µμ‹¬ κ³Όμ κ±°λ“ μ”. μµκ·Όμ—λ” RTOS(Real-Time OS)μ—μ„ μΈν„°λ½νΈ μ‘λ‹µ μ‹κ°„μ„ λ§μ΄ν¬λ΅μ΄ λ‹¨μ„λ΅ λ³΄μ¥ν•λ” κ² μμ¨μ£Όν–‰μ΄λ‚ μλ£κΈ°κΈ° κ°™μ€ μ•μ „ ν•„μ μ‹μ¤ν…μ ν•µμ‹¬ μ”κµ¬μ‚¬ν•­μ΄μ—μ”. μ΄λ° ν„λ€μ  λ§¥λ½κΉμ§€ μ•μ•„λ‘μ‹λ©΄ μ‹ν—μ—μ„λ„ μ‹¤λ¬΄μ—μ„λ„ ν° λ„μ›€μ΄ λ  κ²λ‹λ‹¤.</p>
            <p>μ¤λλ„ μκ³  λ§μΌμ…¨κ³ , λ‹¤μ κ°•μμ—μ„ λµ™κ² μµλ‹λ‹¤. κ°μ‚¬ν•©λ‹λ‹¤.</p>
        </div>
    </div>

    <!-- ===== νƒ­7: ν€΄μ¦ & μ•”κΈ° ===== -->
    <div id="quiz" class="hidden">
        <div class="bg-white rounded-xl shadow-sm p-6 sm:p-8 animate-fade-in">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-6">ν€΄μ¦ &amp; μ•”κΈ°</h2>

            <!-- AI μ‹¤μ „ ν€΄μ¦ -->
            <section class="mb-10 border-t-4 border-indigo-600 bg-white rounded-b-xl shadow-sm p-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4">&#x1f3af; AI μ‹¤μ „ ν€΄μ¦</h3>
                <p class="text-sm text-gray-500 mb-4">Gemini APIλ¥Ό ν™μ©ν•μ—¬ λλ¤ ν€΄μ¦λ¥Ό μƒμ„±ν•©λ‹λ‹¤. κ°κ΄€μ‹κ³Ό λ‹¨λ‹µν•μ΄ κµλ€λ΅ μ¶μ λ©λ‹λ‹¤.</p>
                <button onclick="generateQuiz()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-all font-medium text-sm mb-4">&#x1f504; μƒ λ¬Έμ  μƒμ„±</button>

                <!-- ν€΄μ¦ ν”λ μ΄μ¤ν™€λ” -->
                <div id="quiz-placeholder" class="text-center py-8 text-gray-400">
                    <p class="text-4xl mb-2">&#x1f4dd;</p>
                    <p>μ„ λ²„νΌμ„ λλ¬ ν€΄μ¦λ¥Ό μ‹μ‘ν•μ„Έμ”</p>
                </div>
                <!-- ν€΄μ¦ λ΅λ”© -->
                <div id="quiz-loading" class="hidden text-center py-8">
                    <div class="typing-indicator inline-flex items-center gap-1">
                        <span></span><span></span><span></span>
                    </div>
                    <p class="text-gray-400 mt-2 text-sm">λ¬Έμ λ¥Ό μƒμ„±ν•κ³  μμµλ‹λ‹¤...</p>
                </div>
                <!-- ν€΄μ¦ μ»¨ν…μ΄λ„ -->
                <div id="quiz-container" class="hidden"></div>
            </section>

            <!-- μ•”κΈ° λ…ΈνΈ: κµμ¬ μ 2λ¶€ μ „μ²΄ μ¬ν„ -->
            <section class="textbook-content">
                <h3 style="margin-top: 3rem; padding-top: 2rem; border-top: 2px solid #e5e7eb;">μ 2λ¶€ β€” μ•”κΈ° μ”μ•½ μλ£</h3>
                <p class="text-xs text-gray-400 mb-4">μ„μ ν• λ‹µμ•μ§€ μ‘μ„±μ„ μ„ν• ν•µμ‹¬ μ•”κΈ° ν¬μΈνΈ</p>

                <h4>1. ν• μ¤„ μ •μ</h4>
                <table>
                    <thead><tr><th>ν† ν”½</th><th>ν• μ¤„ μ •μ</th></tr></thead>
                    <tbody>
                        <tr><td><strong>μΈν„°λ½νΈ</strong></td><td>CPUκ°€ ν„μ¬ μ‹¤ν–‰μ„ μ¤‘λ‹¨ν•κ³  κΈ΄κΈ‰ μ‚¬κ±΄μ— λ€μ‘ν•κΈ° μ„ν•΄ ISRλ΅ μ μ–΄λ¥Ό μ΄μ „ν•λ” λΉ„λ™κΈ°μ  μ΄λ²¤νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦</td></tr>
                        <tr><td><strong>PCB</strong></td><td>μ΄μμ²΄μ κ°€ ν”„λ΅μ„Έμ¤ κ΄€λ¦¬λ¥Ό μ„ν•΄ μ μ§€ν•λ” ν”„λ΅μ„Έμ¤λ³„ λ©”νƒ€λ°μ΄ν„° μλ£κµ¬μ΅°λ΅, λ¬Έλ§¥ κµν™ μ‹ μ‹¤ν–‰ μƒνƒλ¥Ό λ³΄μ΅΄/λ³µμ›ν•λ” ν•µμ‹¬ λ‹¨μ„</td></tr>
                    </tbody>
                </table>

                <h4>2. ν•µμ‹¬ ν‚¤μ›λ“ λ§µ</h4>
                <div class="insight-box">
                    <span class="text-gray-800"><strong>μΈν„°λ½νΈ ν‚¤μ›λ“:</strong> IRQ / PIC(8259A) / APIC / IDT / ISR / INTA / ν΄λ§ vs μΈν„°λ½νΈ / NMI / νΈλ©(Trap) / ν΄νΈ(Fault) / λ¨λ“ μ „ν™(Userβ†’Kernel)</span>
                </div>
                <div class="insight-box">
                    <span class="text-gray-800"><strong>PCB ν‚¤μ›λ“:</strong> PID / PC / SP / PSW / GPR / ν”„λ΅μ„Έμ¤ μƒνƒ(Running/Ready/Blocked) / λ¬Έλ§¥ κµν™(Context Switching) / TLB Flush / μΊμ‹ μ¤μ—Ό / IRET</span>
                </div>

                <h4>3. λ‘λ¬Έμμ–΄ μ•”κΈ°λ²•</h4>
                <ul>
                    <li>μΈν„°λ½νΈ λ¶„λ¥ 3μ¶•: <strong class="highlight">"ν•μ†λ™λΉ„λ³µ"</strong> (ν•λ“μ›¨μ–΄/μ†ν”„νΈμ›¨μ–΄, λ™κΈ°/λΉ„λ™κΈ°, λ³µκ·€ κ°€λ¥/λ¶κ°€λ¥)</li>
                    <li>μΈν„°λ½νΈ μ²λ¦¬ 8λ‹¨κ³„ ν•µμ‹¬: <strong class="highlight">"λ°μ™„μΈμ €μ „μ»¨μ‹¤λ³µ"</strong> (λ°μƒ-μ™„λ£λ€κΈ°-μΈμ‹-μ €μ¥-μ „ν™-μ»¨ν…μ¤νΈ-ISRμ‹¤ν–‰-λ³µμ›)</li>
                    <li>PCB ν•µμ‹¬ ν•„λ“: <strong class="highlight">"μ‹λ μƒλ©”μ¤"</strong> (μ‹λ³„μ •λ³΄-λ μ§€μ¤ν„°-μƒνƒ-λ©”λ¨λ¦¬-μ¤μΌ€μ¤„λ§)</li>
                    <li>λ¬Έλ§¥ κµν™ λΉ„μ© 4μ”μ†: <strong class="highlight">"λ TLμΊν"</strong> (λ μ§€μ¤ν„°-TLBν”λ¬μ‹-μΊμ‹μ¤μ—Ό-νμ΄ν”„λΌμΈν”λ¬μ‹)</li>
                </ul>

                <h4>4. κ³¨κ²© λ‹µμ• κµ¬μ΅°</h4>
                <p><strong>λ¬Έμ  μ ν•: μΈν„°λ½νΈ μ²λ¦¬ λ©”μ»¤λ‹μ¦κ³Ό PCBλ¥Ό μ„¤λ…ν•μ‹μ¤</strong></p>
                <table>
                    <thead><tr><th>κµ¬λ¶„</th><th>ν•µμ‹¬ λ‚΄μ©</th><th>λ¶„λ‰ λΉ„μ¤‘</th></tr></thead>
                    <tbody>
                        <tr><td><strong>μ„λ΅ </strong></td><td>μΈν„°λ½νΈ μ •μ + ν΄λ§ vs μΈν„°λ½νΈ λΉ„κµ + λ©€ν‹°νƒμ¤ν‚Ήμ κΈ°λ°</td><td>15%</td></tr>
                        <tr><td><strong>λ³Έλ΅  1</strong></td><td>μΈν„°λ½νΈ λ¶„λ¥(3μ¶•) + ν•λ“μ›¨μ–΄ κµ¬μ„±(IRQ/PIC/IDT)</td><td>20%</td></tr>
                        <tr><td><strong>λ³Έλ΅  2</strong></td><td>λ‹¨κ³„λ³„ μ²λ¦¬ κ³Όμ •(νλ¦„λ„ ν•„μ) + ν•λ“μ›¨μ–΄/μ†ν”„νΈμ›¨μ–΄ μ €μ¥ κµ¬λ¶„</td><td>30%</td></tr>
                        <tr><td><strong>λ³Έλ΅  3</strong></td><td>PCB κµ¬μ„± ν•„λ“(ν‘) + λ¬Έλ§¥ κµν™ κ³Όμ • + λΉ„μ© λ¶„μ„</td><td>25%</td></tr>
                        <tr><td><strong>κ²°λ΅ </strong></td><td>DMA/μ‹μ¤ν…μ½κ³Όμ κ΄€κ³„ + Top Half/Bottom Half μµμ ν™”</td><td>10%</td></tr>
                    </tbody>
                </table>

                <h4>5. ν•„μ λ„μ‹</h4>
                <p><strong>λ„μ‹ 1: μΈν„°λ½νΈ μ²λ¦¬ κ³Όμ • νλ¦„λ„</strong></p>
                <pre><code>[λ‹µμ•μ§€μ— μμ§ νλ¦„λ„λ΅ ν‘ν„]
- β‘  μΈν„°λ½νΈ λ°μƒ β†’ β‘΅ ν„μ¬ λ…λ Ήμ–΄ μ™„λ£ β†’ β‘Ά INTA
  β†’ β‘£ PSW/PC μλ™ μ €μ¥(H/W) β†’ β‘¤ λ¨λ“ μ „ν™
  β†’ β‘¥ GPRβ†’PCB μ €μ¥(S/W) β†’ β‘¦ ISR μ‹¤ν–‰
  β†’ β‘§ μ»¨ν…μ¤νΈ λ³µμ› β†’ μ‹¤ν–‰ μ¬κ°
- H/W μν–‰ λ‹¨κ³„μ™€ S/W μν–‰ λ‹¨κ³„λ¥Ό μ μ„ μΌλ΅ κµ¬λ¶„ ν‘μ‹</code></pre>

                <p><strong>λ„μ‹ 2: λ¬Έλ§¥ κµν™ νƒ€μ΄λ° λ‹¤μ΄μ–΄κ·Έλ¨</strong></p>
                <pre><code>[λ‹µμ•μ§€μ— 2κ° ν”„λ΅μ„Έμ¤ κ°„ μ „ν™μ„ μ‹κ°„μ¶•μΌλ΅ ν‘ν„]
Pβ‚ Running β†’ μΈν„°λ½νΈ β†’ Pβ‚ PCB μ €μ¥ β†’ μ¤μΌ€μ¤„λ¬
  β†’ Pβ‚‚ PCB λ³µμ› β†’ Pβ‚‚ Running</code></pre>

                <h4>6. μ°¨λ³„ν™” ν¬μΈνΈ</h4>
                <p><strong>ν•©κ²©κ¶ λ‹µμ•μ„ λ„λ” μ„μ  ν¬μΈνΈ</strong></p>
                <ul>
                    <li>PSW/PCμ ν•λ“μ›¨μ–΄ μλ™ μ €μ¥κ³Ό GPRμ μ†ν”„νΈμ›¨μ–΄ μ €μ¥μ„ λ…ν™•ν κµ¬λ¶„ν•λ©΄ "CPU λ™μ‘μ„ λ§μ΄ν¬λ΅ μμ¤€μΌλ΅ μ΄ν•΄ν•κ³  μλ‹¤"λ” μΈμƒμ„ μ¤€λ‹¤.</li>
                    <li>λ¬Έλ§¥ κµν™ λΉ„μ©μ—μ„ TLB ν”λ¬μ‹μ™€ μΊμ‹ μ¤μ—Όμ„ κµ¬μ²΄μ μΌλ΅ μ–ΈκΈ‰ν•λ©΄ ν•©κ²©κ¶μ„ λ„λ” κΉμ΄λ¥Ό ν™•λ³΄ν•  μ μλ‹¤.</li>
                    <li>Top Half/Bottom Half λ¶„λ¦¬λ¥Ό Linux μ»¤λ„μ μ‹¤μ  κµ¬ν„(softirq, tasklet, workqueue)κ³Ό μ—°κ²°ν•λ©΄ μ‹¤λ¬΄μ  κ΄€μ μ΄ κ°•ν™”λλ‹¤.</li>
                    <li>DMA, μ‹μ¤ν… μ½κ³Όμ κ΄€κ³„λ¥Ό μ μ‹ν•λ©΄ μΈν„°λ½νΈκ°€ OS μ „μ²΄ μ•„ν‚¤ν…μ²μ—μ„ μ°¨μ§€ν•λ” μ„μΉλ¥Ό λ³΄μ—¬μ¤„ μ μλ‹¤.</li>
                </ul>
            </section>
        </div>
    </div>

    </main>

    <!-- AI μ±„ν… ν”λ΅ν… λ²„νΌ -->
    <button onclick="toggleChat()" class="fixed bottom-6 right-6 bg-indigo-600 text-white w-14 h-14 rounded-full shadow-lg hover:bg-indigo-700 transition-all z-50 flex items-center justify-center text-2xl" title="AI νν„°">&#x1f4ac;</button>

    <!-- μ±„ν… μ‚¬μ΄λ“λ°” -->
    <div id="chat-sidebar" class="closed fixed top-0 right-0 w-80 sm:w-96 h-full bg-white shadow-2xl z-50 flex flex-col">
        <div class="flex items-center justify-between p-4 border-b bg-indigo-600 text-white">
            <h3 class="font-bold text-sm">&#x1f916; AI νν„° (μΈν„°λ½νΈ &amp; PCB)</h3>
            <button onclick="toggleChat()" class="text-white hover:text-gray-200 text-xl">&times;</button>
        </div>
        <div id="chatMessages" class="flex-grow overflow-y-auto p-4 flex flex-col space-y-2" style="background:#fafafa;">
            <div class="chat-msg ai"><div class="prose text-sm">μ•λ…•ν•μ„Έμ”! μΈν„°λ½νΈμ™€ PCBμ— λ€ν•΄ μ§λ¬Έν•΄ μ£Όμ„Έμ”. &#x1f60a;</div></div>
        </div>
        <div id="typingIndicator" class="hidden px-4 py-2"><div class="typing-indicator"><span></span><span></span><span></span></div></div>
        <div class="p-3 border-t flex gap-2">
            <input id="chatInput" type="text" class="flex-grow border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300" placeholder="μ§λ¬Έμ„ μ…λ ¥ν•μ„Έμ”..." onkeydown="if(event.key==='Enter')sendChat()">
            <button onclick="sendChat()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-700">μ „μ†΅</button>
        </div>
    </div>

    <!-- API μ„¤μ • λ¨λ‹¬ -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-xl max-w-md w-full p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">&#x1f511; Gemini API Key μ„¤μ •</h3>
            <p class="text-sm text-gray-500 mb-3">AI ν€΄μ¦μ™€ νν„° κΈ°λ¥μ„ μ‚¬μ©ν•λ ¤λ©΄ Gemini API Keyκ°€ ν•„μ”ν•©λ‹λ‹¤.</p>
            <input id="apiKeyInput" type="password" class="w-full border border-gray-300 rounded-lg px-4 py-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-indigo-300" placeholder="API Keyλ¥Ό μ…λ ¥ν•μ„Έμ”">
            <div class="flex gap-2 justify-end">
                <button onclick="toggleSettings()" class="px-4 py-2 text-sm text-gray-600 hover:text-gray-800">μ·¨μ†</button>
                <button onclick="saveSettings()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-700">μ €μ¥</button>
            </div>
        </div>
    </div>

    <!-- ν‘Έν„° -->
    <footer class="bg-white mt-12 py-8 border-t border-gray-200">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <div class="flex flex-col md:flex-row justify-center items-center gap-2 md:gap-6 text-sm text-gray-600 mb-3 font-medium">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-indigo-500"></span>
                    <span>λ°•κµμµPE (132ν μ •λ³΄κ΄€λ¦¬κΈ°μ μ‚¬, dr.code92@gmail.com)</span>
                </div>
            </div>
            <p class="text-xs text-gray-400">Copyright &copy; KPC μ •λ³΄κ΄€λ¦¬κΈ°μ μ‚¬ ZIP-UP μ‹¬ν™”λ°. All rights reserved.</p>
        </div>
    </footer>

<script>
// β”€β”€β”€ λ©ν†  λ¨λ“ β”€β”€β”€
var isMentorMode = new URLSearchParams(window.location.search).get('mentor') === 'true';
if (isMentorMode) {
    document.getElementById('nav-script').classList.remove('hidden');
}
var sections = isMentorMode
    ? ['overview','process','pcb','performance','textbook','script','quiz']
    : ['overview','process','pcb','performance','textbook','quiz'];

// β”€β”€β”€ νƒ­ λ„¤λΉ„κ²μ΄μ… β”€β”€β”€
function navTo(id) {
    document.querySelectorAll('.nav-item').forEach(function(el) {
        el.classList.remove('active','text-indigo-600');
    });
    var navEl = document.getElementById('nav-' + id);
    if (navEl) navEl.classList.add('active','text-indigo-600');
    sections.forEach(function(s) {
        var sec = document.getElementById(s);
        if (sec) sec.classList.add('hidden');
    });
    var target = document.getElementById(id);
    if (target) target.classList.remove('hidden');
    window.scrollTo({top:0,behavior:'smooth'});
}

// β”€β”€β”€ ν΄λ¦­ ν™•μ¥: μΈν„°λ½νΈ μ²λ¦¬ λ‹¨κ³„ μƒμ„Έ β”€β”€β”€
var stepDetails = {
    'step1': {
        title: '\u2460\u2461 λ°μƒ \u00b7 μ™„λ£ λ€κΈ°',
        color: 'text-red-700',
        content: '<p class="text-sm text-gray-600 leading-relaxed mb-2">ν•λ“μ›¨μ–΄ μ¥μΉκ°€ IRQ λΌμΈμ— μ „κΈ° μ‹ νΈλ¥Ό μΈκ°€ν•©λ‹λ‹¤. PIC(Programmable Interrupt Controller)κ°€ μ‹ νΈλ¥Ό μμ‹ ν•μ—¬ μ°μ„ μμ„λ¥Ό νλ³„ν• ν›„, CPUμ INT ν•€μ— μΈν„°λ½νΈ μ‹ νΈλ¥Ό μ „λ‹¬ν•©λ‹λ‹¤.</p><p class="text-sm text-gray-600 leading-relaxed">CPUλ” ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ λ…λ Ήμ–΄λ¥Ό μ™„λ£ν• ν›„μ—μ•Ό μΈν„°λ½νΈλ¥Ό μ²λ¦¬ν•©λ‹λ‹¤. μ›μμ (Atomic) λ…λ Ήμ–΄ μ‹¤ν–‰μ„ λ³΄μ¥ν•κΈ° μ„ν•¨μ…λ‹λ‹¤. λ‹¨, NMI(Non-Maskable Interrupt)λ” μμ™Έμ…λ‹λ‹¤.</p>'
    },
    'step2': {
        title: '\u2462 μΈμ‹ (INTA)',
        color: 'text-red-700',
        content: '<p class="text-sm text-gray-600 leading-relaxed">CPUλ” PSWμ μΈν„°λ½νΈ ν—μ© λΉ„νΈ(IF)λ¥Ό κ²€μ‚¬ν•©λ‹λ‹¤. IF=1μ΄λ©΄ μΈν„°λ½νΈλ¥Ό μμ©ν•κ³ , PICμ— INTA(Interrupt Acknowledge) μ‹ νΈλ¥Ό λ³΄λƒ…λ‹λ‹¤. PICλ” μΈν„°λ½νΈ λ²΅ν„° λ²νΈλ¥Ό λ°μ΄ν„° λ²„μ¤μ— μ‹¤μ–΄ CPUμ— μ „λ‹¬ν•©λ‹λ‹¤.</p>'
    },
    'step3': {
        title: '\u2463\u2464 μ €μ¥ \u00b7 μ „ν™',
        color: 'text-red-700',
        content: '<p class="text-sm text-gray-600 leading-relaxed mb-2"><strong>\u2463 PSW/PC μλ™ μ €μ¥ (H/W)</strong>: CPU λ§μ΄ν¬λ΅μ½”λ“κ°€ μλ™μΌλ΅ PSWμ™€ PCλ¥Ό μ»¤λ„ μ¤νƒμ— pushν•©λ‹λ‹¤. μ†ν”„νΈμ›¨μ–΄ κ°μ… μ—†μ΄ μν–‰λλ©°, μΈν„°λ½νΈ μ²λ¦¬μ μ›μμ„±μ„ λ³΄μ¥ν•©λ‹λ‹¤.</p><p class="text-sm text-gray-600 leading-relaxed"><strong>\u2464 λ¨λ“ μ „ν™</strong>: User Mode \u2192 Kernel Modeλ΅ μ „ν™, IF=0μΌλ΅ μ„¤μ •ν•μ—¬ μ¶”κ°€ μΈν„°λ½νΈλ¥Ό μ°¨λ‹¨ν•©λ‹λ‹¤. IDTμ—μ„ ISR μ‹μ‘ μ£Όμ†λ¥Ό PCμ— λ΅λ“ν•©λ‹λ‹¤.</p>'
    },
    'step4': {
        title: '\u2465\u2466\u2467 μ»¨ν…μ¤νΈ \u00b7 ISR \u00b7 λ³µμ›',
        color: 'text-blue-700',
        content: '<p class="text-sm text-gray-600 leading-relaxed mb-2"><strong>\u2465 μ»¨ν…μ¤νΈ μ €μ¥ (S/W)</strong>: OS μ»¤λ„μ΄ λ²”μ© λ μ§€μ¤ν„°(GPR), SP, FPU λ“±μ„ PCBμ— μ €μ¥ν•©λ‹λ‹¤.</p><p class="text-sm text-gray-600 leading-relaxed mb-2"><strong>\u2466 ISR μ‹¤ν–‰</strong>: μΈν„°λ½νΈ μ›μΈμ„ μ²λ¦¬ν•©λ‹λ‹¤. (I/O μ™„λ£ ν™•μΈ, νƒ€μ΄λ¨Έ μ²λ¦¬ λ“±)</p><p class="text-sm text-gray-600 leading-relaxed"><strong>\u2467 λ³µμ›</strong>: μ¤μΌ€μ¤„λ¬κ°€ λ‹¤μ ν”„λ΅μ„Έμ¤λ¥Ό μ„ νƒν•κ³ , PCBμ—μ„ λ μ§€μ¤ν„°λ¥Ό λ³µμ›ν•©λ‹λ‹¤. IRET λ…λ Ήμ–΄λ΅ PSW/PCλ¥Ό λ³µμ›ν•μ—¬ μ‹¤ν–‰μ„ μ¬κ°ν•©λ‹λ‹¤.</p>'
    }
};
function updateStepDetail(key) {
    document.querySelectorAll('.tech-block').forEach(function(el) { el.classList.remove('selected'); });
    var block = document.getElementById('block-' + key);
    if (block) block.classList.add('selected');
    var d = stepDetails[key];
    if (d) {
        document.getElementById('step-detail-content').innerHTML =
            '<h4 class="text-lg font-bold mb-3 ' + d.color + '">' + d.title + '</h4>' + d.content;
    }
}

// β”€β”€β”€ strategy-card ν† κΈ€ β”€β”€β”€
function toggleStrategy(el) {
    var d = el.querySelector('.strategy-detail');
    var s = el.querySelector('.strategy-summary');
    if (d.classList.contains('hidden')) {
        document.querySelectorAll('.strategy-detail').forEach(function(x){x.classList.add('hidden');});
        document.querySelectorAll('.strategy-summary').forEach(function(x){x.classList.remove('hidden');});
        d.classList.remove('hidden');
        s.classList.add('hidden');
    } else {
        d.classList.add('hidden');
        s.classList.remove('hidden');
    }
}

// β”€β”€β”€ API Key κ΄€λ¦¬ β”€β”€β”€
var geminiKey = localStorage.getItem('geminiKey') || new URLSearchParams(window.location.search).get('key') || '';
function toggleSettings() {
    var m = document.getElementById('settings-modal');
    m.classList.toggle('hidden');
    if (!m.classList.contains('hidden')) {
        document.getElementById('apiKeyInput').value = geminiKey;
    }
}
function saveSettings() {
    geminiKey = document.getElementById('apiKeyInput').value.trim();
    if (geminiKey) localStorage.setItem('geminiKey', geminiKey);
    toggleSettings();
}

// β”€β”€β”€ AI νν„° μ±„ν… β”€β”€β”€
var chatOpen = false;
function toggleChat() {
    chatOpen = !chatOpen;
    var sb = document.getElementById('chat-sidebar');
    sb.classList.toggle('open', chatOpen);
    sb.classList.toggle('closed', !chatOpen);
}
function appendChat(role, html) {
    var box = document.getElementById('chatMessages');
    var div = document.createElement('div');
    div.className = 'chat-msg ' + role;
    if (role === 'ai') {
        div.innerHTML = '<div class="prose text-sm">' + html + '</div>';
    } else {
        div.textContent = html;
    }
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
}
function showTyping() { document.getElementById('typingIndicator').classList.remove('hidden'); }
function hideTyping() { document.getElementById('typingIndicator').classList.add('hidden'); }
async function sendChat() {
    if (!geminiKey) { alert('API Key\ub97c \uba3c\uc800 \uc124\uc815\ud574\uc8fc\uc138\uc694.'); toggleSettings(); return; }
    var input = document.getElementById('chatInput');
    var msg = input.value.trim();
    if (!msg) return;
    input.value = '';
    appendChat('user', msg);
    showTyping();
    try {
        var r = await fetch(
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key=' + geminiKey,
            { method:'POST', headers:{'Content-Type':'application/json'},
              body: JSON.stringify({
                  contents:[{parts:[{text:"\ub2f9\uc2e0\uc740 \uc815\ubcf4\uad00\ub9ac\uae30\uc220\uc0ac \uc2dc\ud5d8 \uba58\ud1a0\uc785\ub2c8\ub2e4. '\uc778\ud130\ub7fd\ud2b8(Interrupt) \ucc98\ub9ac \uba54\ucee4\ub2c8\uc998\uacfc PCB' \uad00\ub828 \uc9c8\ubb38\uc5d0 \uc804\ubb38\uc801\uc774\uace0 \uba85\ucf8c\ud558\uac8c \ub2f5\ubcc0\ud574\uc8fc\uc138\uc694. 300\uc790 \uc774\ub0b4\ub85c \ud575\uc2ec\ub9cc \uc694\uc57d.\n\n\uc9c8\ubb38: " + msg}]}]
              })
            }
        );
        var d = await r.json();
        hideTyping();
        var answer = d.candidates[0].content.parts[0].text;
        appendChat('ai', marked.parse(answer));
    } catch(e) {
        hideTyping();
        appendChat('ai', '\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ' + e.message);
    }
}

// β”€β”€β”€ AI ν€΄μ¦ β”€β”€β”€
var quizTypeHistory = [];
var currentQuizData = null;
var quizTopics = [
    {category:"\uc778\ud130\ub7fd\ud2b8 \uac1c\ub150 \ubc0f \ubd84\ub958",keywords:"IRQ, PIC, APIC, IDT, ISR, \ud3f4\ub9c1, \ud558\uc18c\ub3d9\ube44\ubcf5, \ud2b8\ub7a9, \ud3f4\ud2b8, NMI"},
    {category:"\uc778\ud130\ub7fd\ud2b8 \ucc98\ub9ac 8\ub2e8\uacc4",keywords:"\ubc1c\uc644\uc778\uc800\uc804\ucee8\uc2e4\ubcf5, INTA, PSW, PC, \ucee4\ub110 \uc2a4\ud0dd, \ubaa8\ub4dc \uc804\ud658, ISR"},
    {category:"PCB \ud544\ub4dc \uad6c\uc131",keywords:"PID, PPID, PC, SP, PSW, GPR, \ud504\ub85c\uc138\uc2a4 \uc0c1\ud0dc, \ud398\uc774\uc9c0 \ud14c\uc774\ube14, \uc2dd\ub808\uc0c1\uba54\uc2a4"},
    {category:"\ubb38\ub9e5 \uad50\ud658(Context Switching)",keywords:"PCB \uc800\uc7a5/\ubcf5\uc6d0, TLB \ud50c\ub7ec\uc2dc, \uce90\uc2dc \uc624\uc5fc, \ud30c\uc774\ud504\ub77c\uc778, \ub808TL\uce90\ud30c, IRET"},
    {category:"H/W vs S/W \uc800\uc7a5 \uad6c\ubd84",keywords:"PSW/PC \ud558\ub4dc\uc6e8\uc5b4 \uc790\ub3d9, GPR \uc18c\ud504\ud2b8\uc6e8\uc5b4, CPU \ub9c8\uc774\ud06c\ub85c\ucf54\ub4dc, OS \ucee4\ub110"},
    {category:"\uc131\ub2a5 \ucd5c\uc801\ud654",keywords:"Top Half, Bottom Half, softirq, tasklet, Threaded Interrupt, Interrupt Coalescing, NAPI"},
    {category:"\uc5f0\uad00 \uc774\ub860",keywords:"DMA, \uc2dc\uc2a4\ud15c \ucf5c, \ud504\ub85c\uc138\uc2a4 \uc0c1\ud0dc \uc804\uc774, Running, Ready, Blocked"},
    {category:"CPU \ub808\uc9c0\uc2a4\ud130 \ubc0f HW \uad6c\uc131",keywords:"PC, SP, PSW, GPR, MAR, MBR, IRQ, PIC, IDT, IVT, APIC"}
];

async function generateQuiz() {
    if (!geminiKey) { alert('API Key\ub97c \uba3c\uc800 \uc124\uc815\ud574\uc8fc\uc138\uc694.'); toggleSettings(); return; }
    document.getElementById('quiz-placeholder').classList.add('hidden');
    document.getElementById('quiz-container').classList.add('hidden');
    document.getElementById('quiz-loading').classList.remove('hidden');

    var isMC;
    var recent = quizTypeHistory.slice(-2);
    if (recent.length >= 2 && recent[0] === recent[1]) {
        isMC = !recent[1];
    } else {
        isMC = Math.random() > 0.5;
    }
    quizTypeHistory.push(isMC);

    var selected = quizTopics[Math.floor(Math.random() * quizTopics.length)];
    var quizType = isMC ? '\uac1d\uad00\uc2dd (4\uc9c0\uc120\ub2e4)' : '\ub2e8\ub2f5\ud615';
    var format = isMC
        ? '{"question":"\ubb38\uc81c","options":["A","B","C","D"],"correctIndex":0,"explanation":"\ud574\uc124"}'
        : '{"question":"\ubb38\uc81c","correctAnswer":"\uc815\ub2f5","explanation":"\ud574\uc124"}';
    var prompt = "\ub2e4\uc74c \uce74\ud14c\uace0\ub9ac\uc5d0 \ub300\ud55c " + quizType + " \ud034\uc988 1\ubb38\uc81c\ub97c \ub9cc\ub4dc\uc138\uc694.\n"
        + "\uce74\ud14c\uace0\ub9ac: " + selected.category + "\n"
        + "\uad00\ub828 \ud0a4\uc6cc\ub4dc: " + selected.keywords + "\n"
        + "\uaddc\uce59: \ubc18\ub4dc\uc2dc \uc704 \uce74\ud14c\uace0\ub9ac\uc640 \ud0a4\uc6cc\ub4dc\uc5d0 \uc9c1\uc811 \uad00\ub828\ub41c \ubb38\uc81c\ub97c \ucd9c\uc81c\ud558\uc138\uc694.\n"
        + "JSON \ud615\uc2dd\uc73c\ub85c \uc751\ub2f5: " + format;

    try {
        var r = await fetch(
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key=' + geminiKey,
            { method:'POST', headers:{'Content-Type':'application/json'},
              body: JSON.stringify({
                  contents:[{parts:[{text:prompt}]}],
                  generationConfig:{responseMimeType:"application/json"}
              })
            }
        );
        var d = await r.json();
        var t = d.candidates[0].content.parts[0].text;
        t = t.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim();
        var depth=0,start=-1,end=-1;
        for(var i=0;i<t.length;i++){
            if(t[i]==='{'){if(depth===0)start=i;depth++;}
            else if(t[i]==='}'){depth--;if(depth===0&&start!==-1){end=i;break;}}
        }
        if(start===-1||end===-1)throw new Error("No JSON found");
        t=t.substring(start,end+1);
        t=t.replace(/[\x00-\x1F\x7F]/g,function(c){return c==='\n'||c==='\r'||c==='\t'?' ':'';});
        currentQuizData = JSON.parse(t);
        document.getElementById('quiz-loading').classList.add('hidden');
        renderQuiz();
    } catch(e) {
        document.getElementById('quiz-loading').classList.add('hidden');
        document.getElementById('quiz-placeholder').classList.remove('hidden');
        alert('\ud034\uc988 \uc0dd\uc131 \uc624\ub958: ' + e.message);
    }
}

function renderQuiz() {
    var c = document.getElementById('quiz-container');
    c.classList.remove('hidden');
    if (currentQuizData.options) {
        // κ°κ΄€μ‹
        var labels = ['A','B','C','D'];
        var html = '<div class="mb-4"><p class="font-bold text-gray-800 mb-4">' + currentQuizData.question + '</p>';
        html += '<div class="space-y-2">';
        currentQuizData.options.forEach(function(opt, idx) {
            html += '<button onclick="checkMultipleChoice(' + idx + ',this)" class="w-full text-left px-4 py-3 rounded-lg border-2 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 transition-all flex items-center gap-3">'
                + '<span class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center font-bold text-gray-600 text-sm flex-shrink-0">' + labels[idx] + '</span>'
                + '<span class="text-sm text-gray-700">' + opt + '</span></button>';
        });
        html += '</div></div><div id="quiz-feedback"></div>';
        c.innerHTML = html;
    } else {
        // λ‹¨λ‹µν•
        var html = '<div class="mb-4"><p class="font-bold text-gray-800 mb-4">' + currentQuizData.question + '</p>'
            + '<div class="flex gap-2"><input id="shortAnswerInput" type="text" class="flex-grow border border-gray-300 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300" placeholder="\ub2f5\uc548\uc744 \uc785\ub825\ud558\uc138\uc694..." onkeydown="if(event.key===&#39;Enter&#39;)checkShortAnswer()">'
            + '<button id="shortAnswerBtn" onclick="checkShortAnswer()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-700">\uc81c\ucd9c</button></div></div>'
            + '<div id="quiz-feedback"></div>';
        c.innerHTML = html;
    }
}

function checkMultipleChoice(idx, btnEl) {
    var correct = idx === currentQuizData.correctIndex;
    // disable all buttons
    document.querySelectorAll('#quiz-container button').forEach(function(b){ b.disabled = true; b.classList.add('opacity-60','cursor-not-allowed'); });
    if (correct) {
        btnEl.classList.remove('border-gray-200');
        btnEl.classList.add('border-green-500','bg-green-50');
    } else {
        btnEl.classList.remove('border-gray-200');
        btnEl.classList.add('border-red-500','bg-red-50');
        // highlight correct
        var buttons = document.querySelectorAll('#quiz-container button');
        if (buttons[currentQuizData.correctIndex]) {
            buttons[currentQuizData.correctIndex].classList.remove('border-gray-200');
            buttons[currentQuizData.correctIndex].classList.add('border-green-500','bg-green-50');
        }
    }
    showQuizFeedback(correct, currentQuizData.explanation);
}

async function checkShortAnswer() {
    var input = document.getElementById('shortAnswerInput');
    var btn = document.getElementById('shortAnswerBtn');
    var userAnswer = input.value.trim();
    if (!userAnswer) return;
    input.disabled = true;
    btn.disabled = true;
    btn.textContent = '\ucc44\uc810 \uc911...';

    try {
        var gradingPrompt = "\ub2f9\uc2e0\uc740 \uc815\ubcf4\uad00\ub9ac\uae30\uc220\uc0ac \uc2dc\ud5d8 \ucc44\uc810\uad00\uc785\ub2c8\ub2e4. "
            + "\uc544\ub798 \ubb38\uc81c\uc5d0 \ub300\ud574 \uc0ac\uc6a9\uc790\uc758 \ub2f5\uc548\uc774 \uc815\ub2f5\uc73c\ub85c \uc778\uc815\ub420 \uc218 \uc788\ub294\uc9c0 \ud310\uc815\ud558\uc138\uc694.\n\n"
            + "\ubb38\uc81c: " + currentQuizData.question + "\n"
            + "\ubaa8\ubc94 \uc815\ub2f5: " + currentQuizData.correctAnswer + "\n"
            + "\uc0ac\uc6a9\uc790 \ub2f5\uc548: " + userAnswer + "\n\n"
            + "\ud310\uc815 \uae30\uc900:\n- \ud575\uc2ec \uc758\ubbf8\uac00 \ub3d9\uc77c\ud558\uba74 \uc815\ub2f5\n- \uc57d\uc5b4/\ud480\ub124\uc784 \ubaa8\ub450 \uc778\uc815\n- \uc601\uc5b4/\ud55c\uae00 \ud63c\uc6a9 \uc778\uc815\n- \ub744\uc5b4\uc4f0\uae30/\uc870\uc0ac \ucc28\uc774\ub294 \ubb34\uc2dc\n- \uc758\ubbf8\uac00 \uba85\ud655\ud788 \ub2e4\ub974\uba74 \uc624\ub2f5\n\n"
            + "Output JSON: {\"correct\":true/false,\"reason\":\"\ud310\uc815 \uc774\uc720\"}";
        var r = await fetch(
            'https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key=' + geminiKey,
            { method:'POST', headers:{'Content-Type':'application/json'},
              body: JSON.stringify({
                  contents:[{parts:[{text:gradingPrompt}]}],
                  generationConfig:{responseMimeType:"application/json"}
              })
            }
        );
        var d = await r.json();
        var t = d.candidates[0].content.parts[0].text;
        t = t.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim();
        var depth2=0,start2=-1,end2=-1;
        for(var i=0;i<t.length;i++){
            if(t[i]==='{'){if(depth2===0)start2=i;depth2++;}
            else if(t[i]==='}'){depth2--;if(depth2===0&&start2!==-1){end2=i;break;}}
        }
        if(start2===-1||end2===-1)throw new Error("No JSON");
        t=t.substring(start2,end2+1);
        t=t.replace(/[\x00-\x1F\x7F]/g,function(c){return c==='\n'||c==='\r'||c==='\t'?' ':'';});
        var result = JSON.parse(t);
        showQuizFeedback(result.correct, currentQuizData.explanation, currentQuizData.correctAnswer, result.reason);
    } catch(e) {
        // ν΄λ°±: λ΅μ»¬ λΉ„κµ
        var normalize = function(s){return s.replace(/\s/g,'').toLowerCase();};
        var correct = normalize(currentQuizData.correctAnswer).includes(normalize(userAnswer))
                   || normalize(userAnswer).includes(normalize(currentQuizData.correctAnswer));
        showQuizFeedback(correct, currentQuizData.explanation, currentQuizData.correctAnswer, '(\ub85c\uceec \ucc44\uc810)');
    }
}

function showQuizFeedback(correct, explanation, correctAnswer, reason) {
    var fb = document.getElementById('quiz-feedback');
    var color = correct ? 'green' : 'red';
    var icon = correct ? '\u2705' : '\u274c';
    var label = correct ? '\uc815\ub2f5\uc785\ub2c8\ub2e4!' : '\uc624\ub2f5\uc785\ub2c8\ub2e4.';
    var html = '<div class="mt-4 border-l-4 border-' + color + '-500 bg-' + color + '-50 rounded-r-xl p-4 animate-fade-in">'
        + '<p class="font-bold text-' + color + '-700 mb-2">' + icon + ' ' + label + '</p>';
    if (correctAnswer) html += '<p class="text-sm text-gray-700 mb-1"><strong>\ubaa8\ubc94 \uc815\ub2f5:</strong> ' + correctAnswer + '</p>';
    if (reason) html += '<p class="text-sm text-gray-500 mb-1"><strong>\ud310\uc815:</strong> ' + reason + '</p>';
    html += '<p class="text-sm text-gray-600"><strong>\ud574\uc124:</strong> ' + explanation + '</p></div>';
    fb.innerHTML = html;
}

// β”€β”€β”€ Chart.js β”€β”€β”€
window.addEventListener('DOMContentLoaded', function() {
    // λ μ΄λ” μ°¨νΈ: ν΄λ§ vs μΈν„°λ½νΈ
    var ctx1 = document.getElementById('overviewRadar');
    if (ctx1) {
        new Chart(ctx1.getContext('2d'), {
            type: 'radar',
            data: {
                labels: ['CPU \ud6a8\uc728\uc131','\uc751\ub2f5\uc18d\ub3c4','\uad6c\ud604 \ubcf5\uc7a1\ub3c4','\uc2e4\uc2dc\uac04 \uc801\ud569\uc131','\ud655\uc7a5\uc131'],
                datasets: [
                    { label:'\ud3f4\ub9c1',data:[2,5,2,3,2],borderColor:'#ef4444',backgroundColor:'rgba(239,68,68,0.1)',pointBackgroundColor:'#ef4444' },
                    { label:'\uc778\ud130\ub7fd\ud2b8',data:[9,8,7,8,9],borderColor:'#4f46e5',backgroundColor:'rgba(79,70,229,0.1)',pointBackgroundColor:'#4f46e5' }
                ]
            },
            options: { responsive:true, maintainAspectRatio:false, scales:{r:{beginAtZero:true,max:10,ticks:{stepSize:2}}} }
        });
    }
    // λ°” μ°¨νΈ: λ¬Έλ§¥ κµν™ λΉ„μ©
    var ctx2 = document.getElementById('contextCostChart');
    if (ctx2) {
        new Chart(ctx2.getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['\ub808\uc9c0\uc2a4\ud130 I/O','TLB \ud50c\ub7ec\uc2dc','\uce90\uc2dc \uc624\uc5fc','\ud30c\uc774\ud504\ub77c\uc778'],
                datasets: [{
                    label:'\uc601\ud5a5\ub3c4 (\uc0c1\ub300\uc801)',
                    data:[3,8,9,4],
                    backgroundColor:['rgba(239,68,68,0.7)','rgba(249,115,22,0.7)','rgba(245,158,11,0.7)','rgba(139,92,246,0.7)'],
                    borderColor:['#ef4444','#f97316','#f59e0b','#8b5cf6'],
                    borderWidth:1
                }]
            },
            options: { responsive:true, maintainAspectRatio:false, scales:{y:{beginAtZero:true,max:10}}, plugins:{legend:{display:false}} }
        });
    }
});
</script>
</body>
</html>
