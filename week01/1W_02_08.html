<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI 윤리 가이드라인, XAI, EU AI Act</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<style>
body{font-family:'Noto Sans KR',sans-serif}
.tab-btn{padding:0.5rem 1rem;font-size:0.85rem;font-weight:500;border-radius:0.5rem;white-space:nowrap;transition:all 0.2s}
.tab-btn.active{background:#4f46e5;color:#fff;box-shadow:0 2px 8px rgba(79,70,229,0.3)}
.tab-btn:not(.active){color:#6b7280}
.tab-btn:not(.active):hover{background:#e0e7ff;color:#4338ca}
.tab-btn.mentor-tab{color:#b45309}
.tab-btn.mentor-tab.active{background:#d97706;color:#fff;box-shadow:0 2px 8px rgba(217,119,6,0.3)}
.def-box{background:linear-gradient(135deg,#ede9fe 0%,#e0e7ff 100%);border-left:4px solid #6366f1;padding:1.5rem;border-radius:0.75rem;margin:1rem 0}
.info-card{border-radius:0.75rem;padding:1.25rem;margin-bottom:1rem;border-left:4px solid}
.info-card.indigo{background:#eef2ff;border-color:#6366f1}
.info-card.green{background:#ecfdf5;border-color:#10b981}
.info-card.purple{background:#faf5ff;border-color:#8b5cf6}
.info-card.amber{background:#fffbeb;border-color:#f59e0b}
.info-card.teal{background:#f0fdfa;border-color:#14b8a6}
.info-card.red{background:#fef2f2;border-color:#ef4444}
.tech-block{background:#fff;border:1px solid #e5e7eb;border-radius:0.75rem;margin-bottom:0.75rem;overflow:hidden;cursor:pointer}
.tech-block .tech-header{padding:1rem 1.25rem;display:flex;justify-content:space-between;align-items:center}
.tech-block .tech-header:hover{background:#f9fafb}
.tech-block .tech-body{display:none;padding:0 1.25rem 1.25rem;border-top:1px solid #f3f4f6}
.tech-block.open .tech-body{display:block}
.tech-block .chevron{transition:transform 0.2s}
.tech-block.open .chevron{transform:rotate(180deg)}
.insight-box{background:linear-gradient(135deg,#faf5ff 0%,#eef2ff 100%);border-left:4px solid #8b5cf6;padding:1.25rem;border-radius:0.75rem;margin:1rem 0}
.strategy-card{background:#fff;border:1px solid #e5e7eb;border-radius:0.75rem;margin-bottom:0.75rem;overflow:hidden;cursor:pointer}
.strategy-card .str-header{padding:1rem 1.25rem;display:flex;justify-content:space-between;align-items:center}
.strategy-card .str-header:hover{background:#f9fafb}
.strategy-card .str-body{display:none;padding:0 1.25rem 1.25rem;border-top:1px solid #f3f4f6}
.strategy-card.open .str-body{display:block}
.strategy-card .chevron{transition:transform 0.2s}
.strategy-card.open .chevron{transform:rotate(180deg)}
.textbook-content h3{font-size:1.2rem;font-weight:700;color:#1e1b4b;margin:2rem 0 1rem;padding-bottom:0.5rem;border-bottom:2px solid #e0e7ff}
.textbook-content h4{font-size:1.05rem;font-weight:600;color:#312e81;margin:1.5rem 0 0.75rem}
.textbook-content p{margin:0.5rem 0;line-height:1.8;color:#374151}
.textbook-content ul,.textbook-content ol{margin:0.5rem 0 0.5rem 1.5rem;color:#374151}
.textbook-content li{margin:0.3rem 0;line-height:1.7}
.textbook-content table{width:100%;border-collapse:collapse;margin:1rem 0;font-size:0.9rem}
.textbook-content th{background:#eef2ff;color:#312e81;padding:0.75rem;text-align:left;border:1px solid #c7d2fe;font-weight:600}
.textbook-content td{padding:0.75rem;border:1px solid #e5e7eb;color:#374151}
.textbook-content tr:nth-child(even){background:#f9fafb}
.typing-indicator span{display:inline-block;width:8px;height:8px;border-radius:50%;background:#6366f1;margin:0 2px;animation:bounce 1.4s infinite ease-in-out both}
.typing-indicator span:nth-child(1){animation-delay:-0.32s}
.typing-indicator span:nth-child(2){animation-delay:-0.16s}
@keyframes bounce{0%,80%,100%{transform:scale(0)}40%{transform:scale(1)}}
.chat-sidebar{position:fixed;top:0;right:-420px;width:400px;height:100%;background:#fff;box-shadow:-5px 0 25px rgba(0,0,0,0.15);transition:right 0.3s ease;z-index:1000;display:flex;flex-direction:column}
.chat-sidebar.open{right:0}
.highlight{background:linear-gradient(120deg,#fde68a 0%,#fbbf24 100%);padding:0.1em 0.3em;border-radius:0.25em;font-weight:600}
</style>
</head><body class="bg-gray-50 font-sans">
<header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex items-center justify-between py-3">
      <div>
        <p class="text-xs text-indigo-600 font-semibold tracking-wide">KPC 정보관리기술사 ZIP-UP 심화반</p>
        <h1 class="text-xl font-black text-gray-900 mt-0.5">AI 윤리 가이드라인, XAI, EU AI Act</h1>
      </div>
      <span class="bg-indigo-100 text-indigo-800 text-xs font-bold px-3 py-1 rounded-full">2026</span>
    </div>
    <div class="flex items-center gap-2 pb-3 overflow-x-auto" id="tab-nav">
      <button class="tab-btn active" onclick="navTo('overview')">개요 및 개념</button>
      <button class="tab-btn" onclick="navTo('ethics')">윤리 원칙</button>
      <button class="tab-btn" onclick="navTo('xai')">XAI 기술</button>
      <button class="tab-btn" onclick="navTo('euaiact')">EU AI Act</button>
      <button class="tab-btn" onclick="navTo('textbook')">원문 학습</button>
      <button class="tab-btn mentor-tab" onclick="navTo('script')" id="tab-script" style="display:none;">🎬 강의 스크립트</button>
      <button class="tab-btn" onclick="navTo('quiz')">퀴즈 &amp; 암기</button>
      <button onclick="toggleSettings()" class="ml-auto bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-1.5 rounded-full text-xs font-medium transition-colors whitespace-nowrap">🔑 API 설정</button>
    </div>
  </div>
</header>
<main class="max-w-6xl mx-auto px-4 py-8"><div id="overview">
  <!-- 정의 박스 -->
  <div class="def-box">
    <p class="font-bold text-indigo-900 text-lg mb-2">📌 핵심 정의</p>
    <p class="text-indigo-800 leading-relaxed"><strong>AI 윤리 3대 원칙(공정성·투명성·책임성)</strong>은 XAI(LIME·SHAP)로 기술적으로 구현되며, <strong>EU AI Act</strong>는 4단계 위험 기반 규제로 이를 법적으로 강제한다.</p>
  </div>

  <!-- 개념 해설 -->
  <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mt-6">
    <h3 class="font-bold text-gray-900 text-lg mb-3">💡 개념 해설</h3>
    <p class="text-gray-700 leading-relaxed mb-3">AI가 채용, 대출 심사, 사법 판결 등 핵심 의사결정에 도입되면서 <strong>편향(Bias)</strong>, <strong>불투명성(Opacity)</strong>, <strong>책임 소재 불명확</strong> 등의 윤리적 문제가 심화되고 있습니다. 이 토픽은 AI의 윤리적 활용을 위한 <strong>원칙(Ethics)</strong>, 투명성을 기술적으로 구현하는 <strong>XAI 기술</strong>, 그리고 이를 법적으로 강제하는 <strong>EU AI Act</strong>의 삼층 구조를 다룹니다.</p>
    <p class="text-gray-700 leading-relaxed">2018년 Amazon의 AI 채용 시스템이 여성 지원자를 체계적으로 불이익 처리한 사건, 2019년 COMPAS 알고리즘의 인종 편향 사건 등이 AI 윤리 논의를 가속화시켰습니다.</p>
  </div>

  <!-- 삼층 구조 시각화 -->
  <div class="mt-6">
    <h3 class="font-bold text-gray-900 text-lg mb-4">🏗️ 원칙 → 기술 → 제도 삼층 구조</h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-white rounded-xl p-5 shadow-sm border-2 border-indigo-200 text-center">
        <div class="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <span class="text-2xl">⚖️</span>
        </div>
        <p class="font-bold text-indigo-800 mb-1">소문제 1: 윤리 원칙</p>
        <p class="text-sm text-gray-600">"AI가 따라야 할 원칙은?"</p>
        <p class="text-xs text-indigo-600 mt-2 font-semibold">공정성·투명성·책임성</p>
      </div>
      <div class="relative bg-white rounded-xl p-5 shadow-sm border-2 border-green-200 text-center">
        <div class="hidden md:block absolute left-0 top-1/2 -translate-x-1/2 -translate-y-1/2 text-2xl text-gray-400">→</div>
        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <span class="text-2xl">🔬</span>
        </div>
        <p class="font-bold text-green-800 mb-1">소문제 2: XAI 기술</p>
        <p class="text-sm text-gray-600">"투명성을 어떻게 구현?"</p>
        <p class="text-xs text-green-600 mt-2 font-semibold">LIME·SHAP</p>
      </div>
      <div class="relative bg-white rounded-xl p-5 shadow-sm border-2 border-purple-200 text-center">
        <div class="hidden md:block absolute left-0 top-1/2 -translate-x-1/2 -translate-y-1/2 text-2xl text-gray-400">→</div>
        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <span class="text-2xl">📋</span>
        </div>
        <p class="font-bold text-purple-800 mb-1">소문제 3: EU AI Act</p>
        <p class="text-sm text-gray-600">"법으로 어떻게 강제?"</p>
        <p class="text-xs text-purple-600 mt-2 font-semibold">4단계 위험 분류</p>
      </div>
    </div>
  </div>

  <!-- 배경 카드 -->
  <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="info-card amber">
      <p class="font-bold text-amber-800 mb-1">⚠️ AI 편향 사건</p>
      <p class="text-sm text-amber-700">Amazon 채용 AI(2018): 여성 지원자 체계적 불이익 → 폐기<br>COMPAS 알고리즘(2019): 흑인 재범 가능성 과대 예측</p>
    </div>
    <div class="info-card indigo">
      <p class="font-bold text-indigo-800 mb-1">🌍 글로벌 규제 동향</p>
      <p class="text-sm text-indigo-700">EU AI Act: 2024.8 발효, 2026.8 완전 시행<br>한국: AI 기본법 제정 논의 진행 중<br>OECD: 42개국 AI 원칙 채택(2019)</p>
    </div>
    <div class="info-card green">
      <p class="font-bold text-green-800 mb-1">🔑 핵심 연결고리</p>
      <p class="text-sm text-green-700">GDPR 제22조(설명 요구권) → XAI 필요성의 법적 근거<br>EU AI Act → GDPR의 AI 확장판</p>
    </div>
    <div class="info-card purple">
      <p class="font-bold text-purple-800 mb-1">📊 문제 구조 (2교시형)</p>
      <p class="text-sm text-purple-700">소문제 1(25%): AI 윤리 3대 원칙<br>소문제 2(30%): XAI / LIME / SHAP<br>소문제 3(25%): EU AI Act 4단계</p>
    </div>
  </div>
</div><div id="ethics" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">⚖️ AI 윤리 3대 원칙과 핵심 요건</h2>

  <!-- 3대 원칙 카드 -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
    <div class="bg-white rounded-xl p-5 shadow-sm border-l-4 border-indigo-500">
      <div class="flex items-center gap-2 mb-3">
        <span class="bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded">공</span>
        <h4 class="font-bold text-indigo-900">공정성 (Fairness)</h4>
      </div>
      <p class="text-sm text-gray-700 mb-2">AI 시스템이 특정 집단에 대한 차별 없이 공평하게 작동해야 함</p>
      <div class="bg-indigo-50 rounded-lg p-3 text-xs text-indigo-700">
        <p class="font-semibold mb-1">핵심 요건:</p>
        <p>편향 탐지·완화, 대표성 있는 데이터, 공정성 지표 측정</p>
        <p class="mt-1 text-indigo-500 italic">사례: Amazon 채용 AI 폐기, COMPAS 인종 편향</p>
      </div>
    </div>
    <div class="bg-white rounded-xl p-5 shadow-sm border-l-4 border-green-500">
      <div class="flex items-center gap-2 mb-3">
        <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">투</span>
        <h4 class="font-bold text-green-900">투명성 (Transparency)</h4>
      </div>
      <p class="text-sm text-gray-700 mb-2">AI의 의사결정 과정이 이해 가능하고 설명 가능해야 함</p>
      <div class="bg-green-50 rounded-lg p-3 text-xs text-green-700">
        <p class="font-semibold mb-1">핵심 요건:</p>
        <p>XAI 기술 적용, 모델 카드(Model Card) 공개, 알고리즘 감사</p>
        <p class="mt-1 text-green-500 italic">사례: EU GDPR 제22조 설명 요구권</p>
      </div>
    </div>
    <div class="bg-white rounded-xl p-5 shadow-sm border-l-4 border-purple-500">
      <div class="flex items-center gap-2 mb-3">
        <span class="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded">책</span>
        <h4 class="font-bold text-purple-900">책임성 (Accountability)</h4>
      </div>
      <p class="text-sm text-gray-700 mb-2">AI 시스템의 결과에 대해 명확한 책임 주체가 존재해야 함</p>
      <div class="bg-purple-50 rounded-lg p-3 text-xs text-purple-700">
        <p class="font-semibold mb-1">핵심 요건:</p>
        <p>거버넌스 체계, 감사 추적(Audit Trail), 이의 제기 절차</p>
        <p class="mt-1 text-purple-500 italic">사례: 자율주행차 사고 시 책임 소재 논쟁</p>
      </div>
    </div>
  </div>

  <!-- 글로벌 가이드라인 비교 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">🌍 주요 글로벌 AI 윤리 가이드라인 비교</h3>
  <div class="overflow-x-auto mb-6">
    <table class="w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">기관</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">발표 시기</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">핵심 내용</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">특징</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="p-3 border font-semibold">OECD</td><td class="p-3 border">2019.5</td><td class="p-3 border">AI 원칙 5개(포용적 성장, 인간 중심, 투명성, 안전성, 책임성)</td><td class="p-3 border">42개국 채택, 국제 표준 기반</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">EU HLEG</td><td class="p-3 border">2019.4</td><td class="p-3 border">신뢰할 수 있는 AI 7대 핵심 요건</td><td class="p-3 border">EU AI Act의 이론적 토대</td></tr>
        <tr><td class="p-3 border font-semibold">UNESCO</td><td class="p-3 border">2021.11</td><td class="p-3 border">AI 윤리 권고안(193개국 채택)</td><td class="p-3 border">최초의 글로벌 AI 윤리 표준</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">한국 정보통신부</td><td class="p-3 border">2020.12</td><td class="p-3 border">3대 원칙 10대 핵심 요건</td><td class="p-3 border">한국형 AI 윤리 프레임워크</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 한국 AI 윤리 기준 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">🇰🇷 한국 AI 윤리 기준: 3대 원칙과 10대 핵심 요건</h3>
  <div class="space-y-3 mb-6">
    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded">원칙 1</span>
          <span class="font-semibold text-gray-800">인간 존엄성 원칙</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <div class="grid grid-cols-3 gap-2 mt-3">
          <div class="bg-indigo-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-indigo-800">①인권 보장</p></div>
          <div class="bg-indigo-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-indigo-800">②프라이버시 보호</p></div>
          <div class="bg-indigo-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-indigo-800">③다양성 존중</p></div>
        </div>
      </div>
    </div>
    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">원칙 2</span>
          <span class="font-semibold text-gray-800">사회의 공공선 원칙</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-3">
          <div class="bg-green-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-green-800">④공공성</p></div>
          <div class="bg-green-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-green-800">⑤연대성</p></div>
          <div class="bg-green-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-green-800">⑥데이터 관리</p></div>
          <div class="bg-green-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-green-800">⑦책임성</p></div>
        </div>
      </div>
    </div>
    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded">원칙 3</span>
          <span class="font-semibold text-gray-800">기술의 합목적성 원칙</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <div class="grid grid-cols-3 gap-2 mt-3">
          <div class="bg-purple-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-purple-800">⑧안전성</p></div>
          <div class="bg-purple-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-purple-800">⑨투명성</p></div>
          <div class="bg-purple-50 rounded-lg p-3 text-center text-sm"><p class="font-bold text-purple-800">⑩설명 가능성</p></div>
        </div>
        <div class="mt-3 bg-yellow-50 rounded-lg p-3 text-sm text-yellow-800">
          <p class="font-semibold">💡 핵심 연결: ⑩설명 가능성 → 소문제 2 XAI와 직결</p>
        </div>
      </div>
    </div>
  </div>
</div><div id="xai" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">🔬 XAI(설명 가능한 AI) 기술</h2>

  <!-- XAI 정의 -->
  <div class="def-box mb-6">
    <p class="font-bold text-indigo-900 mb-1">XAI(eXplainable AI)</p>
    <p class="text-indigo-800">AI 모델의 의사결정 과정과 결과를 인간이 이해할 수 있는 형태로 설명하는 기술. 2016년 DARPA가 XAI 프로그램을 시작하면서 본격 연구 활성화.</p>
  </div>

  <!-- XAI 필요성 -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
    <div class="info-card indigo"><p class="font-bold text-indigo-800 mb-1">📋 규제 준수</p><p class="text-sm text-indigo-700">EU GDPR 제22조 — 자동화된 의사결정에 대한 설명 요구권</p></div>
    <div class="info-card green"><p class="font-bold text-green-800 mb-1">🤝 신뢰 확보</p><p class="text-sm text-green-700">의료·금융·법률 분야에서 AI 결과의 신뢰성 확보</p></div>
    <div class="info-card purple"><p class="font-bold text-purple-800 mb-1">🐛 디버깅</p><p class="text-sm text-purple-700">모델의 오류 원인 파악 및 편향 탐지</p></div>
    <div class="info-card amber"><p class="font-bold text-amber-800 mb-1">📈 개선</p><p class="text-sm text-amber-700">모델 성능 향상을 위한 피처 중요도 분석</p></div>
  </div>

  <!-- XAI 기법 분류 시각화 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">📊 XAI 기법 분류 체계</h3>
  <div class="overflow-x-auto mb-6">
    <table class="w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">분류 기준</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">유형 A</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">유형 B</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border border-indigo-200">LIME/SHAP</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="p-3 border font-semibold">적용 범위</td><td class="p-3 border">Global(전체 모델)</td><td class="p-3 border">Local(개별 예측)</td><td class="p-3 border bg-yellow-50 font-semibold">LIME: Local / SHAP: 둘 다</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">모델 의존성</td><td class="p-3 border">Model-agnostic</td><td class="p-3 border">Model-specific</td><td class="p-3 border bg-yellow-50 font-semibold">둘 다 Model-agnostic</td></tr>
        <tr><td class="p-3 border font-semibold">설명 시점</td><td class="p-3 border">Ante-hoc(사전)</td><td class="p-3 border">Post-hoc(사후)</td><td class="p-3 border bg-yellow-50 font-semibold">둘 다 Post-hoc</td></tr>
      </tbody>
    </table>
  </div>

  <!-- LIME 상세 -->
  <div class="tech-block mb-4">
    <div class="tech-header">
      <div class="flex items-center gap-3">
        <span class="bg-blue-100 text-blue-800 text-xs font-bold px-3 py-1 rounded-full">LIME</span>
        <span class="font-bold text-gray-800">Local Interpretable Model-agnostic Explanations (2016, Ribeiro et al.)</span>
      </div>
      <span class="chevron text-gray-400">▼</span>
    </div>
    <div class="tech-body">
      <p class="text-gray-700 mt-3 mb-3">개별 예측에 대해 해석 가능한 <strong>대리 모델(Surrogate Model)</strong>을 학습하여 설명을 제공</p>
      <!-- LIME 작동 원리 흐름도 -->
      <div class="flex flex-col md:flex-row items-center gap-2 mb-4">
        <div class="bg-blue-50 rounded-lg p-3 text-center flex-1 border border-blue-200">
          <p class="text-xs font-bold text-blue-800">① 섭동 샘플 생성</p>
          <p class="text-xs text-blue-600">x 주변에 다수 생성</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-blue-50 rounded-lg p-3 text-center flex-1 border border-blue-200">
          <p class="text-xs font-bold text-blue-800">② 블랙박스 예측</p>
          <p class="text-xs text-blue-600">각 샘플 예측값 계산</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-blue-50 rounded-lg p-3 text-center flex-1 border border-blue-200">
          <p class="text-xs font-bold text-blue-800">③ 가중치 부여</p>
          <p class="text-xs text-blue-600">x에 가까울수록 높은 가중치</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-blue-50 rounded-lg p-3 text-center flex-1 border border-blue-200">
          <p class="text-xs font-bold text-blue-800">④ 대리 모델 학습</p>
          <p class="text-xs text-blue-600">선형 회귀 등 간단한 모델</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-blue-50 rounded-lg p-3 text-center flex-1 border border-blue-200">
          <p class="text-xs font-bold text-blue-800">⑤ 피처 기여도</p>
          <p class="text-xs text-blue-600">대리 모델 계수로 설명</p>
        </div>
      </div>
      <div class="bg-slate-50 rounded-lg border p-3 text-sm font-mono">
        ξ(x) = argmin<sub>g∈G</sub> L(f, g, π<sub>x</sub>) + Ω(g)
      </div>
      <p class="text-xs text-gray-500 mt-2">f: 블랙박스 모델, g: 대리 모델, π<sub>x</sub>: x 근방 가중 함수, Ω(g): 복잡도 제약</p>
    </div>
  </div>

  <!-- SHAP 상세 -->
  <div class="tech-block mb-6">
    <div class="tech-header">
      <div class="flex items-center gap-3">
        <span class="bg-emerald-100 text-emerald-800 text-xs font-bold px-3 py-1 rounded-full">SHAP</span>
        <span class="font-bold text-gray-800">SHapley Additive exPlanations (2017, Lundberg &amp; Lee)</span>
      </div>
      <span class="chevron text-gray-400">▼</span>
    </div>
    <div class="tech-body">
      <p class="text-gray-700 mt-3 mb-3"><strong>게임 이론의 Shapley Value</strong>를 활용하여 각 피처의 기여도를 수학적으로 공정하게 분배</p>
      <div class="flex flex-col md:flex-row items-center gap-2 mb-4">
        <div class="bg-emerald-50 rounded-lg p-3 text-center flex-1 border border-emerald-200">
          <p class="text-xs font-bold text-emerald-800">① 모든 연합 조합</p>
          <p class="text-xs text-emerald-600">각 피처의 가능한 조합 고려</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-emerald-50 rounded-lg p-3 text-center flex-1 border border-emerald-200">
          <p class="text-xs font-bold text-emerald-800">② 한계 기여도</p>
          <p class="text-xs text-emerald-600">피처 있을 때 vs 없을 때 차이</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-emerald-50 rounded-lg p-3 text-center flex-1 border border-emerald-200">
          <p class="text-xs font-bold text-emerald-800">③ 평균 기여도</p>
          <p class="text-xs text-emerald-600">모든 순서에 대해 평균</p>
        </div>
        <span class="text-gray-400 text-xl hidden md:block">→</span>
        <div class="bg-emerald-50 rounded-lg p-3 text-center flex-1 border border-emerald-200">
          <p class="text-xs font-bold text-emerald-800">④ SHAP Value</p>
          <p class="text-xs text-emerald-600">수학적으로 공정한 분배</p>
        </div>
      </div>
      <div class="bg-slate-50 rounded-lg border p-3 text-sm font-mono">
        φ<sub>i</sub> = Σ<sub>S⊆N\{i}</sub> [|S|!(|N|-|S|-1)! / |N|!] × [f(S∪{i}) - f(S)]
      </div>
    </div>
  </div>

  <!-- LIME vs SHAP 비교표 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">⚔️ LIME vs SHAP 체계적 비교</h3>
  <div class="overflow-x-auto mb-6">
    <table class="w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="bg-gray-100 text-gray-900 p-3 text-left border">비교 기준</th>
          <th class="bg-blue-50 text-blue-900 p-3 text-left border">LIME</th>
          <th class="bg-emerald-50 text-emerald-900 p-3 text-left border">SHAP</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="p-3 border font-semibold">이론적 기반</td><td class="p-3 border">대리 모델(Surrogate)</td><td class="p-3 border">Shapley Value(게임 이론)</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">수학적 보장</td><td class="p-3 border">근사적(Approximate)</td><td class="p-3 border">이론적으로 공정한 분배 보장</td></tr>
        <tr><td class="p-3 border font-semibold">설명 범위</td><td class="p-3 border">Local(개별 예측)</td><td class="p-3 border">Local + Global</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">계산 복잡도</td><td class="p-3 border">상대적으로 빠름</td><td class="p-3 border">지수적 복잡도 (TreeSHAP으로 완화)</td></tr>
        <tr><td class="p-3 border font-semibold">일관성</td><td class="p-3 border">동일 데이터에 결과 변동 가능</td><td class="p-3 border">일관된 결과 보장</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">모델 의존성</td><td class="p-3 border">Model-agnostic</td><td class="p-3 border">Model-agnostic + Model-specific(TreeSHAP)</td></tr>
        <tr><td class="p-3 border font-semibold">시각화</td><td class="p-3 border">피처별 기여도 막대 그래프</td><td class="p-3 border">Force Plot, Summary Plot, Dependence Plot</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">장점</td><td class="p-3 border text-blue-700">직관적, 빠른 실행, 구현 간단</td><td class="p-3 border text-emerald-700">수학적 엄밀성, 일관성, 다양한 시각화</td></tr>
        <tr><td class="p-3 border font-semibold">단점</td><td class="p-3 border text-red-600">섭동 방식에 따라 결과 불안정</td><td class="p-3 border text-red-600">계산 비용 높음(TreeSHAP으로 완화)</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">적용 사례</td><td class="p-3 border">간단한 설명이 필요한 경우</td><td class="p-3 border">규제 준수, 감사 가능한 설명</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 실무 사례 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">🏢 실무 적용 사례</h3>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="info-card green">
      <p class="font-bold text-green-800 mb-2">🏦 카카오뱅크 대출 심사 AI (2023)</p>
      <p class="text-sm text-green-700 mb-1">AI 기반 신용 평가에 <strong>SHAP</strong> 적용</p>
      <p class="text-sm text-green-700">대출 거절 시 "소득 대비 부채 비율이 주요 요인"과 같은 구체적 거절 사유 제공</p>
      <p class="text-xs text-green-500 mt-1 italic">금융위원회 AI 신용평가 가이드라인 준수</p>
    </div>
    <div class="info-card indigo">
      <p class="font-bold text-indigo-800 mb-2">🏥 삼성서울병원 암 진단 AI (2024)</p>
      <p class="text-sm text-indigo-700 mb-1">폐암 진단 AI에 <strong>Grad-CAM + LIME</strong> 결합 적용</p>
      <p class="text-sm text-indigo-700">"이 부위의 이상 소견이 진단 근거"를 시각적으로 제시</p>
      <p class="text-xs text-indigo-500 mt-1 italic">AI 신뢰도: 도입 전 42% → 도입 후 78%</p>
    </div>
  </div>
</div><div id="euaiact" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">📋 EU AI Act 4단계 위험 기반 규제 체계</h2>

  <div class="def-box mb-6">
    <p class="font-bold text-indigo-900 mb-1">EU AI Act(인공지능법)</p>
    <p class="text-indigo-800"><strong>2024년 8월 1일 공식 발효</strong>된 세계 최초의 포괄적 AI 규제 법률. 위험 수준(Risk Level)에 따라 AI 시스템을 4단계로 분류하고, 위험이 높을수록 엄격한 의무를 부과하는 <strong>위험 기반 접근(Risk-based Approach)</strong> 채택.</p>
  </div>

  <!-- 위험 피라미드 시각화 -->
  <h3 class="font-bold text-gray-900 text-lg mb-4">🔺 4단계 위험 분류 피라미드</h3>
  <div class="max-w-lg mx-auto mb-8">
    <div class="text-center mb-2">
      <div class="bg-red-600 text-white rounded-t-xl px-6 py-4 mx-auto" style="max-width:200px;">
        <p class="font-black text-sm">🚫 금지 위험</p>
        <p class="text-xs opacity-90">Unacceptable Risk</p>
        <p class="text-xs opacity-75 mt-1">완전 금지</p>
      </div>
    </div>
    <div class="text-center mb-2">
      <div class="bg-orange-500 text-white px-8 py-4 mx-auto" style="max-width:320px;">
        <p class="font-black text-sm">⚠️ 고위험</p>
        <p class="text-xs opacity-90">High Risk</p>
        <p class="text-xs opacity-75 mt-1">엄격한 의무 (7대 요건)</p>
      </div>
    </div>
    <div class="text-center mb-2">
      <div class="bg-yellow-400 text-yellow-900 px-10 py-4 mx-auto" style="max-width:440px;">
        <p class="font-black text-sm">💬 제한 위험</p>
        <p class="text-xs">Limited Risk</p>
        <p class="text-xs opacity-75 mt-1">투명성 의무</p>
      </div>
    </div>
    <div class="text-center">
      <div class="bg-green-100 text-green-800 rounded-b-xl px-12 py-4 mx-auto border border-green-200" style="max-width:560px;">
        <p class="font-black text-sm">✅ 최소 위험</p>
        <p class="text-xs">Minimal Risk</p>
        <p class="text-xs opacity-75 mt-1">자유 사용 (의무 없음)</p>
      </div>
    </div>
  </div>

  <!-- 각 단계 상세 -->
  <div class="space-y-3 mb-6">
    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-red-100 text-red-800 text-xs font-bold px-2 py-1 rounded">1단계</span>
          <span class="font-bold text-gray-800">금지 위험(Unacceptable Risk) — 절대 금지</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <p class="text-gray-700 mt-3 mb-3">인간의 기본권을 심각하게 침해하는 AI 시스템 → EU 역내 <strong>완전 금지</strong></p>
        <table class="w-full border-collapse text-sm">
          <thead><tr><th class="bg-red-50 text-red-900 p-2 text-left border">금지 항목</th><th class="bg-red-50 text-red-900 p-2 text-left border">설명</th></tr></thead>
          <tbody>
            <tr><td class="p-2 border font-semibold">사회적 신용 평가 시스템</td><td class="p-2 border">중국식 사회 신용 점수 체계</td></tr>
            <tr class="bg-gray-50"><td class="p-2 border font-semibold">잠재의식 조작</td><td class="p-2 border">인식하지 못하는 방식의 행동 유도</td></tr>
            <tr><td class="p-2 border font-semibold">취약 계층 착취</td><td class="p-2 border">아동·장애인 등의 취약성 악용</td></tr>
            <tr class="bg-gray-50"><td class="p-2 border font-semibold">실시간 원격 생체 인식</td><td class="p-2 border">공공장소 실시간 안면 인식 감시</td></tr>
            <tr><td class="p-2 border font-semibold">감정 인식(직장·교육)</td><td class="p-2 border">직장·교육 현장 감정 추론 시스템</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-orange-100 text-orange-800 text-xs font-bold px-2 py-1 rounded">2단계</span>
          <span class="font-bold text-gray-800">고위험(High Risk) — 엄격한 의무 부과</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <p class="text-gray-700 mt-3 mb-3">안전·기본권에 중대한 영향 → <strong>사전 적합성 평가, 등록, 지속 모니터링</strong> 의무</p>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-4">
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">생체 인식</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">핵심 인프라</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">교육·직업</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">고용·인사</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">공공 서비스</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">법 집행</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">이민·국경</p></div>
          <div class="bg-orange-50 rounded-lg p-2 text-center text-xs border border-orange-200"><p class="font-bold text-orange-800">사법·민주주의</p></div>
        </div>
        <p class="font-semibold text-gray-800 mb-2">고위험 AI 7대 필수 요건 ("리데기로투인정")</p>
        <table class="w-full border-collapse text-sm">
          <thead><tr><th class="bg-orange-50 text-orange-900 p-2 text-left border">요건</th><th class="bg-orange-50 text-orange-900 p-2 text-left border">상세 내용</th></tr></thead>
          <tbody>
            <tr><td class="p-2 border font-semibold">리스크 관리 시스템</td><td class="p-2 border">전체 라이프사이클 리스크 식별·완화</td></tr>
            <tr class="bg-gray-50"><td class="p-2 border font-semibold">데이터 거버넌스</td><td class="p-2 border">학습 데이터 품질, 대표성, 편향 관리</td></tr>
            <tr><td class="p-2 border font-semibold">기술 문서화</td><td class="p-2 border">설계, 학습 과정, 성능 지표 문서화</td></tr>
            <tr class="bg-gray-50"><td class="p-2 border font-semibold">로깅(Logging)</td><td class="p-2 border">자동 로그 기록으로 추적 가능성 확보</td></tr>
            <tr><td class="p-2 border font-semibold">투명성·정보 제공</td><td class="p-2 border">사용자에게 AI 시스템임을 고지</td></tr>
            <tr class="bg-gray-50"><td class="p-2 border font-semibold">인간 감독(Human Oversight)</td><td class="p-2 border">인간이 AI 결과를 검토·개입할 수 있는 체계</td></tr>
            <tr><td class="p-2 border font-semibold">정확성·견고성·사이버보안</td><td class="p-2 border">적절한 정확도, 적대적 공격 방어</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-1 rounded">3단계</span>
          <span class="font-bold text-gray-800">제한 위험(Limited Risk) — 투명성 의무</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <p class="text-gray-700 mt-3 mb-3">사용자와 직접 상호작용하는 AI → <strong>AI와 상호작용 중임을 고지</strong> 의무</p>
        <div class="grid grid-cols-2 gap-3">
          <div class="bg-yellow-50 rounded-lg p-3 border border-yellow-200"><p class="font-semibold text-yellow-800 text-sm">챗봇(Chatbot)</p><p class="text-xs text-yellow-700">AI와 대화 중임을 명시</p></div>
          <div class="bg-yellow-50 rounded-lg p-3 border border-yellow-200"><p class="font-semibold text-yellow-800 text-sm">딥페이크(Deepfake)</p><p class="text-xs text-yellow-700">AI로 생성된 콘텐츠임을 표시</p></div>
          <div class="bg-yellow-50 rounded-lg p-3 border border-yellow-200"><p class="font-semibold text-yellow-800 text-sm">감정 인식 시스템</p><p class="text-xs text-yellow-700">감정 인식 작동 중 고지</p></div>
          <div class="bg-yellow-50 rounded-lg p-3 border border-yellow-200"><p class="font-semibold text-yellow-800 text-sm">바이오메트릭 분류</p><p class="text-xs text-yellow-700">생체 인식 분류 수행 중 고지</p></div>
        </div>
      </div>
    </div>

    <div class="tech-block">
      <div class="tech-header">
        <div class="flex items-center gap-3">
          <span class="bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded">4단계</span>
          <span class="font-bold text-gray-800">최소 위험(Minimal Risk) — 의무 없음</span>
        </div>
        <span class="chevron text-gray-400">▼</span>
      </div>
      <div class="tech-body">
        <p class="text-gray-700 mt-3">대부분의 AI 시스템(스팸 필터, 게임 AI, AI 검색 등). 특별한 규제 의무 없이 자유 사용. 자발적 행동 강령(Code of Conduct) 준수 권장.</p>
      </div>
    </div>
  </div>

  <!-- 제재 규정 -->
  <h3 class="font-bold text-gray-900 text-lg mb-3">💰 주요 제재 규정</h3>
  <div class="overflow-x-auto mb-6">
    <table class="w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="bg-red-50 text-red-900 p-3 text-left border">위반 유형</th>
          <th class="bg-red-50 text-red-900 p-3 text-left border">최대 과징금</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="p-3 border font-semibold">금지 AI 시스템 운영</td><td class="p-3 border text-red-700 font-bold">전 세계 연매출 7% 또는 3,500만 유로</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">고위험 AI 의무 위반</td><td class="p-3 border text-orange-700 font-bold">전 세계 연매출 3% 또는 1,500만 유로</td></tr>
        <tr><td class="p-3 border font-semibold">정보 제공 의무 위반</td><td class="p-3 border text-yellow-700 font-bold">전 세계 연매출 1.5% 또는 750만 유로</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 연관 이론 -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="info-card indigo">
      <p class="font-bold text-indigo-800 mb-1">🔗 GDPR과의 관계</p>
      <p class="text-sm text-indigo-700">EU AI Act는 GDPR의 AI 버전. GDPR이 개인정보를 보호한다면, AI Act는 AI 시스템의 안전성·투명성 보장. GDPR 제22조가 XAI의 법적 근거.</p>
    </div>
    <div class="info-card green">
      <p class="font-bold text-green-800 mb-1">🏛️ ISO/IEC 42001</p>
      <p class="text-sm text-green-700">2023년 발표된 AI 관리 시스템 국제 표준. EU AI Act 고위험 AI 요건 준수를 위한 관리 프레임워크로 활용.</p>
    </div>
  </div>
</div><div id="textbook" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">📖 원문 학습 — 제1부 상세 해설</h2>
  <div class="textbook-content">

    <div class="insight-box mb-4">
      <p class="font-bold text-purple-800 mb-1">📋 2교시형 문제 구조 분석</p>
      <p class="text-sm text-purple-700">이 문제는 3개의 소문제로 구성되어 있으며, 소문제 간에 <strong>원칙 → 기술 → 제도</strong>의 논리적 연결이 존재한다.</p>
      <p class="text-sm text-purple-700 mt-1">• 소문제 1: AI 윤리 가이드라인의 3대 원칙과 핵심 요건 (윤리적 기반)</p>
      <p class="text-sm text-purple-700">• 소문제 2: XAI의 개념 및 LIME, SHAP 모델 비교 (기술적 구현)</p>
      <p class="text-sm text-purple-700">• 소문제 3: EU AI Act의 4단계 위험 기반 규제 체계 (법적 제도)</p>
    </div>

    <h3>제1장 보편적 AI 윤리 가이드라인의 3대 원칙과 핵심 요건 (소문제 1)</h3>

    <h4>1.1 AI 윤리 논의의 배경</h4>
    <p>AI가 채용, 대출 심사, 사법 판결, 의료 진단 등 인간의 핵심 의사결정 영역에 도입됨에 따라, <strong>편향(Bias)</strong>, <strong>불투명성(Opacity)</strong>, <strong>책임 소재 불명확(Accountability Gap)</strong> 등의 윤리적 문제가 심화되고 있다.</p>
    <p>2018년 Amazon의 AI 채용 시스템이 여성 지원자를 체계적으로 불이익 처리한 사실이 드러나 폐기된 사건, 2019년 미국 COMPAS 알고리즘이 흑인 재범 가능성을 과대 예측한 사건 등이 대표적이다.</p>
    <p>이러한 배경에서 OECD, EU, UNESCO, 한국 정부 등이 AI 윤리 가이드라인을 발표하였으며, 이를 종합하면 <strong>3대 핵심 원칙</strong>으로 수렴한다.</p>

    <h4>1.2 AI 윤리 3대 원칙</h4>
    <table>
      <thead><tr><th>원칙</th><th>정의</th><th>핵심 요건</th><th>관련 사례</th></tr></thead>
      <tbody>
        <tr><td><strong>공정성(Fairness)</strong></td><td>AI 시스템이 특정 집단에 대한 차별 없이 공평하게 작동해야 함</td><td>편향 탐지·완화, 대표성 있는 데이터, 공정성 지표 측정</td><td>Amazon 채용 AI 폐기, COMPAS 인종 편향</td></tr>
        <tr><td><strong>투명성(Transparency)</strong></td><td>AI의 의사결정 과정이 이해 가능하고 설명 가능해야 함</td><td>XAI 기술 적용, 모델 카드 공개, 알고리즘 감사</td><td>EU GDPR 자동화된 의사결정 설명 요구권 (제22조)</td></tr>
        <tr><td><strong>책임성(Accountability)</strong></td><td>AI 시스템의 결과에 대해 명확한 책임 주체가 존재해야 함</td><td>거버넌스 체계, 감사 추적(Audit Trail), 이의 제기 절차</td><td>자율주행차 사고 시 책임 소재 논쟁</td></tr>
      </tbody>
    </table>

    <h4>1.3 주요 글로벌 AI 윤리 가이드라인 비교</h4>
    <table>
      <thead><tr><th>기관</th><th>발표 시기</th><th>핵심 내용</th><th>특징</th></tr></thead>
      <tbody>
        <tr><td><strong>OECD</strong></td><td>2019.5</td><td>AI 원칙 5개(포용적 성장, 인간 중심, 투명성, 안전성, 책임성)</td><td>42개국 채택, 국제 표준의 기반</td></tr>
        <tr><td><strong>EU HLEG</strong></td><td>2019.4</td><td>신뢰할 수 있는 AI 7대 핵심 요건</td><td>EU AI Act의 이론적 토대</td></tr>
        <tr><td><strong>UNESCO</strong></td><td>2021.11</td><td>AI 윤리 권고안(193개국 채택)</td><td>최초의 글로벌 AI 윤리 표준</td></tr>
        <tr><td><strong>한국 정보통신부</strong></td><td>2020.12</td><td>사람이 중심이 되는 AI 윤리 기준 3대 원칙 10대 핵심 요건</td><td>한국형 AI 윤리 프레임워크</td></tr>
      </tbody>
    </table>

    <h4>1.4 한국 AI 윤리 기준의 3대 원칙과 10대 핵심 요건</h4>
    <p>한국 정부가 2020년 발표한 AI 윤리 기준은 3대 원칙과 10대 핵심 요건으로 구성된다.</p>
    <table>
      <thead><tr><th>원칙</th><th>핵심 요건</th></tr></thead>
      <tbody>
        <tr><td><strong>인간 존엄성 원칙</strong></td><td>①인권 보장 ②프라이버시 보호 ③다양성 존중</td></tr>
        <tr><td><strong>사회의 공공선 원칙</strong></td><td>④공공성 ⑤연대성 ⑥데이터 관리 ⑦책임성</td></tr>
        <tr><td><strong>기술의 합목적성 원칙</strong></td><td>⑧안전성 ⑨투명성 ⑩설명 가능성</td></tr>
      </tbody>
    </table>

    <h3>제2장 XAI(Explainable AI)의 개념 및 LIME, SHAP 비교 (소문제 2)</h3>

    <h4>2.1 XAI의 개요</h4>
    <div class="def-box">
      <p class="text-indigo-800"><strong>XAI(eXplainable Artificial Intelligence)</strong>란, AI 모델의 의사결정 과정과 결과를 인간이 이해할 수 있는 형태로 설명하는 기술이다. 2016년 DARPA(미국 국방고등연구계획국)가 XAI 프로그램을 시작하면서 본격적으로 연구가 활성화되었다.</p>
    </div>
    <p><strong>XAI의 필요성</strong>:</p>
    <table>
      <thead><tr><th>관점</th><th>필요성</th></tr></thead>
      <tbody>
        <tr><td><strong>규제 준수</strong></td><td>EU GDPR 제22조 — 자동화된 의사결정에 대한 설명 요구권</td></tr>
        <tr><td><strong>신뢰 확보</strong></td><td>의료·금융·법률 분야에서 AI 결과의 신뢰성 확보</td></tr>
        <tr><td><strong>디버깅</strong></td><td>모델의 오류 원인 파악 및 편향 탐지</td></tr>
        <tr><td><strong>개선</strong></td><td>모델 성능 향상을 위한 피처 중요도 분석</td></tr>
      </tbody>
    </table>

    <h4>2.2 XAI 기법 분류</h4>
    <table>
      <thead><tr><th>분류 기준</th><th>유형</th></tr></thead>
      <tbody>
        <tr><td><strong>적용 범위</strong></td><td>Global(전체 모델) vs Local(개별 예측)</td></tr>
        <tr><td><strong>모델 의존성</strong></td><td>Model-agnostic vs Model-specific</td></tr>
        <tr><td><strong>설명 시점</strong></td><td>Ante-hoc(사전) vs Post-hoc(사후)</td></tr>
      </tbody>
    </table>
    <p>LIME과 SHAP은 모두 <strong>Post-hoc, Model-agnostic</strong> 기법으로, 이미 학습된 블랙박스 모델에 대해 사후적으로 설명을 제공하며, 모델 종류에 관계없이 적용 가능하다.</p>

    <h4>2.3 LIME(Local Interpretable Model-agnostic Explanations)</h4>
    <p>LIME은 2016년 Ribeiro et al.이 제안한 기법으로, <strong>개별 예측에 대해 해석 가능한 대리 모델(Surrogate Model)을 학습</strong>하여 설명을 제공한다.</p>
    <p><strong>작동 원리</strong>:</p>
    <ol>
      <li>설명하려는 데이터 포인트 x 주변에 <strong>섭동(Perturbation)된 샘플</strong>을 다수 생성</li>
      <li>원본 블랙박스 모델로 각 섭동 샘플의 예측값을 구함</li>
      <li>x에 가까운 샘플에 더 높은 <strong>가중치</strong>를 부여</li>
      <li>가중 샘플로 <strong>해석 가능한 간단한 모델(선형 회귀 등)</strong>을 학습</li>
      <li>대리 모델의 계수를 통해 <strong>각 피처의 기여도</strong>를 설명</li>
    </ol>
    <p><strong>수식</strong>:</p>
    <pre class="bg-slate-50 rounded-lg border p-4 text-sm"><code>ξ(x) = argmin_{g∈G} L(f, g, π_x) + Ω(g)

f: 원본 블랙박스 모델
g: 대리 모델
π_x: x 근방의 가중 함수
Ω(g): 대리 모델의 복잡도 제약</code></pre>

    <h4>2.4 SHAP(SHapley Additive exPlanations)</h4>
    <p>SHAP은 2017년 Lundberg &amp; Lee가 제안한 기법으로, <strong>게임 이론의 Shapley Value를 활용하여 각 피처의 기여도를 수학적으로 공정하게 분배</strong>하는 방법이다.</p>
    <p><strong>Shapley Value의 핵심 개념</strong>: N명의 플레이어가 협력하여 얻은 이익을 각 플레이어의 <strong>한계 기여도(Marginal Contribution)</strong>에 따라 공정하게 분배하는 게임 이론적 해법이다.</p>
    <p><strong>작동 원리</strong>:</p>
    <ol>
      <li>각 피처의 가능한 모든 <strong>연합(Coalition)</strong> 조합을 고려</li>
      <li>특정 피처가 있을 때와 없을 때의 <strong>예측값 차이(한계 기여도)</strong>를 계산</li>
      <li>모든 가능한 순서에 대해 <strong>평균 한계 기여도</strong>를 산출</li>
      <li>이것이 해당 피처의 <strong>SHAP Value</strong></li>
    </ol>
    <p><strong>수식</strong>:</p>
    <pre class="bg-slate-50 rounded-lg border p-4 text-sm"><code>φ_i = Σ_{S⊆N\{i}} [|S|!(|N|-|S|-1)! / |N|!] × [f(S∪{i}) - f(S)]</code></pre>
    <h4>2.5 LIME vs SHAP 체계적 비교</h4>
    <table>
      <thead><tr><th>비교 기준</th><th>LIME</th><th>SHAP</th></tr></thead>
      <tbody>
        <tr><td><strong>이론적 기반</strong></td><td>대리 모델(Surrogate)</td><td>Shapley Value(게임 이론)</td></tr>
        <tr><td><strong>수학적 보장</strong></td><td>근사적(Approximate)</td><td>이론적으로 공정한 분배 보장</td></tr>
        <tr><td><strong>설명 범위</strong></td><td>Local(개별 예측)</td><td>Local + Global</td></tr>
        <tr><td><strong>계산 복잡도</strong></td><td>상대적으로 빠름</td><td>지수적 복잡도 (근사 알고리즘 사용)</td></tr>
        <tr><td><strong>일관성</strong></td><td>동일 데이터에 대해 결과 변동 가능</td><td>일관된 결과 보장</td></tr>
        <tr><td><strong>모델 의존성</strong></td><td>Model-agnostic</td><td>Model-agnostic + Model-specific(TreeSHAP)</td></tr>
        <tr><td><strong>시각화</strong></td><td>피처별 기여도 막대 그래프</td><td>Force Plot, Summary Plot, Dependence Plot</td></tr>
        <tr><td><strong>장점</strong></td><td>직관적, 빠른 실행, 구현 간단</td><td>수학적 엄밀성, 일관성, 다양한 시각화</td></tr>
        <tr><td><strong>단점</strong></td><td>섭동 방식에 따라 결과 불안정</td><td>계산 비용 높음(TreeSHAP으로 완화)</td></tr>
        <tr><td><strong>적용 사례</strong></td><td>간단한 설명이 필요한 경우</td><td>규제 준수, 감사 가능한 설명이 필요한 경우</td></tr>
      </tbody>
    </table>

    <h4>2.6 실무 적용 사례</h4>
    <p><strong>사례 1: 카카오뱅크 대출 심사 AI(2023)</strong>: 카카오뱅크는 AI 기반 신용 평가 모델에 SHAP을 적용하여, 대출 거절 시 고객에게 "소득 대비 부채 비율이 주요 요인"과 같은 구체적 거절 사유를 제공하고 있다. 금융위원회의 AI 신용평가 가이드라인 준수를 위해 도입하였다.</p>
    <p><strong>사례 2: 삼성서울병원 암 진단 AI(2024)</strong>: 삼성서울병원은 폐암 진단 AI 모델에 Grad-CAM과 LIME을 결합 적용하여, 의사에게 "이 부위의 이상 소견이 진단 근거"임을 시각적으로 제시한다. 의료진의 AI 신뢰도가 도입 전 42%에서 78%로 향상되었다.</p>

    <h3>제3장 EU AI Act의 4단계 위험 기반 규제 체계 (소문제 3)</h3>

    <h4>3.1 EU AI Act 개요</h4>
    <div class="def-box">
      <p class="text-indigo-800"><strong>EU AI Act(인공지능법)</strong>는 2024년 8월 1일 공식 발효된 세계 최초의 포괄적 AI 규제 법률이다. EU 의회에서 2024년 3월 최종 승인되었으며, 2026년 8월부터 완전 시행된다.</p>
    </div>
    <p><strong>핵심 특징</strong>: 위험 수준(Risk Level)에 따라 AI 시스템을 4단계로 분류하고, 위험이 높을수록 엄격한 의무를 부과하는 <strong>위험 기반 접근(Risk-based Approach)</strong>을 채택하였다.</p>

    <h4>3.2 4단계 위험 분류 체계</h4>
    <!-- 피라미드는 HTML/CSS 시각화로 표현 -->
    <div class="max-w-md mx-auto my-6">
      <div class="text-center mb-1"><div class="bg-red-600 text-white rounded-t-lg px-4 py-3 mx-auto inline-block font-bold text-sm">▲ 금지 (Unacceptable Risk)</div></div>
      <div class="text-center mb-1"><div class="bg-orange-500 text-white px-6 py-3 mx-auto inline-block font-bold text-sm">고위험 (High Risk)</div></div>
      <div class="text-center mb-1"><div class="bg-yellow-400 text-yellow-900 px-8 py-3 mx-auto inline-block font-bold text-sm">제한 위험 (Limited Risk)</div></div>
      <div class="text-center"><div class="bg-green-100 text-green-800 rounded-b-lg px-10 py-3 mx-auto inline-block font-bold text-sm border border-green-200">최소 위험 (Minimal Risk)</div></div>
    </div>

    <h4>3.3 각 단계 상세</h4>
    <p><strong>[1단계] 금지 위험(Unacceptable Risk)</strong> — 절대 금지</p>
    <p>인간의 기본권을 심각하게 침해하는 AI 시스템으로, EU 역내에서 완전 금지된다.</p>
    <table>
      <thead><tr><th>금지 항목</th><th>설명</th></tr></thead>
      <tbody>
        <tr><td><strong>사회적 신용 평가 시스템</strong></td><td>중국식 사회 신용 점수 체계</td></tr>
        <tr><td><strong>잠재의식 조작(Subliminal Manipulation)</strong></td><td>인식하지 못하는 방식의 행동 유도</td></tr>
        <tr><td><strong>취약 계층 착취</strong></td><td>아동·장애인 등의 취약성을 악용하는 AI</td></tr>
        <tr><td><strong>실시간 원격 생체 인식(법 집행용)</strong></td><td>공공장소에서의 실시간 안면 인식 감시 (예외적 허용)</td></tr>
        <tr><td><strong>감정 인식(직장·교육)</strong></td><td>직장·교육 현장에서의 감정 추론 시스템</td></tr>
      </tbody>
    </table>

    <p><strong>[2단계] 고위험(High Risk)</strong> — 엄격한 의무 부과</p>
    <p>안전이나 기본권에 중대한 영향을 미치는 AI 시스템으로, 사전 적합성 평가, 등록, 지속 모니터링 의무가 부과된다.</p>
    <table>
      <thead><tr><th>고위험 분야</th><th>예시</th></tr></thead>
      <tbody>
        <tr><td><strong>생체 인식 및 분류</strong></td><td>원격 생체 인식(비실시간)</td></tr>
        <tr><td><strong>핵심 인프라 관리</strong></td><td>에너지, 교통, 수도 관리 AI</td></tr>
        <tr><td><strong>교육·직업 훈련</strong></td><td>시험 채점, 학생 선발 AI</td></tr>
        <tr><td><strong>고용·인사 관리</strong></td><td>채용 스크리닝, 성과 평가 AI</td></tr>
        <tr><td><strong>공공 서비스 접근</strong></td><td>복지 수급 자격 판정, 신용 평가</td></tr>
        <tr><td><strong>법 집행</strong></td><td>범죄 예측, 증거 분석</td></tr>
        <tr><td><strong>이민·국경 관리</strong></td><td>비자 심사, 망명 신청 평가</td></tr>
        <tr><td><strong>사법·민주주의</strong></td><td>판결 지원, 선거 관련 AI</td></tr>
      </tbody>
    </table>

    <p><strong>고위험 AI 시스템의 필수 요건</strong>:</p>
    <table>
      <thead><tr><th>요건</th><th>상세 내용</th></tr></thead>
      <tbody>
        <tr><td><strong>리스크 관리 시스템</strong></td><td>전체 라이프사이클에 걸친 리스크 식별·완화</td></tr>
        <tr><td><strong>데이터 거버넌스</strong></td><td>학습 데이터의 품질, 대표성, 편향 관리</td></tr>
        <tr><td><strong>기술 문서화</strong></td><td>시스템 설계, 학습 과정, 성능 지표 문서화</td></tr>
        <tr><td><strong>로깅(Logging)</strong></td><td>자동 로그 기록으로 추적 가능성 확보</td></tr>
        <tr><td><strong>투명성·정보 제공</strong></td><td>사용자에게 AI 시스템임을 고지</td></tr>
        <tr><td><strong>인간 감독(Human Oversight)</strong></td><td>인간이 AI 결과를 검토·개입할 수 있는 체계</td></tr>
        <tr><td><strong>정확성·견고성·사이버보안</strong></td><td>적절한 수준의 정확도, 적대적 공격 방어</td></tr>
      </tbody>
    </table>

    <p><strong>[3단계] 제한 위험(Limited Risk)</strong> — 투명성 의무</p>
    <p>사용자와 직접 상호작용하는 AI 시스템으로, 사용자에게 AI와 상호작용 중임을 고지해야 한다.</p>
    <table>
      <thead><tr><th>대상 시스템</th><th>투명성 의무</th></tr></thead>
      <tbody>
        <tr><td><strong>챗봇(Chatbot)</strong></td><td>AI와 대화 중임을 명시</td></tr>
        <tr><td><strong>딥페이크(Deepfake)</strong></td><td>AI로 생성된 콘텐츠임을 표시</td></tr>
        <tr><td><strong>감정 인식 시스템</strong></td><td>감정 인식이 작동 중임을 고지</td></tr>
        <tr><td><strong>바이오메트릭 분류</strong></td><td>생체 인식 기반 분류를 수행 중임을 고지</td></tr>
      </tbody>
    </table>

    <p><strong>[4단계] 최소 위험(Minimal Risk)</strong> — 의무 없음</p>
    <p>대부분의 AI 시스템(스팸 필터, 게임 AI, AI 검색 등)이 해당하며, 특별한 규제 의무 없이 자유롭게 사용 가능하다. 다만 자발적 행동 강령(Code of Conduct) 준수를 권장한다.</p>

    <h4>3.4 EU AI Act 주요 제재 규정</h4>
    <table>
      <thead><tr><th>위반 유형</th><th>최대 과징금</th></tr></thead>
      <tbody>
        <tr><td><strong>금지 AI 시스템 운영</strong></td><td>전 세계 연매출 7% 또는 3,500만 유로 중 높은 금액</td></tr>
        <tr><td><strong>고위험 AI 의무 위반</strong></td><td>전 세계 연매출 3% 또는 1,500만 유로 중 높은 금액</td></tr>
        <tr><td><strong>정보 제공 의무 위반</strong></td><td>전 세계 연매출 1.5% 또는 750만 유로 중 높은 금액</td></tr>
      </tbody>
    </table>

    <h4>3.5 연관 이론 연결</h4>
    <p><strong>GDPR과의 관계</strong>: EU AI Act는 GDPR(2018)의 AI 버전으로, GDPR이 개인정보를 보호한다면 AI Act는 AI 시스템의 안전성과 투명성을 보장한다. GDPR 제22조(자동화된 의사결정에 대한 설명 요구권)가 XAI의 법적 근거이며, AI Act는 이를 더 구체화한 것이다.</p>
    <p><strong>ISO/IEC 42001(AI 관리 시스템)</strong>: 2023년 발표된 AI 관리 시스템 국제 표준으로, EU AI Act의 고위험 AI 요건을 준수하기 위한 관리 프레임워크로 활용될 수 있다.</p>

    <h3>소문제 간 통합 분석</h3>
    <table>
      <thead><tr><th>관점</th><th>소문제 1</th><th>소문제 2</th><th>소문제 3</th></tr></thead>
      <tbody>
        <tr><td><strong>층위</strong></td><td>윤리적 원칙</td><td>기술적 구현</td><td>법적 강제</td></tr>
        <tr><td><strong>핵심 질문</strong></td><td>AI가 따라야 할 원칙은?</td><td>투명성을 어떻게 구현?</td><td>원칙을 어떻게 법으로 강제?</td></tr>
        <tr><td><strong>핵심 개념</strong></td><td>공정성·투명성·책임성</td><td>LIME·SHAP</td><td>4단계 위험 분류</td></tr>
        <tr><td><strong>연결 고리</strong></td><td>투명성 원칙 →</td><td>XAI가 기술적 해법 →</td><td>AI Act가 법적 의무화</td></tr>
      </tbody>
    </table>
    <p>결론적으로, AI의 <strong>윤리적 원칙(소문제 1)</strong>을 <strong>기술적으로 구현(소문제 2: XAI)</strong>하고, <strong>법적으로 강제(소문제 3: EU AI Act)</strong>하는 삼층 거버넌스 체계가 2026년부터 본격화된다.</p>

  </div>
</div><div id="script" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">🎬 강의 스크립트 <span class="text-sm font-normal text-amber-600">(멘토 전용)</span></h2>
  <div class="bg-amber-50 border border-amber-200 rounded-xl p-6 space-y-4 text-gray-800 leading-relaxed">

    <p>안녕하세요, 여러분. 오늘은 2026년 기술사 시험에서 가장 뜨거운 토픽 중 하나를 다뤄볼 건데요. AI 윤리, XAI, 그리고 EU AI Act입니다. 이 세 가지가 왜 한 세트로 묶이는지, 그리고 왜 지금 시점에서 중요한지를 오늘 20분 안에 확실하게 잡아드리겠습니다.</p>

    <p>왜 뜨겁냐면, EU AI Act가 2024년 8월에 발효되었고 2026년 8월부터 완전 시행되거든요. 시험 출제 시점과 딱 맞아떨어져요. 출제위원 입장에서 이걸 안 내기가 오히려 어렵다고 봐야 합니다. 게다가 한국에서도 AI 기본법 논의가 한창 진행 중이고, 금융위원회가 AI 신용평가 가이드라인을 발표하는 등 AI 규제가 실무에 직접 영향을 미치기 시작했거든요.</p>

    <p>이 문제의 소문제 구조를 먼저 잡아볼게요. 소문제 1은 "AI가 어떤 원칙을 따라야 하느냐"는 윤리적 기반이에요. 소문제 2는 "그 원칙 중 투명성을 기술적으로 어떻게 구현하느냐"는 XAI 이야기고요. 소문제 3은 "이걸 법적으로 어떻게 강제하느냐"는 EU AI Act입니다. 정리하면 <span class="highlight">"원칙 → 기술 → 제도"</span>의 삼층 구조예요.</p>

    <p>소문제 1, AI 윤리 3대 원칙부터 갈게요. <span class="highlight">"공투책"</span>으로 외우세요. 공정성(Fairness), 투명성(Transparency), 책임성(Accountability). 이 세 가지가 OECD, EU, UNESCO, 한국 정부의 가이드라인을 종합하면 수렴하는 핵심 원칙이에요.</p>

    <p>각 원칙에 대해 구체적 사례를 반드시 넣어야 해요. 공정성하면 2018년 Amazon의 채용 AI가 대표적이에요. AI가 10년간의 이력서 데이터를 학습했는데, IT 업계 특성상 남성 이력서가 압도적으로 많았거든요. 그 결과 AI가 "여성"이라는 키워드가 포함된 이력서에 불이익을 줬어요. 또 하나는 COMPAS 알고리즘이에요. 미국 사법부에서 재범 가능성을 예측하는 AI인데, 흑인의 재범 가능성을 체계적으로 과대 예측한 것으로 드러났어요.</p>

    <p>한국 AI 윤리 기준도 꼭 언급하세요. 2020년에 발표된 건데, 3대 원칙(인간 존엄성, 사회 공공선, 기술 합목적성)과 10대 핵심 요건으로 구성돼 있어요. 특히 <span class="highlight">"설명 가능성"</span>이라는 요건이 포함되어 있다는 점이 중요해요. 이게 바로 소문제 2의 XAI와 직결되거든요.</p>

    <p>소문제 2, XAI(설명 가능한 AI)입니다. 이 토픽이 소문제 중 가장 비중이 커요. 30% 정도 배분하세요. XAI는 한 마디로 "AI가 왜 이런 결정을 내렸는지 사람이 이해할 수 있게 설명하는 기술"이에요.</p>

    <p>LIME과 SHAP을 비교하는 게 핵심인데요, 둘 다 Post-hoc이고 Model-agnostic이라는 공통점이 있어요. 하지만 접근 방식이 완전히 달라요.</p>

    <p><span class="highlight">LIME</span>은 "대리 모델" 방식이에요. 설명하고 싶은 데이터 포인트 주변에 여러 개의 가짜 데이터를 만들고, 원래 모델로 예측한 다음에, 그 근방에서 간단한 선형 모델을 학습시켜요. 장점은 빠르고 직관적이라는 거고, 단점은 섭동 방식에 따라 결과가 달라질 수 있다는 불안정성이에요.</p>

    <p><span class="highlight">SHAP</span>은 게임 이론의 Shapley Value를 활용해요. 각 피처를 "게임의 플레이어"로 보고, "이 플레이어가 있을 때와 없을 때 결과가 얼마나 달라지는지"를 모든 가능한 조합에 대해 계산하는 거예요. 수학적으로 공정한 분배가 보장되는 게 SHAP의 최대 강점이에요. 답안에 비교표를 반드시 넣으세요. 최소 6개 기준으로 비교하면 됩니다.</p>

    <p>실무 사례도 중요해요. 카카오뱅크가 대출 심사에 SHAP을 적용해서 대출 거절 사유를 고객에게 설명하고 있고, 삼성서울병원이 암 진단 AI에 LIME을 적용해서 의사에게 진단 근거를 시각적으로 보여주고 있어요. AI 신뢰도가 42%에서 78%로 뛰었다는 구체적 수치를 답안에 쓰면 확실히 차별화가 됩니다.</p>

    <p>소문제 3, EU AI Act입니다. 이건 <span class="highlight">"금고제최"</span>로 외우세요. 금지-고위험-제한-최소. 4단계 위험 기반 규제인데, 답안에 반드시 <span class="highlight">피라미드 도식</span>을 그려야 해요.</p>

    <p>과징금도 꼭 쓰세요. 금지 AI 운영 시 전 세계 연매출 7% 또는 3,500만 유로. GDPR의 4%보다 높은 거예요. 고위험 AI의 7대 필수 요건도 <span class="highlight">"리데기로투인정"</span>으로 외우시면 돼요. 리스크 관리, 데이터 거버넌스, 기술 문서화, 로깅, 투명성, 인간 감독, 정확성·견고성·보안.</p>

    <p>결론에서는 세 소문제를 통합해서 "윤리 원칙을 XAI로 기술적으로 구현하고, EU AI Act로 법적으로 강제하는 삼층 거버넌스 체계가 2026년부터 본격화된다"라고 정리하세요. 분량 배분은 서론 10%, 소문제 1이 25%, 소문제 2가 30%, 소문제 3이 25%, 결론 10%입니다. 필수 도식은 세 가지: EU AI Act 위험 피라미드, LIME vs SHAP 비교표, AI 윤리 3대 원칙 표. 여러분, 이 구조만 확실히 잡으면 이 문제는 자신 있게 쓸 수 있습니다!</p>

  </div>
</div><div id="quiz" class="hidden">
  <h2 class="text-2xl font-black text-gray-900 mb-6">🧠 퀴즈 &amp; 암기</h2>

  <!-- AI 실전 퀴즈 영역 -->
  <div class="bg-indigo-50 rounded-xl p-6 border border-indigo-100 mb-8">
    <div class="flex items-center justify-between mb-4">
      <h3 class="font-bold text-indigo-900 text-lg flex items-center"><span class="mr-2">🧠</span> AI 실전 문제 생성</h3>
      <button onclick="generateQuiz()" id="btn-quiz-gen" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm transition-colors flex items-center gap-2"><span>✨ 새로운 문제 생성</span></button>
    </div>
    <div id="quiz-loading" class="hidden py-8 text-center">
      <div class="typing-indicator flex justify-center mb-2"><span></span><span></span><span></span></div>
      <p class="text-indigo-600 text-sm">AI가 문제를 출제하고 있습니다...</p>
    </div>
    <div id="quiz-container" class="hidden space-y-4">
      <div class="bg-white p-5 rounded-lg shadow-sm border border-indigo-100">
        <div class="flex items-start gap-2 mb-4">
          <span id="quiz-type-badge" class="bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded whitespace-nowrap mt-1">객관식</span>
          <p id="quiz-question" class="font-bold text-gray-800 text-lg"></p>
        </div>
        <div id="quiz-options" class="space-y-2"></div>
        <div id="quiz-input-area" class="hidden mt-4">
          <div class="flex gap-2">
            <input type="text" id="quiz-answer-input" placeholder="정답을 입력하세요" class="flex-grow border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <button onclick="checkShortAnswer()" id="btn-short-submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold">제출</button>
          </div>
        </div>
      </div>
      <div id="quiz-feedback" class="hidden bg-white p-5 rounded-lg border-l-4"></div>
    </div>
    <div id="quiz-placeholder" class="text-center py-8 text-gray-500 border-2 border-dashed border-indigo-200 rounded-lg">
      <p>'새로운 문제 생성' 버튼을 눌러 실력을 점검해보세요.</p>
    </div>
  </div>

  <!-- 암기 노트 ① 두문자어 -->
  <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6">
    <h3 class="font-bold text-gray-900 text-lg mb-4">📝 암기 노트 ① — 두문자어 카드</h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-indigo-50 rounded-xl p-5 border border-indigo-200 text-center">
        <p class="text-3xl font-black text-indigo-700 mb-2">공투책</p>
        <p class="text-sm text-indigo-600 font-semibold mb-2">AI 윤리 3대 원칙</p>
        <div class="text-left text-sm text-gray-700 space-y-1">
          <p><strong>공</strong>: 공정성(Fairness)</p>
          <p><strong>투</strong>: 투명성(Transparency)</p>
          <p><strong>책</strong>: 책임성(Accountability)</p>
        </div>
      </div>
      <div class="bg-green-50 rounded-xl p-5 border border-green-200 text-center">
        <p class="text-3xl font-black text-green-700 mb-2">금고제최</p>
        <p class="text-sm text-green-600 font-semibold mb-2">EU AI Act 4단계</p>
        <div class="text-left text-sm text-gray-700 space-y-1">
          <p><strong>금</strong>: 금지 위험 — 완전 금지</p>
          <p><strong>고</strong>: 고위험 — 사전 적합성 평가</p>
          <p><strong>제</strong>: 제한 위험 — 투명성 고지</p>
          <p><strong>최</strong>: 최소 위험 — 자유 사용</p>
        </div>
      </div>
      <div class="bg-purple-50 rounded-xl p-5 border border-purple-200 text-center">
        <p class="text-3xl font-black text-purple-700 mb-2">리데기로투인정</p>
        <p class="text-sm text-purple-600 font-semibold mb-2">고위험 AI 7대 요건</p>
        <div class="text-left text-sm text-gray-700 space-y-1">
          <p><strong>리</strong>: 리스크 관리</p>
          <p><strong>데</strong>: 데이터 거버넌스</p>
          <p><strong>기</strong>: 기술 문서화</p>
          <p><strong>로</strong>: 로깅(Logging)</p>
          <p><strong>투</strong>: 투명성·정보 제공</p>
          <p><strong>인</strong>: 인간 감독</p>
          <p><strong>정</strong>: 정확성·견고성·보안</p>
        </div>
      </div>
    </div>
  </div>

  <!-- 암기 노트 ② 골격 답안 -->
  <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6">
    <h3 class="font-bold text-gray-900 text-lg mb-4">📋 암기 노트 ② — 골격 답안 구조</h3>
    <table class="w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border">구간</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border">비중</th>
          <th class="bg-indigo-50 text-indigo-900 p-3 text-left border">핵심 내용</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="p-3 border font-semibold">서론</td><td class="p-3 border">10%</td><td class="p-3 border">AI 블랙박스 문제 + 글로벌 규제 법제화 배경</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">소문제 1</td><td class="p-3 border">25%</td><td class="p-3 border">AI 윤리 3대 원칙 (공투책) + 한국 3대 원칙 10대 요건</td></tr>
        <tr><td class="p-3 border font-semibold">소문제 2</td><td class="p-3 border">30%</td><td class="p-3 border">XAI 개념 + LIME 작동 원리 + SHAP 작동 원리 + 비교표(6개 기준)</td></tr>
        <tr class="bg-gray-50"><td class="p-3 border font-semibold">소문제 3</td><td class="p-3 border">25%</td><td class="p-3 border">EU AI Act 4단계 피라미드 + 각 단계 표 + 고위험 7대 요건</td></tr>
        <tr><td class="p-3 border font-semibold">결론</td><td class="p-3 border">10%</td><td class="p-3 border">원칙→기술→제도 삼층 거버넌스 + 한국 AI 기본법 전망</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 암기 노트 ③ 필수 도식 + 차별화 -->
  <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6">
    <h3 class="font-bold text-gray-900 text-lg mb-4">🎯 암기 노트 ③ — 필수 도식 &amp; 차별화 포인트</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
      <div class="info-card indigo">
        <p class="font-bold text-indigo-800 mb-2">📊 필수 도식 (3개)</p>
        <p class="text-sm text-indigo-700">1. EU AI Act 4단계 위험 피라미드</p>
        <p class="text-sm text-indigo-700">2. LIME vs SHAP 비교표 (6개 기준 이상)</p>
        <p class="text-sm text-indigo-700">3. AI 윤리 3대 원칙 + 핵심 요건 표</p>
      </div>
      <div class="info-card amber">
        <p class="font-bold text-amber-800 mb-2">⭐ 차별화 포인트</p>
        <p class="text-sm text-amber-700">• Amazon 채용 AI 폐기, COMPAS 인종 편향 구체적 사례</p>
        <p class="text-sm text-amber-700">• GDPR 제22조와 XAI의 법적 연결</p>
        <p class="text-sm text-amber-700">• EU AI Act 과징금 수치 (연매출 7%, 3,500만 유로)</p>
        <p class="text-sm text-amber-700">• 한국 AI 윤리 기준 10대 요건</p>
        <p class="text-sm text-amber-700">• ISO/IEC 42001 AI 관리 시스템 표준 연계</p>
      </div>
    </div>
  </div>

  <!-- 제2부 전체 (textbook-content 형식) -->
  <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
    <h3 class="font-bold text-gray-900 text-lg mb-4">📚 제2부 암기 요약 자료 전체</h3>
    <div class="textbook-content">
      <h4>한 줄 정의</h4>
      <div class="def-box">
        <p class="text-indigo-800">AI 윤리 3대 원칙(공정성·투명성·책임성)은 XAI(LIME·SHAP)로 기술적으로 구현되며, EU AI Act는 4단계 위험 기반 규제로 이를 법적으로 강제한다.</p>
      </div>

      <h4>핵심 키워드 맵</h4>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 my-3">
        <div class="bg-indigo-50 rounded-lg p-3 border border-indigo-200">
          <p class="font-bold text-indigo-800 text-sm mb-1">[AI 윤리 3대 원칙]</p>
          <p class="text-xs text-indigo-700">├─ 공정성: 편향 탐지·완화, 대표 데이터</p>
          <p class="text-xs text-indigo-700">├─ 투명성: XAI, 모델 카드, 알고리즘 감사</p>
          <p class="text-xs text-indigo-700">└─ 책임성: 거버넌스, Audit Trail, 이의 제기</p>
        </div>
        <div class="bg-green-50 rounded-lg p-3 border border-green-200">
          <p class="font-bold text-green-800 text-sm mb-1">[XAI]</p>
          <p class="text-xs text-green-700">├─ LIME: 대리 모델, 빠르지만 불안정</p>
          <p class="text-xs text-green-700">├─ SHAP: Shapley Value, 엄밀, 계산 비용 높음</p>
          <p class="text-xs text-green-700">└─ 공통: Post-hoc, Model-agnostic</p>
        </div>
        <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
          <p class="font-bold text-purple-800 text-sm mb-1">[EU AI Act]</p>
          <p class="text-xs text-purple-700">├─ 금지: 사회신용평가, 잠재의식조작</p>
          <p class="text-xs text-purple-700">├─ 고위험: 채용·신용·사법, 7대 요건</p>
          <p class="text-xs text-purple-700">├─ 제한: 챗봇·딥페이크, 투명성 고지</p>
          <p class="text-xs text-purple-700">└─ 최소: 자유 사용, 의무 없음</p>
        </div>
      </div>

      <h4>두문자어 암기법</h4>
      <p><strong>AI 윤리 3대 원칙: "공투책"</strong> — 공정성(Fairness), 투명성(Transparency), 책임성(Accountability)</p>
      <p><strong>EU AI Act 4단계: "금고제최"</strong> — 금지(완전 금지), 고위험(사전 적합성 평가), 제한(투명성 고지), 최소(자유 사용)</p>
      <p><strong>LIME vs SHAP: "라셰"</strong> — LIME=Local 대리, SHAP=Shapley 공정</p>

      <h4>골격 답안 구조</h4>
      <p><strong>[서론 — 10%]</strong> AI 블랙박스 문제 + 글로벌 규제 법제화 배경</p>
      <p><strong>[소문제 1 — 25%]</strong> AI 윤리 3대 원칙: 공정성/투명성/책임성 정의 + 핵심 요건 표, 한국 3대 원칙 10대 요건 언급</p>
      <p><strong>[소문제 2 — 30%]</strong> XAI / LIME / SHAP: XAI 개념 + 필요성, LIME 작동 원리(대리 모델), SHAP 작동 원리(Shapley Value), LIME vs SHAP 비교표(6개 기준 이상)</p>
      <p><strong>[소문제 3 — 25%]</strong> EU AI Act: 4단계 피라미드 필수, 각 단계별 대상·의무·제재 표, 고위험 AI 7대 요건</p>
      <p><strong>[결론 — 10%]</strong> 원칙→기술→제도 삼층 거버넌스 + 한국 AI 기본법 전망</p>

      <h4>필수 도식</h4>
      <p>1. <strong>EU AI Act 4단계 위험 피라미드</strong> — 가장 중요한 도식</p>
      <p>2. <strong>LIME vs SHAP 비교표</strong> — 6개 이상 비교 기준</p>
      <p>3. <strong>AI 윤리 3대 원칙 + 핵심 요건 표</strong></p>

      <h4>차별화 포인트</h4>
      <ul>
        <li>Amazon 채용 AI 폐기, COMPAS 인종 편향 등 구체적 사례</li>
        <li>GDPR 제22조와 XAI의 법적 연결</li>
        <li>EU AI Act 과징금 수치 (연매출 7%, 3,500만 유로)</li>
        <li>한국 AI 윤리 기준 10대 요건</li>
        <li>ISO/IEC 42001 AI 관리 시스템 표준 연계</li>
      </ul>
    </div>
  </div>
</div>
<!-- AI 튜터 채팅 사이드바 -->
<div class="chat-sidebar" id="chatSidebar">
  <div class="flex items-center justify-between p-4 border-b bg-indigo-600 text-white">
    <h3 class="font-bold">🤖 AI 튜터</h3>
    <button onclick="toggleChat()" class="text-white hover:text-indigo-200 text-xl">&times;</button>
  </div>
  <div id="chatMessages" class="flex-grow overflow-y-auto p-4 space-y-3">
    <div class="bg-indigo-50 rounded-lg p-3 text-sm text-indigo-800">안녕하세요! AI 윤리, XAI, EU AI Act에 대해 궁금한 점을 질문해주세요.</div>
  </div>
  <div class="p-4 border-t">
    <div class="flex gap-2">
      <input type="text" id="chatInput" placeholder="질문을 입력하세요..." class="flex-grow border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500" onkeydown="if(event.key==='Enter')sendChat()">
      <button onclick="sendChat()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold">전송</button>
    </div>
  </div>
</div>
<button onclick="toggleChat()" class="fixed bottom-6 right-6 bg-indigo-600 hover:bg-indigo-700 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center text-2xl z-50 transition-transform hover:scale-110">💬</button>

<!-- API 설정 모달 -->
<div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-[2000] hidden flex items-center justify-center">
  <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4 shadow-2xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-bold text-gray-900">🔑 API 설정</h3>
      <button onclick="toggleSettings()" class="text-gray-400 hover:text-gray-600 text-xl">&times;</button>
    </div>
    <div class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Gemini API Key</label>
        <input type="password" id="apiKeyInput" placeholder="AIzaSy..." class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
      </div>
      <div class="flex gap-2">
        <button onclick="saveApiKey()" class="flex-grow bg-indigo-600 hover:bg-indigo-700 text-white py-2 rounded-lg text-sm font-bold">저장</button>
        <button onclick="toggleSettings()" class="px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-600 hover:bg-gray-50">취소</button>
      </div>
      <p class="text-xs text-gray-400">키는 브라우저 로컬 스토리지에만 저장됩니다.</p>
    </div>
  </div>
</div></main>
<footer class="bg-white border-t border-gray-200 mt-12 py-6">
  <div class="max-w-6xl mx-auto px-4 text-center">
    <p class="text-sm text-gray-500">박교익PE (132회 정보관리기술사, dr.code92@gmail.com)</p>
    <p class="text-xs text-gray-400 mt-1">Copyright &copy; KPC 정보관리기술사 ZIP-UP 심화반. All rights reserved.</p>
  </div>
</footer>
<script>
    // ── 탭 네비게이션 ──
    var isMentorMode = new URLSearchParams(window.location.search).get('mentor') === 'true';
    if (isMentorMode) { var st = document.getElementById('tab-script'); if(st) st.style.display = ''; }
    var sections = ['overview','ethics','xai','euaiact','textbook','quiz'];
    if (isMentorMode) sections.splice(5, 0, 'script');

    function navTo(id) {
        sections.forEach(function(s) { var el = document.getElementById(s); if(el) el.classList.add('hidden'); });
        var target = document.getElementById(id);
        if (target) target.classList.remove('hidden');
        document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
        var btns = document.querySelectorAll('.tab-btn');
        btns.forEach(function(b) { if(b.getAttribute('onclick') && b.getAttribute('onclick').includes("'" + id + "'")) b.classList.add('active'); });
        window.scrollTo({top:0, behavior:'smooth'});
    }

    // ── 클릭 확장 (tech-block / strategy-card) ──
    document.addEventListener('click', function(e) {
        var header = e.target.closest('.tech-header') || e.target.closest('.str-header');
        if (header) { var block = header.parentElement; block.classList.toggle('open'); }
    });

    // ── API Key ──
    function getApiKey() {
        return localStorage.getItem('geminiKey') || localStorage.getItem('gemini_api_key') || new URLSearchParams(window.location.search).get('key') || '';
    }
    function toggleSettings() {
        var m = document.getElementById('settingsModal'); m.classList.toggle('hidden');
        if (!m.classList.contains('hidden')) { document.getElementById('apiKeyInput').value = getApiKey(); }
    }
    function saveApiKey() {
        var k = document.getElementById('apiKeyInput').value.trim();
        if(k) { localStorage.setItem('geminiKey', k); localStorage.setItem('gemini_api_key', k); }
        toggleSettings();
    }

    // ── AI 튜터 채팅 ──
    function toggleChat() { document.getElementById('chatSidebar').classList.toggle('open'); }
    async function sendChat() {
        var key = getApiKey();
        if(!key){alert('API Key를 먼저 설정해주세요.');toggleSettings();return;}
        var input = document.getElementById('chatInput');
        var msg = input.value.trim(); if(!msg) return;
        input.value = '';
        var container = document.getElementById('chatMessages');
        container.innerHTML += '<div class="bg-gray-100 rounded-lg p-3 text-sm text-gray-800 ml-8">' + msg + '</div>';
        container.innerHTML += '<div id="chat-loading" class="bg-indigo-50 rounded-lg p-3 text-sm text-indigo-600"><div class="typing-indicator"><span></span><span></span><span></span></div></div>';
        container.scrollTop = container.scrollHeight;
        try {
            var sysPrompt = "당신은 정보관리기술사 시험 멘토입니다. 'AI 윤리 가이드라인, XAI, EU AI Act' 관련 질문에 전문적이고 명쾌하게 답변해주세요. 300자 이내로 핵심만 요약.";
            var r = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key='+key,{
                method:'POST',headers:{'Content-Type':'application/json'},
                body:JSON.stringify({contents:[{parts:[{text:sysPrompt+"\n\nUser: "+msg}]}]})
            });
            var d = await r.json();
            var reply = d.candidates[0].content.parts[0].text;
            var el = document.getElementById('chat-loading');
            if(el) el.outerHTML = '<div class="bg-indigo-50 rounded-lg p-3 text-sm text-indigo-800">' + marked.parse(reply) + '</div>';
        } catch(e) {
            var el2 = document.getElementById('chat-loading');
            if(el2) el2.outerHTML = '<div class="bg-red-50 rounded-lg p-3 text-sm text-red-600">오류: '+e.message+'</div>';
        }
        container.scrollTop = container.scrollHeight;
    }

    // ── 퀴즈 ──
    // API Key 브릿지: 빌드 스크립트의 API Key 변수명(k, key 등)과 관계없이 동작하도록
    // getApiKey() 함수가 있으면 그것을 사용, 없으면 localStorage에서 직접 가져옴
    var geminiKey = (typeof getApiKey === 'function') ? (getApiKey() || '') : (localStorage.getItem('geminiKey') || localStorage.getItem('gemini_api_key') || '');
    var quizTypeHistory = [];
    var currentQuizData = null;
    var quizTopics = [
        { category: "AI 윤리 3대 원칙", keywords: "공정성, 투명성, 책임성, 편향, Accountability, Fairness, Transparency" },
        { category: "글로벌 AI 윤리 가이드라인", keywords: "OECD AI 원칙, EU HLEG, UNESCO, 한국 AI 윤리 기준, 10대 요건" },
        { category: "XAI 개념과 분류", keywords: "설명 가능한 AI, DARPA, Post-hoc, Model-agnostic, Global, Local" },
        { category: "LIME", keywords: "대리 모델, Surrogate, 섭동, Perturbation, 선형 회귀, 근사적 설명" },
        { category: "SHAP", keywords: "Shapley Value, 게임 이론, 한계 기여도, 연합, Coalition, TreeSHAP" },
        { category: "LIME vs SHAP 비교", keywords: "수학적 보장, 계산 복잡도, 일관성, Force Plot, Summary Plot" },
        { category: "EU AI Act 위험 분류", keywords: "금지 위험, 고위험, 제한 위험, 최소 위험, 위험 기반 접근, 피라미드" },
        { category: "EU AI Act 규제 체계", keywords: "과징금, 7대 요건, 인간 감독, 데이터 거버넌스, GDPR, ISO 42001" }
    ];

    async function generateQuiz() {
        // 매 호출 시 최신 API Key로 갱신 (설정 직후에도 바로 동작하도록)
        geminiKey = (typeof getApiKey === 'function') ? (getApiKey() || '') : (localStorage.getItem('geminiKey') || localStorage.getItem('gemini_api_key') || '');
        if (!geminiKey) { alert('API Key를 먼저 설정해주세요.'); toggleSettings(); return; }
        var btn = document.getElementById('btn-quiz-gen');
        btn.disabled = true; btn.innerHTML = '<span>생성 중...</span>';
        document.getElementById('quiz-placeholder').classList.add('hidden');
        document.getElementById('quiz-container').classList.add('hidden');
        document.getElementById('quiz-loading').classList.remove('hidden');
        var isMC;
        var recent = quizTypeHistory.slice(-2);
        if (recent.length >= 2 && recent[0] === recent[1]) { isMC = !recent[1]; }
        else { isMC = Math.random() > 0.5; }
        quizTypeHistory.push(isMC);
        var selected = quizTopics[Math.floor(Math.random() * quizTopics.length)];
        var quizType = isMC ? '객관식 (4지선다)' : '단답형';
        var format = isMC
            ? '{"question":"문제","options":["A","B","C","D"],"correctIndex":0,"explanation":"해설"}'
            : '{"question":"문제","correctAnswer":"정답","explanation":"해설"}';
        var prompt = "다음 카테고리에 대한 " + quizType + " 퀴즈 1문제를 만드세요.\n"
            + "카테고리: " + selected.category + "\n"
            + "관련 키워드: " + selected.keywords + "\n"
            + "규칙: 반드시 위 카테고리와 키워드에 직접 관련된 문제를 출제하세요.\n"
            + "JSON 형식으로 응답: " + format;
        try {
            var r = await fetch(
                'https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key=' + geminiKey,
                { method:'POST', headers:{'Content-Type':'application/json'},
                  body: JSON.stringify({ contents:[{parts:[{text:prompt}]}], generationConfig:{responseMimeType:"application/json"} })
                }
            );
            var d = await r.json();
            var t = d.candidates[0].content.parts[0].text;
            t = t.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim();
            var depth=0, start=-1, end=-1;
            for (var i=0;i<t.length;i++) {
                if (t[i]==='{') { if(depth===0) start=i; depth++; }
                else if (t[i]==='}') { depth--; if(depth===0 && start!==-1) { end=i; break; } }
            }
            if (start===-1||end===-1) throw new Error("No JSON found");
            t = t.substring(start, end+1);
            t = t.replace(/[\x00-\x1F\x7F]/g, function(c) { return c==='\n'||c==='\r'||c==='\t' ? ' ' : ''; });
            currentQuizData = JSON.parse(t);
            renderQuiz(isMC);
        } catch(e) {
            document.getElementById('quiz-loading').classList.add('hidden');
            document.getElementById('quiz-placeholder').classList.remove('hidden');
            document.getElementById('quiz-placeholder').innerHTML = '<p class="text-red-500">퀴즈 생성 오류: ' + e.message + '</p>';
        }
        btn.disabled = false; btn.innerHTML = '<span>✨ 새로운 문제 생성</span>';
    }

    function renderQuiz(isMC) {
        document.getElementById('quiz-loading').classList.add('hidden');
        document.getElementById('quiz-feedback').classList.add('hidden');
        document.getElementById('quiz-container').classList.remove('hidden');
        document.getElementById('quiz-type-badge').textContent = isMC ? '객관식' : '단답형';
        document.getElementById('quiz-question').textContent = currentQuizData.question;
        var optDiv = document.getElementById('quiz-options');
        var inputDiv = document.getElementById('quiz-input-area');
        if (isMC) {
            optDiv.classList.remove('hidden');
            inputDiv.classList.add('hidden');
            var h = '';
            var letters = ['A','B','C','D'];
            currentQuizData.options.forEach(function(opt, i) {
                h += '<button onclick="checkMultipleChoice(' + i + ', this)" class="w-full text-left p-4 rounded-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all mb-2 flex items-center group">'
                    + '<span class="w-8 h-8 rounded-full bg-gray-100 group-hover:bg-indigo-100 flex items-center justify-center text-sm font-bold text-gray-500 group-hover:text-indigo-600 mr-3 flex-shrink-0">' + letters[i] + '</span>'
                    + '<span class="text-sm text-gray-700">' + opt + '</span></button>';
            });
            optDiv.innerHTML = h;
        } else {
            optDiv.classList.add('hidden');
            inputDiv.classList.remove('hidden');
            document.getElementById('quiz-answer-input').value = '';
            document.getElementById('quiz-answer-input').focus();
        }
    }

    function checkMultipleChoice(idx, btnEl) {
        var correct = idx === currentQuizData.correctIndex;
        document.querySelectorAll('#quiz-options button').forEach(function(b, i) {
            b.disabled = true;
            if (i === currentQuizData.correctIndex) { b.classList.add('bg-green-50','border-green-400'); b.querySelector('span:first-child').classList.add('bg-green-100','text-green-700'); }
            else if (i === idx && !correct) { b.classList.add('bg-red-50','border-red-400'); b.querySelector('span:first-child').classList.add('bg-red-100','text-red-700'); }
        });
        showQuizFeedback(correct, currentQuizData.options[currentQuizData.correctIndex], currentQuizData.explanation);
    }

    async function checkShortAnswer() {
        geminiKey = (typeof getApiKey === 'function') ? (getApiKey() || '') : (localStorage.getItem('geminiKey') || localStorage.getItem('gemini_api_key') || '');
        var ans = document.getElementById('quiz-answer-input').value.trim();
        if (!ans) { alert('답을 입력해주세요.'); return; }
        var btn = document.getElementById('btn-short-submit');
        btn.disabled = true; btn.textContent = '채점 중...';
        try {
            var gradingPrompt = "당신은 정보관리기술사 시험 채점관입니다. 아래 문제에 대해 사용자의 답안이 정답으로 인정될 수 있는지 판정하세요.\n\n"
                + "문제: " + currentQuizData.question + "\n"
                + "모범 정답: " + currentQuizData.correctAnswer + "\n"
                + "사용자 답안: " + ans + "\n\n"
                + "판정 기준:\n- 핵심 의미가 동일하면 정답\n- 약어/풀네임 모두 인정\n- 영어/한글 혼용 인정\n- 띄어쓰기/조사 차이는 무시\n- 의미가 명확히 다르면 오답\n\n"
                + "Output JSON: {\"correct\":true/false,\"reason\":\"판정 이유\"}";
            var r = await fetch(
                'https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent?key=' + geminiKey,
                { method:'POST', headers:{'Content-Type':'application/json'},
                  body: JSON.stringify({ contents:[{parts:[{text:gradingPrompt}]}], generationConfig:{responseMimeType:"application/json"} })
                }
            );
            var d = await r.json();
            var gt = d.candidates[0].content.parts[0].text;
            gt = gt.replace(/```json\s*/gi,"").replace(/```\s*/g,"").trim();
            var gd=0,gs=-1,ge=-1;
            for(var i=0;i<gt.length;i++){if(gt[i]==='{'){if(gd===0)gs=i;gd++;}else if(gt[i]==='}'){gd--;if(gd===0&&gs!==-1){ge=i;break;}}}
            if(gs===-1||ge===-1) throw new Error("No JSON");
            gt=gt.substring(gs,ge+1);
            gt=gt.replace(/[\x00-\x1F\x7F]/g,function(c){return c==='\n'||c==='\r'||c==='\t'?' ':'';});
            var result = JSON.parse(gt);
            showQuizFeedback(result.correct, currentQuizData.correctAnswer, currentQuizData.explanation + (result.reason ? ' (AI: ' + result.reason + ')' : ''));
        } catch(e) {
            var normalize = function(s){return s.replace(/\s/g,'').toLowerCase();};
            var correct = normalize(currentQuizData.correctAnswer).includes(normalize(ans)) || normalize(ans).includes(normalize(currentQuizData.correctAnswer));
            showQuizFeedback(correct, currentQuizData.correctAnswer, currentQuizData.explanation + ' (로컬 채점)');
        }
        btn.disabled = false; btn.textContent = '제출';
    }

    function showQuizFeedback(correct, answer, explanation) {
        var fb = document.getElementById('quiz-feedback');
        fb.classList.remove('hidden','border-green-500','bg-green-50','border-red-500','bg-red-50');
        if (correct) {
            fb.classList.add('border-green-500','bg-green-50');
            fb.innerHTML = '<p class="font-bold text-green-700 mb-1">✅ 정답입니다!</p><p class="text-sm text-green-600">' + explanation + '</p>';
        } else {
            fb.classList.add('border-red-500','bg-red-50');
            fb.innerHTML = '<p class="font-bold text-red-700 mb-1">❌ 오답입니다.</p><p class="text-sm text-red-700 mb-1">정답: ' + answer + '</p><p class="text-sm text-red-600">' + explanation + '</p>';
        }
    }

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && document.getElementById('quiz-answer-input') === document.activeElement) { checkShortAnswer(); }
    });

    // ── URL 파라미터로 API Key 설정 ──
    (function(){
        var urlKey = new URLSearchParams(window.location.search).get('key');
        if(urlKey){ localStorage.setItem('geminiKey', urlKey); localStorage.setItem('gemini_api_key', urlKey); }
    })();
</script>
</body></html>